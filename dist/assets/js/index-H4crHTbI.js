const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/vendor-CNX07ziR.js","assets/js/vendor-react-huKtfhlb.js"])))=>i.map(i=>d[i]);
import{r as e,j as a,J as s,K as r,M as t,N as o,X as i,Q as n,U as l,W as d,Y as c,_ as m,$ as u,a0 as x,u as h,a1 as g,a2 as p,a3 as f,a4 as j,y as b,L as v,a5 as N,a6 as w,a7 as y,a8 as C,a9 as k,aa as E,ab as S,ac as T,ad as A,ae as _,w as P,q as D,af as z,ag as I,ah as M,ai as F,aj as O,ak as R,al as J,am as U,an as q,ao as V,ap as L,aq as $,ar as B,as as G,at as H,au as X,av as Q,aw as K,ax as Y,ay as W,az as Z,aA as ee,aB as ae,aC as se,aD as re,aE as te,aF as oe,aG as ie,aH as ne,aI as le,aJ as de,aK as ce,aL as me,aM as ue,aN as xe,aO as he,aP as ge,aQ as pe,aR as fe,aS as je,aT as be,aU as ve,aV as Ne,aW as we,aX as ye,aY as Ce,aZ as ke,a_ as Ee,a$ as Se,b0 as Te,b1 as Ae,b2 as _e,b3 as Pe,b4 as De,b5 as ze,b6 as Ie,b7 as Me,b8 as Fe,B as Oe,Z as Re,v as Je,b9 as Ue,F as qe,ba as Ve,bb as Le,bc as $e,bd as Be,be as Ge,bf as He,bg as Xe,bh as Qe,bi as Ke,bj as Ye,bk as We,bl as Ze,bm as ea,t as aa,bn as sa,bo as ra,bp as ta,bq as oa,br as ia,bs as na,bt as la,bu as da,bv as ca,bw as ma,s as ua,bx as xa,by as ha,bz as ga,x as pa,bA as fa,bB as ja,bC as ba,bD as va,bE as Na,bF as wa,bG as ya,bH as Ca,bI as ka,bJ as Ea,bK as Sa,bL as Ta,bM as Aa,bN as _a,bO as Pa,bP as Da,bQ as za,bR as Ia,bS as Ma,bT as Fa,bU as Oa,bV as Ra,bW as Ja,bX as Ua,bY as qa,bZ as Va,b_ as La,b$ as $a,c0 as Ba,c1 as Ga,c2 as Ha,c3 as Xa,c4 as Qa,c5 as Ka,c6 as Ya,c7 as Wa,c8 as Za,c9 as es,ca as as,cb as ss,cc as rs,cd as ts,ce as os,cf as is,cg as ns,ch as ls,ci as ds,cj as cs,ck as ms,cl as us,cm as xs,cn as hs,co as gs,cp as ps,cq as fs,cr as js,cs as bs,ct as vs}from"./vendor-react-huKtfhlb.js";import{a as Ns,al as ws,am as ys,an as Cs,a1 as ks,ao as Es,R as Ss,ap as Ts,O as As,L as _s,N as Ps,W as Ds,aq as zs,ar as Is,as as Ms,a2 as Fs,at as Os,au as Rs,av as Js,a9 as Us,aw as qs,ax as Vs,ay as Ls,az as $s,aA as Bs,aB as Gs,aC as Hs,aD as Xs,aE as Qs,aF as Ks,aG as Ys,aH as Ws,aI as Zs,aJ as er,aK as ar,aL as sr,aM as rr,aN as tr,aO as or,aP as ir,aQ as nr}from"./vendor-CNX07ziR.js";import{c as lr,s as dr,B as cr,a as mr,A as ur,b as xr,d as hr,e as gr,f as pr,g as fr,h as jr,i as br,j as vr,k as Nr,D as wr,l as yr,m as Cr,n as kr,o as Er,I as Sr,p as Tr,S as Ar,q as _r,r as Pr,t as Dr}from"./ai-features-DAtlmltU.js";import{_ as zr}from"./vendor-supabase-DSnDMb8T.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)}).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();let Ir=0;const Mr=new Map,Fr=e=>{if(Mr.has(e))return;const a=setTimeout(()=>{Mr.delete(e),Ur({type:"REMOVE_TOAST",toastId:e})},1e6);Mr.set(e,a)},Or=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{const{toastId:s}=a;return s?Fr(s):e.toasts.forEach(e=>{Fr(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":return void 0===a.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},Rr=[];let Jr={toasts:[]};function Ur(e){Jr=Or(Jr,e),Rr.forEach(e=>{e(Jr)})}function qr({...e}){const a=(Ir=(Ir+1)%Number.MAX_SAFE_INTEGER,Ir.toString()),s=()=>Ur({type:"DISMISS_TOAST",toastId:a});return Ur({type:"ADD_TOAST",toast:{...e,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>Ur({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function Vr(){const[a,s]=e.useState(Jr);return e.useEffect(()=>(Rr.push(s),()=>{const e=Rr.indexOf(s);e>-1&&Rr.splice(e,1)}),[a]),{...a,toast:qr,dismiss:e=>Ur({type:"DISMISS_TOAST",toastId:e})}}const Lr=d,$r=e.forwardRef(({className:e,...r},t)=>a.jsx(s,{ref:t,className:lr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...r}));$r.displayName=s.displayName;const Br=Ns("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Gr=e.forwardRef(({className:e,variant:s,...t},o)=>a.jsx(r,{ref:o,className:lr(Br({variant:s}),e),...t}));Gr.displayName=r.displayName;e.forwardRef(({className:e,...s},r)=>a.jsx(t,{ref:r,className:lr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...s})).displayName=t.displayName;const Hr=e.forwardRef(({className:e,...s},r)=>a.jsx(o,{ref:r,className:lr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...s,children:a.jsx(i,{className:"h-4 w-4"})}));Hr.displayName=o.displayName;const Xr=e.forwardRef(({className:e,...s},r)=>a.jsx(n,{ref:r,className:lr("text-sm font-semibold",e),...s}));Xr.displayName=n.displayName;const Qr=e.forwardRef(({className:e,...s},r)=>a.jsx(l,{ref:r,className:lr("text-sm opacity-90",e),...s}));function Kr(){const{toasts:e}=Vr();return a.jsxs(Lr,{children:[e.map(function({id:e,title:s,description:r,action:t,...o}){return a.jsxs(Gr,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[s&&a.jsx(Xr,{children:s}),r&&a.jsx(Qr,{children:r})]}),t,a.jsx(Hr,{})]},e)}),a.jsx($r,{})]})}Qr.displayName=l.displayName;const Yr=({...e})=>{const{theme:s="system"}=ws();return a.jsx(ys,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},Wr=m,Zr=u,et=x,at=e.forwardRef(({className:e,sideOffset:s=4,...r},t)=>a.jsx(c,{ref:t,sideOffset:s,className:lr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));at.displayName=c.displayName;const st=e.createContext(void 0),rt=({children:s})=>{const[r,t]=e.useState(null),[o,i]=e.useState(null),[n,l]=e.useState(!0);e.useEffect(()=>{const{data:{subscription:e}}=dr.auth.onAuthStateChange((e,a)=>{i(a),t(a?.user??null),l(!1)});return dr.auth.getSession().then(({data:{session:e}})=>{i(e),t(e?.user??null),l(!1)}),()=>e.unsubscribe()},[]);return a.jsx(st.Provider,{value:{user:r,session:o,loading:n,signUp:async(e,a)=>{const s=`${window.location.origin}/`,{error:r}=await dr.auth.signUp({email:e,password:a,options:{emailRedirectTo:s}});return{error:r}},signIn:async(e,a)=>{const{error:s}=await dr.auth.signInWithPassword({email:e,password:a});return{error:s}},signOut:async()=>{await dr.auth.signOut()},resetPassword:async e=>{const a=`${window.location.origin}/auth`,{error:s}=await dr.auth.resetPasswordForEmail(e,{redirectTo:a});return{error:s}}},children:s})},tt=()=>{const a=e.useContext(st);if(void 0===a)throw new Error("useAuth must be used within an AuthProvider");return a},ot=e.createContext({theme:"system",setTheme:()=>null});function it({children:s,defaultTheme:r="system",storageKey:t="vite-ui-theme",...o}){const[i,n]=e.useState(()=>localStorage.getItem(t)||r);e.useEffect(()=>{const e=window.document.documentElement;if(e.classList.remove("light","dark"),"system"===i){const a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return void e.classList.add(a)}e.classList.add(i)},[i]);const l={theme:i,setTheme:e=>{localStorage.setItem(t,e),n(e)}};return a.jsx(ot.Provider,{...o,value:l,children:s})}const nt=e.forwardRef(({className:e,...s},r)=>a.jsx("div",{ref:r,className:lr("rounded-xl border bg-gradient-card text-card-foreground shadow-large backdrop-blur-sm transition-all duration-300 hover:shadow-xl",e),...s}));nt.displayName="Card";const lt=e.forwardRef(({className:e,...s},r)=>a.jsx("div",{ref:r,className:lr("flex flex-col space-y-1.5 p-6",e),...s}));lt.displayName="CardHeader";const dt=e.forwardRef(({className:e,...s},r)=>a.jsx("h3",{ref:r,className:lr("text-2xl font-semibold leading-none tracking-tight",e),...s}));dt.displayName="CardTitle";const ct=e.forwardRef(({className:e,...s},r)=>a.jsx("p",{ref:r,className:lr("text-sm text-muted-foreground",e),...s}));ct.displayName="CardDescription";const mt=e.forwardRef(({className:e,...s},r)=>a.jsx("div",{ref:r,className:lr("p-6 pt-0",e),...s}));mt.displayName="CardContent";e.forwardRef(({className:e,...s},r)=>a.jsx("div",{ref:r,className:lr("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";const ut=()=>{const{signOut:e}=tt();return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted p-4",children:a.jsxs(nt,{className:"w-full max-w-md",children:[a.jsxs(lt,{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:a.jsx(h,{className:"h-6 w-6 text-yellow-600"})})}),a.jsx(dt,{className:"text-xl",children:"Aguardando Aprovação"}),a.jsx(ct,{children:"Sua conta foi criada com sucesso, mas precisa ser aprovada por um administrador"})]}),a.jsxs(mt,{className:"space-y-4",children:[a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(g,{className:"h-5 w-5 text-blue-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-blue-900",children:"Status da Conta"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Por questões de segurança, todas as novas contas precisam ser aprovadas por um administrador do TRT15."})]})]})}),a.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(p,{className:"h-5 w-5 text-green-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-green-900",children:"Próximos Passos"}),a.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Você receberá um email assim que sua conta for aprovada. Normalmente este processo leva até 24 horas."})]})]})}),a.jsx("div",{className:"text-center text-sm text-muted-foreground",children:a.jsx("p",{children:"Se você tiver dúvidas, entre em contato com o suporte de TI do TRT15."})}),a.jsx(cr,{variant:"outline",className:"w-full",onClick:()=>e(),children:"Fazer Logout"})]})]})})},xt=({children:e,requireAdmin:s=!1})=>{const{user:r,loading:t}=tt(),{data:o,isLoading:i}=f({queryKey:["user-profile",r?.id],queryFn:async()=>{if(!r?.id)return null;const{data:e,error:a}=await dr.from("profiles").select("*").eq("id",r.id).single();return a?null:e},enabled:!!r?.id});return t||i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):r&&o?"pendente"===o.status?a.jsx(ut,{}):"rejeitado"===o.status?a.jsx(j,{to:"/auth",replace:!0}):s&&!o.is_admin?a.jsx(j,{to:"/",replace:!0}):a.jsx(a.Fragment,{children:e}):a.jsx(j,{to:"/auth",replace:!0})},ht=b.forwardRef(({className:e,variant:s="default",loading:r=!1,icon:t,iconPosition:o="left",children:i,disabled:n,...l},d)=>{const c=n||r;return a.jsxs(cr,{ref:d,className:lr("transition-all duration-300 ease-out","relative overflow-hidden",{default:"bg-primary text-primary-foreground hover:bg-primary/90",gradient:"bg-gradient-primary text-white hover:shadow-glow hover:scale-105",glass:"bg-card/80 backdrop-blur-xl border-border/20 hover:bg-card/90",glow:"bg-primary text-primary-foreground hover:shadow-glow hover:scale-105",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground",ghost:"hover:bg-accent hover:text-accent-foreground"}[s],c&&"opacity-50 cursor-not-allowed",e),disabled:c,...l,children:[r&&a.jsx("div",{className:"absolute inset-0 bg-current/10 flex items-center justify-center",children:a.jsx(v,{className:"h-4 w-4 animate-spin"})}),a.jsxs("div",{className:lr("flex items-center gap-2",r&&"opacity-0"),children:[t&&"left"===o&&a.jsx("span",{className:"flex-shrink-0",children:t}),i,t&&"right"===o&&a.jsx("span",{className:"flex-shrink-0",children:t})]}),a.jsx("div",{className:"absolute inset-0 -z-10 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"})]})});ht.displayName="ModernButton";const gt=({children:e,className:s})=>a.jsxs("div",{className:lr("min-h-screen bg-background","relative overflow-hidden",s),children:[a.jsxs("div",{className:"absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-purple-500/5"}),a.jsxs("div",{className:"absolute top-0 left-0 w-full h-full",children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-gradient-blue rounded-full opacity-10 blur-3xl animate-pulse-slow"}),a.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-gradient-purple rounded-full opacity-10 blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}}),a.jsx("div",{className:"absolute top-3/4 left-1/2 w-64 h-64 bg-gradient-green rounded-full opacity-10 blur-3xl animate-pulse-slow",style:{animationDelay:"2s"}})]})]}),a.jsx("div",{className:"absolute inset-0 -z-10 opacity-[0.02] dark:opacity-[0.05]",children:a.jsx("div",{className:"w-full h-full",style:{backgroundImage:"\n              linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),\n              linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px)\n            ",backgroundSize:"50px 50px"}})}),a.jsx("div",{className:"relative z-10",children:e})]}),pt=({children:e,className:s,variant:r="default",hover:t=!0,glow:o=!1,...i})=>a.jsx(nt,{className:lr("transition-all duration-300 ease-out",{default:"bg-card border-border/50",gradient:"bg-gradient-to-br from-card via-card/95 to-card/90 border-border/30",glass:"bg-card/80 backdrop-blur-xl border-border/20",elevated:"bg-card shadow-xl border-border/30"}[r],t&&"hover:shadow-lg hover:-translate-y-1 hover:scale-[1.02]",o&&"hover:shadow-glow",s),...i,children:e}),ft=({title:e,description:s,icon:r,action:t,className:o})=>a.jsx(lt,{className:lr("pb-3",o),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[r&&a.jsx("div",{className:"p-2 bg-gradient-primary rounded-xl shadow-soft",children:r}),a.jsxs("div",{children:[a.jsx(dt,{className:"text-lg font-semibold text-foreground",children:e}),s&&a.jsx(ct,{className:"text-sm text-muted-foreground mt-1",children:s})]})]}),t]})}),jt=mt,bt=({children:e,cols:s=3,gap:r="md",className:t})=>a.jsx("div",{className:lr("grid",{1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",5:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5",6:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6"}[s],{sm:"gap-3",md:"gap-4",lg:"gap-6",xl:"gap-8"}[r],t),children:e}),vt=({children:e,span:s=1,className:r})=>a.jsx("div",{className:lr({1:"col-span-1",2:"col-span-1 md:col-span-2",3:"col-span-1 md:col-span-2 lg:col-span-3",4:"col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-4",5:"col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-5",6:"col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-6"}[s],r),children:e}),Nt=e.forwardRef(({className:e,...s},r)=>a.jsx("textarea",{className:lr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));Nt.displayName="Textarea";const wt=y,yt=C,Ct=e.forwardRef(({className:e,align:s="center",sideOffset:r=4,...t},o)=>a.jsx(N,{children:a.jsx(w,{ref:o,align:s,sideOffset:r,className:lr("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));Ct.displayName=w.displayName;const kt=({note:s,onEdit:r,onDelete:t,onEnhance:o,onPositionChange:i,onColorChange:n,onSizeChange:l,isDragging:d,onDragStart:c,onDragEnd:m})=>{const[u,x]=e.useState(!1),[h,g]=e.useState(s.text),[p,f]=e.useState(!1),[j,b]=e.useState(!1),[v,N]=e.useState(!1),[w,y]=e.useState(null),[C,k]=e.useState({x:0,y:0}),[E,S]=e.useState({x:0,y:0,width:0,height:0}),[F,O]=e.useState(!1),[R,J]=e.useState(!1),[U,q]=e.useState(!1),[V,L]=e.useState({x:0,y:0}),$=e.useRef(null),B=e.useRef(null),G={width:288,height:208},H={width:400,height:300},X=600,Q=500,K=200,Y=150,W=s.size||G,Z={position:"absolute",left:j?V.x:s.position?.x||0,top:j?V.y:s.position?.y||0,width:W.width,height:W.height,cursor:j?"grabbing":"grab",zIndex:j||v?1e3:"auto",transform:j?"scale(1.05) rotate(2deg)":"scale(1) rotate(0deg)",transition:j?"none":"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},ee=e.useCallback(e=>{if(u)return;const a=e.target;if(a.closest("button")||a.closest('[role="button"]')||a.closest("[data-no-drag]"))return;e.preventDefault(),b(!0),c(s.id);const r=e.currentTarget.getBoundingClientRect();k({x:e.clientX-r.left,y:e.clientY-r.top}),L({x:s.position?.x||0,y:s.position?.y||0})},[u,s.id,s.position,c]),ae=e.useCallback(e=>{j&&(B.current=e,null===$.current&&($.current=requestAnimationFrame(()=>{if(!B.current)return;const e=B.current,a=e.clientX-C.x,s=e.clientY-C.y,r=window.innerWidth-W.width,t=window.innerHeight-W.height,o=Math.max(0,Math.min(a,r)),i=Math.max(0,Math.min(s,t));L({x:o,y:i}),$.current=null})))},[j,C,W.width,W.height]),se=e.useCallback(()=>{j&&(i(s.id,V),b(!1),m()),N(!1),y(null)},[j,s.id,V,i,m]),re=(e,a)=>{e.preventDefault(),e.stopPropagation(),N(!0),y(a),S({x:e.clientX,y:e.clientY,width:W.width,height:W.height})},te=e=>{if(!v)return;e.preventDefault();const a=e.clientX-E.x,r=e.clientY-E.y;let t=E.width,o=E.height;"width"!==w&&"both"!==w||(t=Math.max(K,Math.min(X,E.width+a))),"height"!==w&&"both"!==w||(o=Math.max(Y,Math.min(Q,E.height+r)));const i=window.innerWidth-(s.position?.x||0),n=window.innerHeight-(s.position?.y||0);t=Math.min(t,i),o=Math.min(o,n),l(s.id,{width:t,height:o})};e.useEffect(()=>(j?(document.addEventListener("mousemove",ae,{passive:!1}),document.addEventListener("mouseup",se),document.body.style.cursor="grabbing",document.body.style.userSelect="none"):v?(document.addEventListener("mousemove",te,{passive:!1}),document.addEventListener("mouseup",se),document.body.style.cursor="nw-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",ae),document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",se),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",ae),document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",se),document.body.style.cursor="",document.body.style.userSelect="",null!==$.current&&(cancelAnimationFrame($.current),$.current=null)}),[j,v,ae,se]);const oe={yellow:"bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200 shadow-yellow-100/50",pink:"bg-gradient-to-br from-rose-50 to-pink-50 border-rose-200 shadow-rose-100/50",blue:"bg-gradient-to-br from-blue-50 to-sky-50 border-blue-200 shadow-blue-100/50",green:"bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-200 shadow-emerald-100/50",purple:"bg-gradient-to-br from-purple-50 to-violet-50 border-purple-200 shadow-purple-100/50",orange:"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 shadow-orange-100/50",red:"bg-gradient-to-br from-red-50 to-rose-50 border-red-200 shadow-red-100/50",teal:"bg-gradient-to-br from-teal-50 to-cyan-50 border-teal-200 shadow-teal-100/50"},ie={yellow:"text-amber-800 dark:text-amber-200",pink:"text-rose-800 dark:text-rose-200",blue:"text-blue-800 dark:text-blue-200",green:"text-emerald-800 dark:text-emerald-200",purple:"text-purple-800 dark:text-purple-200",orange:"text-orange-800 dark:text-orange-200",red:"text-red-800 dark:text-red-200",teal:"text-teal-800 dark:text-teal-200"},ne=s.color,le=oe[ne]||oe.yellow,de=ie[ne]||ie.yellow;return a.jsxs(nt,{style:Z,className:`\n        transition-all duration-300 ease-out relative overflow-hidden\n        ${le}\n        dark:bg-[#2d2717] dark:border-[#3a3320] dark:shadow-[#bfae7c]/10\n        ${j?"opacity-90 shadow-2xl":"hover:shadow-lg hover:-translate-y-1"}\n        ${v?"opacity-90 shadow-xl":""}\n        border-2 backdrop-blur-sm group\n        shadow-md hover:shadow-xl\n        ${j?"z-50":""}\n      `,onMouseDown:ee,onClick:()=>!u&&!j&&!v&&x(!0),children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 via-transparent to-black/5 pointer-events-none"}),j&&a.jsx("div",{className:"absolute inset-0 bg-[#bfae7c]/10 border-2 border-dashed border-[#bfae7c]/30 rounded-lg pointer-events-none"}),a.jsxs(mt,{className:"p-5 h-full flex flex-col relative z-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 opacity-0 group-hover:opacity-100 transition-all duration-200",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(mr,{variant:"secondary",className:"text-xs opacity-60 bg-[#f3ecd2] dark:bg-[#23201a] text-[#bfae7c] dark:text-[#bfae7c]",children:s.color}),a.jsxs(mr,{variant:"outline",className:"text-xs opacity-60 border-[#e2d8b8] dark:border-[#3a3320] text-[#bfae7c] dark:text-[#bfae7c]",children:[W.width,"x",W.height]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(cr,{size:"sm",variant:"ghost",onClick:e=>{e.stopPropagation(),(()=>{const e=U?G:H;l(s.id,e),q(!U)})()},className:"h-7 w-7 p-0 rounded-full hover:bg-[#f3ecd2] dark:hover:bg-[#28231a] hover:text-[#7c6a3c] dark:hover:text-[#f8f5e4] transition-all duration-200","data-no-drag":!0,title:U?"Contrair":"Expandir",children:U?a.jsx(T,{className:"h-3.5 w-3.5"}):a.jsx(A,{className:"h-3.5 w-3.5"})}),a.jsxs(wt,{open:R,onOpenChange:J,children:[a.jsx(yt,{asChild:!0,children:a.jsx(cr,{size:"sm",variant:"ghost",onClick:e=>e.stopPropagation(),className:"h-7 w-7 p-0 rounded-full hover:bg-[#f3ecd2] dark:hover:bg-[#28231a] hover:text-[#7c6a3c] dark:hover:text-[#f8f5e4] transition-all duration-200","data-no-drag":!0,children:a.jsx(_,{className:"h-3.5 w-3.5"})})}),a.jsx(Ct,{className:"w-48 p-2 bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320]",children:a.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{name:"yellow",label:"Amarelo",class:"bg-yellow-400 hover:bg-yellow-500"},{name:"pink",label:"Rosa",class:"bg-pink-400 hover:bg-pink-500"},{name:"blue",label:"Azul",class:"bg-blue-400 hover:bg-blue-500"},{name:"green",label:"Verde",class:"bg-green-400 hover:bg-green-500"},{name:"purple",label:"Roxo",class:"bg-purple-400 hover:bg-purple-500"},{name:"orange",label:"Laranja",class:"bg-orange-400 hover:bg-orange-500"},{name:"red",label:"Vermelho",class:"bg-red-400 hover:bg-red-500"},{name:"teal",label:"Verde-azulado",class:"bg-teal-400 hover:bg-teal-500"}].map(e=>a.jsx(cr,{size:"sm",onClick:()=>(e=>{n(s.id,e),J(!1)})(e.name),className:`h-8 w-8 p-0 rounded-full ${e.class} transition-all duration-200 ${s.color===e.name?"ring-2 ring-[#bfae7c] dark:ring-[#bfae7c]":""}`,title:e.label,"data-no-drag":!0},e.name))})})]}),a.jsxs(ur,{open:F,onOpenChange:O,children:[a.jsx(xr,{asChild:!0,children:a.jsx(cr,{size:"sm",variant:"ghost",onClick:e=>e.stopPropagation(),className:"h-7 w-7 p-0 rounded-full hover:bg-red-100 dark:hover:bg-red-900/20 hover:text-red-600 dark:hover:text-red-400 transition-all duration-200","data-no-drag":!0,children:a.jsx(P,{className:"h-3.5 w-3.5"})})}),a.jsxs(hr,{className:"bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320]",children:[a.jsxs(gr,{children:[a.jsx(pr,{className:"text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Excluir Nota"}),a.jsx(fr,{className:"text-[#bfae7c] dark:text-[#bfae7c]",children:"Tem certeza que deseja excluir esta nota? Esta ação não pode ser desfeita."})]}),a.jsxs(jr,{children:[a.jsx(br,{className:"border-[#e2d8b8] dark:border-[#3a3320] text-[#7c6a3c] dark:text-[#f8f5e4] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a]",children:"Cancelar"}),a.jsx(vr,{onClick:()=>{O(!1),t(s.id)},className:"bg-red-600 hover:bg-red-700 text-white",children:"Excluir"})]})]})]})]})]}),a.jsx("div",{className:"flex-1 flex flex-col -mt-2",children:u?a.jsxs("div",{className:"flex flex-col h-full space-y-3",children:[a.jsx(Nt,{value:h,onChange:e=>g(e.target.value),className:`\n                  flex-1 text-sm resize-none bg-transparent border-none p-0 focus:ring-0 \n                  ${de} placeholder-[#bfae7c] dark:placeholder-[#bfae7c] \n                  overflow-y-auto scrollbar-thin scrollbar-thumb-[#bfae7c]/30 scrollbar-track-transparent\n                `,placeholder:"Digite sua nota...",autoFocus:!0,onClick:e=>e.stopPropagation(),"data-no-drag":!0,style:{minHeight:"100px"}}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{size:"sm",onClick:e=>{e.stopPropagation(),(async()=>{if(h.trim()){f(!0);try{await o(s.id,h.trim())}finally{f(!1)}}})()},disabled:p||!h.trim(),className:"flex-1 h-8 text-xs bg-[#bfae7c] hover:bg-[#7c6a3c] text-[#f8f5e4] shadow-sm","data-no-drag":!0,children:[a.jsx(D,{className:"h-3 w-3 mr-1"}),p?"Melhorando...":"IA"]}),a.jsxs(cr,{size:"sm",onClick:e=>{e.stopPropagation(),h.trim()&&(r(s.id,h.trim()),x(!1))},className:"flex-1 h-8 text-xs bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm","data-no-drag":!0,children:[a.jsx(z,{className:"h-3 w-3 mr-1"}),"Salvar"]}),a.jsxs(cr,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),g(s.text),x(!1)},className:"flex-1 h-8 text-xs hover:bg-[#f3ecd2] dark:hover:bg-[#28231a] border-[#e2d8b8] dark:border-[#3a3320] text-[#7c6a3c] dark:text-[#f8f5e4]","data-no-drag":!0,children:[a.jsx(I,{className:"h-3 w-3 mr-1"}),"Cancelar"]})]})]}):a.jsxs("div",{className:"flex-1 overflow-hidden cursor-text",children:[a.jsx("div",{className:"h-full overflow-y-auto scrollbar-thin scrollbar-thumb-[#bfae7c]/30 scrollbar-track-transparent pr-2",children:a.jsx("p",{className:`\n                  text-sm leading-relaxed ${de} whitespace-pre-wrap break-words\n                  ${s.text&&""!==s.text.trim()?"":"italic opacity-60"}\n                `,children:s.text&&""!==s.text.trim()?s.text:"Clique para adicionar uma nota..."})}),a.jsx("div",{className:"absolute bottom-3 right-3 opacity-0 group-hover:opacity-50 transition-opacity",children:a.jsx(M,{className:"h-3 w-3 text-[#bfae7c] dark:text-[#bfae7c]"})})]})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nw-resize opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:e=>re(e,"both"),"data-no-drag":!0,children:a.jsx("div",{className:"w-full h-full bg-[#bfae7c]/20 rounded-tl-md"})}),a.jsx("div",{className:"absolute top-0 right-0 w-2 h-full cursor-e-resize opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:e=>re(e,"width"),"data-no-drag":!0,children:a.jsx("div",{className:"w-full h-full bg-[#bfae7c]/10"})}),a.jsx("div",{className:"absolute bottom-0 left-0 w-full h-2 cursor-s-resize opacity-0 group-hover:opacity-100 transition-opacity",onMouseDown:e=>re(e,"height"),"data-no-drag":!0,children:a.jsx("div",{className:"w-full h-full bg-[#bfae7c]/10"})})]})]})},Et=()=>{const[s,r]=e.useState([]),[t,o]=e.useState(!0),[i,n]=e.useState(null),l=e.useRef(null);e.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await dr.auth.getUser();if(!e)return;const{data:a,error:s}=await dr.from("postit_notes").select("*").eq("user_id",e.id).order("created_at",{ascending:!0});if(s)throw s;const t=(a||[]).map(e=>({...e,position:"string"==typeof e.position?JSON.parse(e.position):e.position,size:e.size?"string"==typeof e.size?JSON.parse(e.size):e.size:{width:288,height:208}}));r(t)}catch(e){Cs.error("Erro ao carregar notas")}finally{o(!1)}},c=async()=>{try{const{data:{user:e}}=await dr.auth.getUser();if(!e)return;const a=["yellow","blue","green","pink","purple","orange","red","teal"],t=a[Math.floor(Math.random()*a.length)],o=(()=>{const e=288,a=208,r=20,t=window.innerWidth-48,o=Math.floor(t/308),i=Math.ceil(s.length/o),n=24+s.length%o*308,l=24+228*i+100;if(!s.some(s=>{const t=s.position?.x||0,o=s.position?.y||0,i=s.size?.width||e,d=s.size?.height||a;return n<t+i+r&&n+e+r>t&&l<o+d+r&&l+a+r>o}))return{x:n,y:l};for(let d=0;d<50;d++){const t=Math.random()*(window.innerWidth-e-100)+50,o=Math.random()*(window.innerHeight-a-100)+50;if(!s.some(s=>{const i=s.position?.x||0,n=s.position?.y||0,l=s.size?.width||e,d=s.size?.height||a;return t<i+l+r&&t+e+r>i&&o<n+d+r&&o+a+r>n}))return{x:t,y:o}}return{x:50,y:150}})(),i={text:"",position:o,size:{width:288,height:208},color:t,user_id:e.id},{data:n,error:l}=await dr.from("postit_notes").insert([i]).select().single();if(l)throw l;const d={...n,position:"string"==typeof n.position?JSON.parse(n.position):n.position,size:n.size?"string"==typeof n.size?JSON.parse(n.size):n.size:{width:288,height:208}};r([...s,d]),Cs.success("Nova nota adicionada")}catch(e){Cs.error("Erro ao adicionar nota")}},m=async(e,a)=>{try{const{error:t}=await dr.from("postit_notes").update({text:a}).eq("id",e);if(t)throw t;r(s.map(s=>s.id===e?{...s,text:a}:s)),Cs.success("Nota atualizada")}catch(t){Cs.error("Erro ao atualizar nota")}},u=async(e,a)=>{try{const{error:t}=await dr.from("postit_notes").update({position:a}).eq("id",e);if(t)throw t;r(s.map(s=>s.id===e?{...s,position:a}:s))}catch(t){}},x=async(e,a)=>{try{const{error:t}=await dr.from("postit_notes").update({size:a}).eq("id",e);if(t)throw t;r(s.map(s=>s.id===e?{...s,size:a}:s))}catch(t){}},h=async(e,a)=>{try{const{error:t}=await dr.from("postit_notes").update({color:a}).eq("id",e);if(t)throw t;r(s.map(s=>s.id===e?{...s,color:a}:s)),Cs.success("Cor da nota alterada")}catch(t){Cs.error("Erro ao alterar cor da nota")}},g=async(e,a)=>{try{const s=await fetch("https://zpufcvesenbhtmizmjiz.supabase.co/functions/v1/enhance-text-with-ai",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer YOUR_ANON_KEY_HERE"},body:JSON.stringify({text:a,type:"nota"})});if(!s.ok)throw new Error("Erro ao melhorar texto");const{enhancedText:r}=await s.json();r&&(await m(e,r),Cs.success("Nota melhorada com IA!"))}catch(s){Cs.error("Erro ao melhorar nota com IA")}},p=async e=>{try{const{error:a}=await dr.from("postit_notes").delete().eq("id",e);if(a)throw a;r(s.filter(a=>a.id!==e)),Cs.success("Nota removida")}catch(a){Cs.error("Erro ao remover nota")}},f=e=>{n(e)},j=()=>{n(null)};return t?a.jsx("div",{className:"flex items-center justify-center p-16 bg-[#f8f5e4] dark:bg-[#23201a] min-h-screen",children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#bfae7c] dark:border-[#bfae7c]"}),a.jsx("p",{className:"text-sm text-[#bfae7c] dark:text-[#bfae7c] font-medium",children:"Carregando suas notas..."})]})}):a.jsxs("div",{ref:l,className:"h-full flex flex-col bg-[#f8f5e4]/40 dark:bg-[#23201a]/40 min-h-screen p-6 relative overflow-hidden backdrop-blur-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8 z-10 relative",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-[#f3ecd2] to-[#e2d8b8] dark:from-[#2d2717] dark:to-[#3a3320] rounded-xl shadow-sm",children:a.jsx(k,{className:"h-6 w-6 text-[#7c6a3c] dark:text-[#f8f5e4]"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Minhas Notas"}),a.jsx("p",{className:"text-sm text-[#bfae7c] dark:text-[#bfae7c]",children:0===s.length?"Organize suas ideias":`${s.length} nota${1!==s.length?"s":""} criada${1!==s.length?"s":""}`})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[s.length>1&&a.jsxs(cr,{onClick:async()=>{const e=window.innerWidth-48,a=Math.floor(e/308),t=s.map((e,s)=>{const r=Math.floor(s/a);return{...e,position:{x:24+308*(s%a),y:24+228*r+100}}});try{const{data:{user:e}}=await dr.auth.getUser();if(!e)return;for(const a of t)await dr.from("postit_notes").update({position:a.position}).eq("id",a.id);r(t),Cs.success("Notas organizadas em grid!")}catch(o){Cs.error("Erro ao organizar notas")}},variant:"outline",className:"border-[#e2d8b8] dark:border-[#3a3320] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a] text-[#7c6a3c] dark:text-[#f8f5e4] shadow-sm",children:[a.jsx(E,{className:"h-4 w-4 mr-2"}),"Organizar"]}),a.jsxs(cr,{onClick:c,className:"bg-[#bfae7c] hover:bg-[#7c6a3c] text-[#f8f5e4] shadow-md hover:shadow-xl transition-all duration-300 px-6 z-10",children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Nova Nota"]})]})]}),a.jsx("div",{className:"flex-1 relative overflow-hidden",children:0===s.length?a.jsx(nt,{className:"p-16 text-center bg-[#f8f5e4] dark:bg-[#2d2717] border-2 border-dashed border-[#e2d8b8] dark:border-[#3a3320] backdrop-blur-sm",children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-[#bfae7c] to-[#7c6a3c] rounded-3xl mx-auto flex items-center justify-center shadow-lg",children:a.jsx(k,{className:"h-10 w-10 text-[#f8f5e4]"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-[#7c6a3c] dark:text-[#f8f5e4] mb-3",children:"Suas primeiras notas começam aqui"}),a.jsx("p",{className:"text-[#bfae7c] dark:text-[#bfae7c] max-w-md mx-auto leading-relaxed",children:"Organize seus pensamentos, ideias e lembretes importantes em notas visuais e práticas."})]}),a.jsxs(cr,{onClick:c,variant:"outline",className:"mt-4 border-[#e2d8b8] dark:border-[#3a3320] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a] text-[#7c6a3c] dark:text-[#f8f5e4]",children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Criar primeira nota"]})]})}):a.jsx("div",{className:"w-full h-full relative",children:s.map(e=>a.jsx(kt,{note:e,onEdit:m,onDelete:p,onEnhance:g,onPositionChange:u,onColorChange:h,onSizeChange:x,isDragging:i===e.id,onDragStart:f,onDragEnd:j},e.id))})})]})},St=e=>{const a=e.replace(/\D/g,"");return a.length<=11?a.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})/,"$1-$2"):e},Tt=e=>e.replace(/\D/g,""),At=e=>{const a=Tt(e);if(11!==a.length)return!1;if(/^(\d)\1{10}$/.test(a))return!1;let s=0;for(let t=0;t<9;t++)s+=parseInt(a[t])*(10-t);let r=10*s%11;if(10!==r&&11!==r||(r=0),r!==parseInt(a[9]))return!1;s=0;for(let t=0;t<10;t++)s+=parseInt(a[t])*(11-t);return r=10*s%11,10!==r&&11!==r||(r=0),r===parseInt(a[10])},_t=()=>{const[a,s]=e.useState(!1);return{salvarChamado:async e=>{try{s(!0);const a="Outro (personalizado)"===e.resumo?e.resumoCustom:e.resumo,{data:r,error:t}=await dr.from("chamados").insert({titulo:a,descricao:e.notas,grau:e.grau||null,numero_processo:e.processos||null,orgao_julgador:e.orgaoJulgador||null,perfil_usuario_afetado:e.perfilUsuario||null,nome_usuario_afetado:e.nomeUsuario||null,cpf_usuario_afetado:e.cpfUsuario||null,chamado_origem:e.chamadoOrigem||null,status:"Aberto"}).select().single();if(t)throw t;return Cs.success("Chamado salvo na base de dados"),r}catch(a){return Cs.error("Erro ao salvar chamado na base de dados"),null}finally{s(!1)}},buscarChamadosRecentes:async(e=10)=>{try{const{data:a,error:s}=await dr.from("chamados").select("*").order("created_at",{ascending:!1}).limit(e);if(s)throw s;return(a||[]).map(e=>({id:e.id,titulo:e.titulo||"Sem título",descricao:e.descricao||"Sem descrição",grau:e.grau,numero_processo:e.numero_processo,orgao_julgador:e.orgao_julgador,perfil_usuario_afetado:e.perfil_usuario_afetado,nome_usuario_afetado:e.nome_usuario_afetado,cpf_usuario_afetado:e.cpf_usuario_afetado,chamado_origem:e.chamado_origem,created_at:e.created_at,status:e.status||"Aberto"}))}catch(a){return[]}},excluirChamado:async e=>{try{const{error:a}=await dr.from("chamados").delete().eq("id",e);if(a)throw a;return Cs.success("Chamado excluído com sucesso"),!0}catch(a){return Cs.error("Erro ao excluir chamado"),!1}},buscarDadosUsuarioPorCPF:async e=>{try{const a=Tt(e),{data:s,error:r}=await dr.from("chamados").select("nome_usuario_afetado, perfil_usuario_afetado, cpf_usuario_afetado").eq("cpf_usuario_afetado",a).not("nome_usuario_afetado","is",null).not("perfil_usuario_afetado","is",null).order("created_at",{ascending:!1}).limit(1).single();if(r&&"PGRST116"!==r.code)throw r;return s}catch(a){return null}},loading:a}},Pt=e=>{const a=[];return e.nome_usuario_afetado&&a.push(e.nome_usuario_afetado),e.cpf_usuario_afetado&&a.push(e.cpf_usuario_afetado),e.perfil_usuario_afetado&&a.push(e.perfil_usuario_afetado),e.orgao_julgador&&a.push(e.orgao_julgador),a.join(" / ")},Dt=e=>{switch(e){case"Aberto":return"bg-blue-500";case"Em andamento":return"bg-yellow-500";case"Fechado":return"bg-green-500";default:return"bg-gray-500"}},zt=()=>{const a=F(),{buscarChamadosRecentes:s,excluirChamado:r}=_t(),[t,o]=e.useState([]),[i,n]=e.useState(!0);e.useEffect(()=>{(async()=>{n(!0);const e=await s(20);o(e),n(!1)})()},[]);return{chamados:t,loading:i,handleCopiarDescricao:e=>{(e=>{let a=`Título: ${e.titulo}\n\n`;if(a+=`Descrição: ${e.descricao}\n\n`,e.numero_processo&&(a+=`Número do Processo: ${e.numero_processo}\n\n`),e.nome_usuario_afetado||e.cpf_usuario_afetado||e.perfil_usuario_afetado){a+="Usuário: ";const s=[];e.nome_usuario_afetado&&s.push(e.nome_usuario_afetado),e.cpf_usuario_afetado&&s.push(e.cpf_usuario_afetado),e.perfil_usuario_afetado&&s.push(e.perfil_usuario_afetado),a+=s.join(" - ")+"\n\n"}navigator.clipboard.writeText(a)})(e),Cs.success("Descrição copiada para a área de transferência!")},criarTemplateDoChamado:e=>{const s=new URLSearchParams({resumo:e.titulo,grau:e.grau||"",processos:e.numero_processo||"",orgaoJulgador:e.orgao_julgador||"",perfilUsuario:e.perfil_usuario_afetado||"",cpfUsuario:e.cpf_usuario_afetado||"",nomeUsuario:e.nome_usuario_afetado||"",chamadoOrigem:e.chamado_origem||"",notas:e.descricao});a(`/?${s.toString()}`),Cs.success("Template criado! Dados carregados no formulário.")},duplicarChamado:e=>{const s=new URLSearchParams({resumo:e.titulo});a(`/criar-chamado?${s.toString()}`),Cs.success("Chamado duplicado! Preencha os novos dados.")},editarChamado:e=>{const s=new URLSearchParams({resumo:e.titulo,grau:e.grau||"",processos:e.numero_processo||"",orgaoJulgador:e.orgao_julgador||"",perfilUsuario:e.perfil_usuario_afetado||"",cpfUsuario:e.cpf_usuario_afetado||"",nomeUsuario:e.nome_usuario_afetado||"",chamadoOrigem:e.chamado_origem||"",notas:e.descricao,editId:e.id});a(`/criar-chamado?${s.toString()}`),Cs.success("Dados carregados para edição!")},handleExcluirChamado:async e=>{await r(e)&&o(t.filter(a=>a.id!==e))},buscarUltimos3Chamados:async()=>{n(!0);const e=await s(3);o(e),n(!1)}}},It=e.forwardRef(({className:e,...s},r)=>a.jsx(O,{ref:r,className:lr("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));It.displayName=O.displayName;const Mt=e.forwardRef(({className:e,...s},r)=>a.jsx(R,{ref:r,className:lr("aspect-square h-full w-full",e),...s}));Mt.displayName=R.displayName;const Ft=e.forwardRef(({className:e,...s},r)=>a.jsx(J,{ref:r,className:lr("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));Ft.displayName=J.displayName;const Ot=Z,Rt=ee,Jt=L,Ut=ae,qt=e.forwardRef(({className:e,inset:s,children:r,...t},o)=>a.jsxs(U,{ref:o,className:lr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",e),...t,children:[r,a.jsx(q,{className:"ml-auto h-4 w-4"})]}));qt.displayName=U.displayName;const Vt=e.forwardRef(({className:e,...s},r)=>a.jsx(V,{ref:r,className:lr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));Vt.displayName=V.displayName;const Lt=e.forwardRef(({className:e,sideOffset:s=4,...r},t)=>a.jsx(L,{children:a.jsx($,{ref:t,sideOffset:s,className:lr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Lt.displayName=$.displayName;const $t=e.forwardRef(({className:e,inset:s,...r},t)=>a.jsx(B,{ref:t,className:lr("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",e),...r}));$t.displayName=B.displayName;e.forwardRef(({className:e,children:s,checked:r,...t},o)=>a.jsxs(G,{ref:o,className:lr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...t,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(H,{children:a.jsx(X,{className:"h-4 w-4"})})}),s]})).displayName=G.displayName;e.forwardRef(({className:e,children:s,...r},t)=>a.jsxs(Q,{ref:t,className:lr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(H,{children:a.jsx(K,{className:"h-2 w-2 fill-current"})})}),s]})).displayName=Q.displayName;const Bt=e.forwardRef(({className:e,inset:s,...r},t)=>a.jsx(Y,{ref:t,className:lr("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...r}));Bt.displayName=Y.displayName;const Gt=e.forwardRef(({className:e,...s},r)=>a.jsx(W,{ref:r,className:lr("-mx-1 my-1 h-px bg-muted",e),...s}));Gt.displayName=W.displayName;const Ht=()=>{const{user:s,signOut:r}=tt(),t=F(),[o,i]=e.useState(null);e.useEffect(()=>{s&&n()},[s]),e.useEffect(()=>{if(!s)return;const e=dr.channel("profile-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"profiles",filter:`id=eq.${s.id}`},e=>{i(e.new)}).subscribe();return()=>{dr.removeChannel(e)}},[s]);const n=async()=>{try{if(!s)return;const{data:e,error:a}=await dr.from("profiles").select("*").eq("id",s.id).single();if(a)throw a;i(e)}catch(e){}},l=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U";return s&&o?a.jsxs(Ot,{children:[a.jsx(Rt,{asChild:!0,children:a.jsxs(cr,{variant:"ghost",className:"relative flex items-center gap-3 h-auto p-2 rounded-xl hover:shadow-medium transition-all duration-200 hover:bg-gradient-accent",children:[a.jsxs(It,{className:"h-10 w-10 border-2 border-primary/20",children:[a.jsx(Mt,{src:o.avatar_url||"",alt:o.nome_completo||"Avatar"}),a.jsx(Ft,{className:"bg-gradient-primary text-primary-foreground font-medium",children:l(o.nome_completo)})]}),a.jsxs("div",{className:"hidden sm:flex flex-col items-start text-left",children:[a.jsx("span",{className:"text-sm font-medium",children:o.nome_completo||"Nome não informado"}),o.is_admin&&a.jsxs("span",{className:"text-xs text-primary font-semibold flex items-center gap-1 mt-0.5",children:[a.jsx(g,{className:"h-3 w-3 text-primary"})," Administrador"]}),a.jsx("span",{className:"text-xs text-muted-foreground"})]})]})}),a.jsxs(Lt,{className:"w-64 bg-card/95 backdrop-blur-sm border shadow-xl",align:"end",forceMount:!0,children:[a.jsx(Bt,{className:"font-normal",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(It,{className:"h-12 w-12 border-2 border-primary/20",children:[a.jsx(Mt,{src:o.avatar_url||"",alt:o.nome_completo||"Avatar"}),a.jsx(Ft,{className:"bg-gradient-primary text-primary-foreground font-medium",children:l(o.nome_completo)})]}),a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("p",{className:"text-sm font-medium leading-none",children:o.nome_completo||"Nome não informado"}),a.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:o.email}),o.is_admin&&a.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[a.jsx(g,{className:"h-3 w-3 text-primary"}),a.jsx("span",{className:"text-xs text-primary font-medium",children:"Administrador"})]})]})]})}),a.jsx(Gt,{}),a.jsxs($t,{onClick:()=>t("/profile"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(se,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Meu Perfil"})]}),a.jsxs($t,{onClick:()=>t("/memorias-importantes"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(re,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Memórias Importantes"})]}),o.is_admin&&a.jsxs($t,{onClick:()=>t("/admin/usuarios"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(g,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Gerenciar Usuários"})]}),o.is_admin&&a.jsxs($t,{onClick:()=>t("/admin/atalhos"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Gerenciar Atalhos"})]}),o.is_admin&&a.jsxs($t,{onClick:()=>t("/admin/notificacoes"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(oe,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Configurar Notificações"})]}),o.is_admin&&a.jsxs($t,{onClick:()=>t("/admin/metricas"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(ie,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Métricas do Sistema"})]}),o.is_admin&&a.jsxs(Ut,{children:[a.jsxs(qt,{className:"cursor-pointer",children:[a.jsx(ne,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Ferramentas IA"})]}),a.jsx(Jt,{children:a.jsxs(Vt,{className:"w-48",children:[a.jsxs($t,{onClick:()=>window.open("https://chat.openai.com","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"ChatGPT"})]}),a.jsxs($t,{onClick:()=>window.open("https://claude.ai","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Claude.ai"})]}),a.jsxs($t,{onClick:()=>window.open("https://www.perplexity.ai","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Perplexity"})]}),a.jsxs($t,{onClick:()=>window.open("https://lovable.dev","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Lovable"})]}),a.jsxs($t,{onClick:()=>window.open("https://base44.com.br","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Base44"})]}),a.jsxs($t,{onClick:()=>window.open("https://abacus.ai","_blank"),className:"cursor-pointer",children:[a.jsx(te,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Abacus"})]})]})})]}),o.is_admin&&a.jsxs($t,{onClick:()=>t("/admin/feriados"),className:"cursor-pointer hover:bg-gradient-accent",children:[a.jsx(le,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Administração de Feriados"})]}),a.jsx(Gt,{}),a.jsxs($t,{onClick:async()=>{await r(),t("/auth")},className:"cursor-pointer text-destructive focus:text-destructive hover:bg-destructive/10",children:[a.jsx(de,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Sair"})]})]})]}):null};function Xt(){const{setTheme:s}=(()=>{const a=e.useContext(ot);if(void 0===a)throw new Error("useTheme must be used within a ThemeProvider");return a})();return a.jsxs(Ot,{children:[a.jsx(Rt,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"icon",className:"h-9 w-9",children:[a.jsx(ce,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),a.jsx(me,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),a.jsx("span",{className:"sr-only",children:"Alternar tema"})]})}),a.jsxs(Lt,{align:"end",children:[a.jsx($t,{onClick:()=>s("light"),children:"Claro"}),a.jsx($t,{onClick:()=>s("dark"),children:"Escuro"}),a.jsx($t,{onClick:()=>s("system"),children:"Sistema"})]})]})}const Qt=()=>{const[s,r]=e.useState(new Date);e.useEffect(()=>{const e=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(e)},[]);return a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(h,{className:"h-4 w-4 text-primary"}),a.jsx("div",{className:"font-mono font-bold text-lg text-primary",children:(t=s,t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}))})]});var t};function Kt({className:e,classNames:s,showOutsideDays:r=!0,...t}){return a.jsx(ue,{showOutsideDays:r,className:lr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:lr(Nr({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:lr(Nr({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...e})=>a.jsx(xe,{className:"h-4 w-4"}),IconRight:({...e})=>a.jsx(q,{className:"h-4 w-4"})},...t})}Kt.displayName="Calendar";const Yt=()=>{const[s,r]=e.useState(new Date),[t,o]=e.useState(!1);return a.jsxs(wt,{open:t,onOpenChange:o,children:[a.jsx(yt,{asChild:!0,children:a.jsxs(cr,{variant:"outline",className:"flex items-center gap-2 hover:scale-105 transition-transform",children:[a.jsx(le,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:(i=s,i.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}))})]})}),a.jsx(Ct,{className:"w-auto p-0",align:"end",children:a.jsx(Kt,{mode:"single",selected:s,onSelect:e=>{e&&(r(e),o(!1))},initialFocus:!0,className:lr("p-3 pointer-events-auto")})})]});var i},Wt=e.forwardRef(({className:e,...s},r)=>a.jsx(he,{className:lr("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:r,children:a.jsx(ge,{className:lr("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Wt.displayName=he.displayName;const Zt=Ns("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),eo=e.forwardRef(({className:e,...s},r)=>a.jsx(pe,{ref:r,className:lr(Zt(),e),...s}));eo.displayName=pe.displayName;const ao=Pe,so=De,ro=e.forwardRef(({className:e,children:s,...r},t)=>a.jsxs(fe,{ref:t,className:lr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[s,a.jsx(je,{asChild:!0,children:a.jsx(be,{className:"h-4 w-4 opacity-50"})})]}));ro.displayName=fe.displayName;const to=e.forwardRef(({className:e,...s},r)=>a.jsx(ve,{ref:r,className:lr("flex cursor-default items-center justify-center py-1",e),...s,children:a.jsx(Ne,{className:"h-4 w-4"})}));to.displayName=ve.displayName;const oo=e.forwardRef(({className:e,...s},r)=>a.jsx(we,{ref:r,className:lr("flex cursor-default items-center justify-center py-1",e),...s,children:a.jsx(be,{className:"h-4 w-4"})}));oo.displayName=we.displayName;const io=e.forwardRef(({className:e,children:s,position:r="popper",...t},o)=>a.jsx(ye,{children:a.jsxs(Ce,{ref:o,className:lr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...t,children:[a.jsx(to,{}),a.jsx(ke,{className:lr("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),a.jsx(oo,{})]})}));io.displayName=Ce.displayName;e.forwardRef(({className:e,...s},r)=>a.jsx(Ee,{ref:r,className:lr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=Ee.displayName;const no=e.forwardRef(({className:e,children:s,...r},t)=>a.jsxs(Se,{ref:t,className:lr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Te,{children:a.jsx(X,{className:"h-4 w-4"})})}),a.jsx(Ae,{children:s})]}));no.displayName=Se.displayName;e.forwardRef(({className:e,...s},r)=>a.jsx(_e,{ref:r,className:lr("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=_e.displayName;const lo=({isOpen:e,onOpenChange:s,editingNotification:r,formData:t,setFormData:o,onSubmit:i,onCancel:n})=>a.jsx(wr,{open:e,onOpenChange:s,children:a.jsxs(yr,{className:"max-w-2xl dark:bg-gray-900 dark:border-gray-700",children:[a.jsxs(Cr,{children:[a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(oe,{className:"h-5 w-5"}),r?"Editar Notificação":"Nova Notificação Semanal"]}),a.jsx(Er,{className:"dark:text-gray-400",children:r?"Edite as informações da notificação semanal":"Crie uma nova notificação para lembretes semanais"})]}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),t.titulo.trim()&&t.mensagem.trim()&&i()},className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"titulo",className:"text-sm font-medium dark:text-gray-300",children:"Título *"}),a.jsx(Sr,{id:"titulo",value:t.titulo,onChange:e=>o(a=>({...a,titulo:e.target.value})),placeholder:"Ex: Verificar suspensão de prazos no PJe",required:!0})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"mensagem",className:"text-sm font-medium dark:text-gray-300",children:"Mensagem de Lembrete *"}),a.jsx(Nt,{id:"mensagem",value:t.mensagem,onChange:e=>o(a=>({...a,mensagem:e.target.value})),placeholder:"Ex: IMPORTANTE: Sempre que houver uma paralização no sistema, temos que publicar no calendário do PJE que os prazos têm que ficar suspensos",rows:4,className:"resize-none",required:!0}),a.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-1",children:"Esta mensagem será exibida nas notificações semanais"})]}),a.jsxs(nt,{className:"border-2 border-dashed border-green-200 bg-green-50/50 dark:border-green-700 dark:bg-green-900/20",children:[a.jsx(lt,{className:"pb-3",children:a.jsxs(dt,{className:"flex items-center gap-2 text-lg dark:text-gray-200",children:[a.jsx(le,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),"Agendamento da Notificação"]})}),a.jsxs(mt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"dayOfWeek",className:"text-sm font-medium dark:text-gray-300",children:"Dia da Semana *"}),a.jsxs(ao,{value:t.dayofweek?.toString()||"1",onValueChange:e=>o(a=>({...a,dayofweek:parseInt(e)})),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione o dia"})}),a.jsx(io,{children:[{value:0,label:"Domingo"},{value:1,label:"Segunda-feira"},{value:2,label:"Terça-feira"},{value:3,label:"Quarta-feira"},{value:4,label:"Quinta-feira"},{value:5,label:"Sexta-feira"},{value:6,label:"Sábado"}].map(e=>a.jsx(no,{value:e.value.toString(),children:e.label},e.value))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"time",className:"text-sm font-medium dark:text-gray-300",children:"Horário *"}),a.jsxs(ao,{value:t.time||"09:00",onValueChange:e=>o(a=>({...a,time:e})),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione o horário"})}),a.jsx(io,{children:[{value:"08:00",label:"08:00"},{value:"09:00",label:"09:00"},{value:"10:00",label:"10:00"},{value:"11:00",label:"11:00"},{value:"12:00",label:"12:00"},{value:"13:00",label:"13:00"},{value:"14:00",label:"14:00"},{value:"15:00",label:"15:00"},{value:"16:00",label:"16:00"},{value:"17:00",label:"17:00"}].map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-2",children:"A notificação será enviada no dia e horário especificados"})]})]})]}),a.jsxs(nt,{className:"border-2 border-dashed border-blue-200 bg-blue-50/50 dark:border-blue-700 dark:bg-blue-900/20",children:[a.jsx(lt,{className:"pb-3",children:a.jsxs(dt,{className:"flex items-center gap-2 text-lg dark:text-gray-200",children:[a.jsx(h,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),"Status da Notificação"]})}),a.jsx(mt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(eo,{className:"text-sm font-medium dark:text-gray-300",children:"Notificação ativa"}),a.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:"Quando ativa, esta notificação será incluída nos lembretes semanais"})]}),a.jsx(Wt,{checked:t.ativo,onCheckedChange:e=>o(a=>({...a,ativo:e}))})]})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),a.jsx(cr,{type:"submit",disabled:!t.titulo.trim()||!t.mensagem.trim(),children:r?"Atualizar":"Criar"})]})]})]})}),co=()=>{const{notifications:s,isLoading:r,settings:t,saveSettings:o,saveNotification:i,deleteNotification:n,testNotification:l}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState(!0),[o,i]=e.useState({enabled:!0,frequency:"weekly",dayofweek:1,time:"09:00"});e.useEffect(()=>{const e=localStorage.getItem("weeklyNotificationSettings");if(e)try{const a=JSON.parse(e);i({enabled:a.enabled??!0,frequency:a.frequency??"weekly",dayofweek:a.dayofweek??1,time:a.time??"09:00"})}catch(a){}},[]);const n=async()=>{try{t(!0);const{data:e,error:a}=await dr.from("weekly_notifications").select("*").order("created_at",{ascending:!1});if(a)throw a;s(e||[])}catch(e){e instanceof TypeError&&"Failed to fetch"===e.message?Cs.error("Erro de conexão ao carregar notificações. Verifique sua internet."):Cs.error(`Erro ao carregar notificações: ${e?.message||"Erro desconhecido"}`)}finally{t(!1)}};return e.useEffect(()=>{n()},[]),{notifications:a,isLoading:r,settings:o,saveSettings:e=>{i(e),localStorage.setItem("weeklyNotificationSettings",JSON.stringify(e)),Cs.success("Configurações salvas com sucesso!")},saveNotification:async(e,a)=>{try{if(a){const{data:s,error:r}=await dr.from("weekly_notifications").update({titulo:e.titulo,mensagem:e.mensagem,ativo:e.ativo,dayofweek:e.dayofweek,time:e.time,updated_at:(new Date).toISOString()}).eq("id",a).select();if(r)throw r;Cs.success("Notificação atualizada com sucesso!")}else{const{data:a,error:s}=await dr.from("weekly_notifications").insert({titulo:e.titulo,mensagem:e.mensagem,ativo:e.ativo,dayofweek:e.dayofweek,time:e.time}).select();if(s)throw s;Cs.success("Notificação criada com sucesso!")}return await n(),!0}catch(s){return s instanceof TypeError&&"Failed to fetch"===s.message?Cs.error("Erro de conexão. Verifique sua internet e tente novamente."):s?.message?.includes("JWT")?Cs.error("Sessão expirada. Faça login novamente."):s?.message?.includes("permission")?Cs.error("Sem permissão para realizar esta ação."):Cs.error(`Erro ao salvar notificação: ${s?.message||"Erro desconhecido"}`),!1}},deleteNotification:async e=>{try{const{error:a}=await dr.from("weekly_notifications").delete().eq("id",e);if(a)throw a;Cs.success("Notificação excluída com sucesso!"),await n()}catch(a){Cs.error("Erro ao excluir notificação")}},testNotification:e=>{Cs.info(`Teste: ${e.titulo}`,{description:e.mensagem,duration:5e3})},fetchNotifications:n}})(),[d,c]=e.useState(!1),[m,u]=e.useState(!1),[x,g]=e.useState(null),[p,f]=e.useState({titulo:"",mensagem:"",ativo:!0,dayofweek:1,time:"09:00"}),j=[{value:1,label:"Segunda-feira"},{value:2,label:"Terça-feira"},{value:3,label:"Quarta-feira"},{value:4,label:"Quinta-feira"},{value:5,label:"Sexta-feira"}],b=s.filter(e=>e.ativo);return a.jsxs(a.Fragment,{children:[a.jsxs(wr,{open:d,onOpenChange:c,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:lr("flex items-center gap-2 transition-all duration-200 hover:shadow-md","dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-gray-200",t.enabled&&b.length>0&&"border-blue-200 bg-blue-50 hover:bg-blue-100 dark:border-blue-400 dark:bg-blue-900/30 dark:hover:bg-blue-800/40"),children:[a.jsxs("div",{className:"relative",children:[a.jsx(oe,{className:"h-4 w-4"}),t.enabled&&b.length>0&&a.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]}),"Notificações Semanais",t.enabled&&b.length>0&&a.jsx(mr,{variant:"secondary",className:"ml-1 bg-blue-100 text-blue-700 dark:bg-blue-800/50 dark:text-blue-300 dark:border-blue-600",children:b.length})]})}),a.jsxs(yr,{className:"max-w-5xl max-h-[90vh] overflow-y-auto dark:bg-gray-900 dark:border-gray-700",children:[a.jsx(Cr,{className:"space-y-4 pb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:a.jsx(oe,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx(kr,{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Notificações Semanais"}),a.jsx(Er,{className:"text-base mt-1 dark:text-gray-300",children:"Configure lembretes automáticos para procedimentos importantes"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[t.enabled?a.jsxs(mr,{className:"bg-green-100 text-green-700 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-600",children:[a.jsx(ze,{className:"h-3 w-3 mr-1"}),"Ativo"]}):a.jsxs(mr,{variant:"secondary",className:"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600",children:[a.jsx(I,{className:"h-3 w-3 mr-1"}),"Inativo"]}),a.jsxs(mr,{variant:"outline",className:"text-sm dark:border-gray-600 dark:text-gray-300",children:[s.length," ",1===s.length?"notificação":"notificações"]})]})]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs(nt,{className:"border-2 border-dashed border-gray-200 hover:border-blue-300 transition-colors duration-200 dark:border-gray-700 dark:hover:border-blue-500 dark:bg-gray-800",children:[a.jsx(lt,{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-t-lg dark:from-blue-900/20 dark:to-purple-900/20",children:a.jsxs(dt,{className:"text-lg flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-white rounded-md shadow-sm dark:bg-gray-700",children:a.jsx(Ie,{className:"h-4 w-4 text-blue-600"})}),"Configurações Gerais"]})}),a.jsxs(mt,{className:"space-y-6 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border dark:bg-gray-800 dark:border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:lr("p-2 rounded-full transition-colors duration-200",t.enabled?"bg-green-100":"bg-gray-100"),children:t.enabled?a.jsx(ze,{className:"h-5 w-5 text-green-600"}):a.jsx(I,{className:"h-5 w-5 text-gray-400"})}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"enable-notifications",className:"text-base font-medium cursor-pointer dark:text-gray-200",children:"Ativar Notificações Semanais"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1 dark:text-gray-400",children:"Receba lembretes automáticos sobre procedimentos importantes"})]})]}),a.jsx(Wt,{id:"enable-notifications",checked:t.enabled,onCheckedChange:e=>o({...t,enabled:e}),className:"data-[state=checked]:bg-green-500"})]}),t.enabled&&a.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200 dark:bg-blue-900/20 dark:border-blue-700",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700 dark:text-blue-300",children:[a.jsx(oe,{className:"h-4 w-4"}),a.jsx("span",{className:"font-medium",children:"Sistema de notificações ativo. Configure os horários individuais ao criar cada notificação."})]})})]})]}),a.jsxs(nt,{className:"border-2 border-dashed border-gray-200 hover:border-purple-300 transition-colors duration-200 dark:border-gray-700 dark:hover:border-purple-500 dark:bg-gray-800",children:[a.jsx(lt,{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-lg dark:from-purple-900/20 dark:to-pink-900/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(dt,{className:"text-lg flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-white rounded-md shadow-sm dark:bg-gray-700",children:a.jsx(oe,{className:"h-4 w-4 text-purple-600"})}),"Suas Notificações",a.jsx(mr,{variant:"outline",className:"ml-2 bg-white dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300",children:s.length})]}),a.jsxs(cr,{onClick:()=>u(!0),size:"sm",className:"flex items-center gap-2 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-md hover:shadow-lg transition-all duration-200",children:[a.jsx(S,{className:"h-4 w-4"}),"Nova Notificação"]})]})}),a.jsx(mt,{className:"p-6",children:r?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Carregando notificações..."})]}):0===s.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full w-20 h-20 mx-auto mb-6 flex items-center justify-center dark:from-purple-900/30 dark:to-pink-900/30",children:a.jsx(oe,{className:"h-10 w-10 text-purple-500"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2 dark:text-gray-200",children:"Nenhuma notificação ainda"}),a.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto dark:text-gray-400",children:"Crie sua primeira notificação semanal para receber lembretes automáticos sobre procedimentos importantes."}),a.jsxs(cr,{onClick:()=>u(!0),className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-md hover:shadow-lg transition-all duration-200",children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Criar primeira notificação"]})]}):a.jsx("div",{className:lr("grid gap-4",1===s.length?"grid-cols-1":2===s.length?"grid-cols-1 lg:grid-cols-2":"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3"),children:s.map((e,s)=>a.jsxs("div",{className:lr("group relative p-5 border-2 rounded-xl transition-all duration-200 hover:shadow-lg",e.ativo?"border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 hover:border-green-300 dark:border-green-700 dark:from-green-900/20 dark:to-emerald-900/20 dark:hover:border-green-600":"border-gray-200 bg-gradient-to-br from-gray-50 to-slate-50 hover:border-gray-300 dark:border-gray-700 dark:from-gray-800 dark:to-slate-800 dark:hover:border-gray-600"),style:{animationDelay:100*s+"ms"},children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("div",{className:lr("p-2 rounded-lg",e.ativo?"bg-green-100":"bg-gray-100"),children:e.ativo?a.jsx(ze,{className:"h-5 w-5 text-green-600"}):a.jsx(I,{className:"h-5 w-5 text-gray-400"})}),a.jsx(mr,{variant:e.ativo?"default":"secondary",className:lr("transition-all duration-200",e.ativo?"bg-green-100 text-green-700 border-green-200 hover:bg-green-200":"bg-gray-100 text-gray-600 border-gray-200"),children:e.ativo?"Ativo":"Inativo"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"font-semibold text-lg mb-2 line-clamp-2 group-hover:text-purple-700 transition-colors",children:e.titulo}),a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3 leading-relaxed",children:e.mensagem})]}),a.jsx("div",{className:"mb-3 p-2 bg-blue-50 rounded-md border border-blue-200 dark:bg-blue-900/20 dark:border-blue-700",children:a.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700 dark:text-blue-300",children:[a.jsx(le,{className:"h-3 w-3"}),a.jsx("span",{children:j.find(a=>a.value===e.dayofweek)?.label||"Dia não definido"}),a.jsx(h,{className:"h-3 w-3 ml-2"}),a.jsx("span",{children:e.time||"09:00"})]})}),a.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Criado em ",new Date(e.created_at).toLocaleDateString("pt-BR")]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>(e=>{g(e),f({titulo:e.titulo,mensagem:e.mensagem,ativo:e.ativo||!1,dayofweek:e.dayofweek||1,time:e.time||"09:00"}),u(!0)})(e),className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-300 transition-colors",children:a.jsx(Me,{className:"h-3.5 w-3.5"})}),a.jsxs(ur,{children:[a.jsx(xr,{asChild:!0,children:a.jsx(cr,{variant:"outline",size:"sm",className:"h-8 w-8 p-0 hover:bg-red-50 hover:border-red-300 transition-colors",children:a.jsx(P,{className:"h-3.5 w-3.5"})})}),a.jsxs(hr,{children:[a.jsxs(gr,{children:[a.jsx(pr,{children:"Confirmar exclusão"}),a.jsxs(fr,{children:['Tem certeza que deseja excluir a notificação "',e.titulo,'"? Esta ação não pode ser desfeita.']})]}),a.jsxs(jr,{children:[a.jsx(br,{children:"Cancelar"}),a.jsx(vr,{onClick:()=>(async e=>{await n(e)})(e.id),className:"bg-red-500 hover:bg-red-600",children:"Excluir"})]})]})]})]})]})]},e.id))})})]}),a.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:t.enabled?a.jsx("span",{children:b.length>0?`${b.length} notificação${b.length>1?"ões":""} ativa${b.length>1?"s":""}`:"Nenhuma notificação ativa"}):a.jsx("span",{children:"Notificações desabilitadas"})}),a.jsxs(cr,{onClick:()=>{b.length>0&&l(b[0])},variant:"outline",className:"flex items-center gap-2",disabled:!t.enabled||0===b.length,children:[a.jsx(Fe,{className:"h-4 w-4"}),"Testar Notificação"]})]})]})]})]}),a.jsx(lo,{isOpen:m,onOpenChange:u,editingNotification:x,formData:p,setFormData:f,onSubmit:async()=>{try{await i(p,x?.id)&&(u(!1),g(null),f({titulo:"",mensagem:"",ativo:!0,dayofweek:1,time:"09:00"}))}catch(e){}},onCancel:()=>{u(!1),g(null),f({titulo:"",mensagem:"",ativo:!0,dayofweek:1,time:"09:00"})}})]})},mo=({user:e,isBusinessDay:s,nextBusinessDay:r,onSearch:t})=>a.jsxs(pt,{variant:"glass",className:"mb-8 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/8 via-purple-500/5 to-blue-500/8"}),a.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(120,119,198,0.1),transparent_50%)]"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-6 pb-4",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 items-center",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"flex items-start gap-5",children:[a.jsx("a",{href:"https://trt15.jus.br/",target:"_blank",rel:"noopener noreferrer",className:"group flex-shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-primary via-primary/90 to-purple-600 rounded-3xl shadow-xl group-hover:shadow-2xl transition-all duration-500 group-hover:scale-105 group-hover:rotate-3",children:a.jsx("img",{src:"/lovable-uploads/622691d5-a295-40f0-ad0d-cb958024c4ba.png",alt:"Brasão TRT15",className:"h-12 w-12 drop-shadow-lg"})}),a.jsx("div",{className:"absolute -top-2 -right-2 w-5 h-5 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full border-3 border-white shadow-lg animate-pulse"})]})}),a.jsxs("div",{className:"flex flex-col justify-center min-h-[4rem]",children:[a.jsx("div",{className:"mb-2",children:a.jsx("h1",{className:"text-3xl lg:text-4xl xl:text-5xl font-black bg-gradient-to-r from-primary via-purple-600 to-blue-600 bg-clip-text text-transparent leading-tight",children:"NAPJe Dashboard"})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 bg-primary/10 backdrop-blur-sm px-3 py-1.5 rounded-full border border-primary/20",children:[a.jsx(D,{className:"h-4 w-4 text-primary animate-pulse"}),a.jsx("span",{className:"text-sm font-medium text-primary",children:"Central Inteligente"})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Sistema Online"})]})]})]})]})}),a.jsx("div",{className:"lg:col-span-1 flex justify-end",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-card/50 via-card/70 to-card/50 backdrop-blur-xl rounded-3xl p-2 border border-border/20 shadow-xl",children:[t&&a.jsxs(ht,{variant:"glass",size:"sm",onClick:t,className:"group hover:scale-105 transition-all duration-300 shadow-md hover:shadow-lg",children:[a.jsx(Oe,{className:"h-4 w-4 mr-2 group-hover:animate-pulse text-primary"}),a.jsx("span",{className:"hidden sm:inline font-medium bg-gradient-to-r from-primary to-purple-600 bg-clip-text text-transparent",children:"Busca IA"}),a.jsx("span",{className:"sm:hidden font-medium text-primary",children:"IA"})]}),a.jsx("div",{className:"w-px h-6 bg-gradient-to-b from-transparent via-border/40 to-transparent"}),a.jsxs(ht,{variant:"gradient",size:"sm",onClick:()=>window.open("https://msribeiro2010.github.io/PROJETO-CENTRAL-NUCLEO/","_blank"),className:"relative overflow-hidden shadow-xl hover:shadow-2xl hover:scale-105 transition-all duration-300 group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 via-purple-500/20 to-blue-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx(te,{className:"h-4 w-4 mr-2 relative z-10"}),a.jsx("span",{className:"hidden md:inline font-semibold relative z-10",children:"Central do Núcleo"}),a.jsx("span",{className:"md:hidden font-semibold relative z-10",children:"Central"})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 bg-gradient-to-r from-card/60 via-card/80 to-card/60 backdrop-blur-xl rounded-3xl p-2 border border-border/30 shadow-xl hover:shadow-2xl transition-all duration-300",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Xt,{}),a.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full opacity-60 animate-pulse"})]}),a.jsx("div",{className:"w-px h-6 bg-gradient-to-b from-transparent via-border/40 to-transparent"}),a.jsx(Ht,{})]})]})})]})}),a.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-card/40 via-card/60 to-card/40 backdrop-blur-sm border-t border-border/20",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-3",children:a.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-card/80 to-card/60 backdrop-blur-md px-4 py-2.5 rounded-2xl border border-border/30 shadow-md",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2.5 h-2.5 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full animate-pulse shadow-sm"}),a.jsx(Yt,{})]}),a.jsx("div",{className:"w-px h-4 bg-border/40"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Re,{className:"h-4 w-4 text-primary"}),a.jsx(Qt,{})]})]})}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("div",{className:"bg-gradient-to-r from-accent/30 to-accent/20 backdrop-blur-md border border-accent/40 rounded-2xl p-3 shadow-lg",children:a.jsx(co,{})})})]})})]})]}),uo=({actions:e})=>a.jsx(pt,{variant:"glass",className:"mb-8",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"p-2 bg-gradient-primary rounded-xl shadow-soft",children:a.jsx(D,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Ações Rápidas"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Acesso direto às principais funcionalidades"})]}),a.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-border to-transparent"})]}),a.jsx(bt,{cols:6,gap:"md",children:e.map(e=>e.customComponent?a.jsx(vt,{children:e.customComponent},e.title):a.jsx(vt,{children:a.jsxs("div",{className:"relative group h-full",children:[a.jsx(pt,{variant:"glass",hover:!0,glow:!0,className:"h-full",children:a.jsx(jt,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col items-center text-center space-y-3 h-full",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-3 bg-gradient-primary rounded-2xl shadow-soft group-hover:shadow-glow transition-all duration-300 group-hover:scale-110 group-hover:rotate-3",children:a.jsx(e.icon,{className:"h-6 w-6 text-white"})}),a.jsx("div",{className:"absolute -inset-1 bg-gradient-primary rounded-2xl opacity-0 group-hover:opacity-20 blur-sm transition-all duration-300"})]}),a.jsxs("div",{className:"space-y-2 flex-1 flex flex-col justify-center",children:[a.jsx("h3",{className:"font-semibold text-sm text-foreground group-hover:text-primary transition-colors",children:e.title}),a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 leading-relaxed",children:e.description})]}),a.jsx("div",{className:"w-full h-1 bg-gradient-primary rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 transform scale-x-0 group-hover:scale-x-100"})]})})}),a.jsx("button",{className:"absolute inset-0 w-full h-full bg-transparent cursor-pointer z-10 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-xl",onClick:a=>{a.preventDefault(),a.stopPropagation(),e.onClick&&e.onClick()},"aria-label":`${e.title} - ${e.description}`})]})},e.title))})]})}),xo=({chamados:e,isLoading:s=!1,onDuplicar:r,onEditar:t,onExcluir:o})=>{const i=F();return a.jsxs(pt,{variant:"glass",className:"overflow-hidden",children:[a.jsx(ft,{title:"Chamados Recentes",description:"Últimos chamados criados no sistema",icon:a.jsx(Ue,{className:"h-5 w-5 text-white"}),action:a.jsx(ht,{variant:"outline",size:"sm",onClick:()=>i("/chamados-recentes"),icon:a.jsx(Je,{className:"h-4 w-4"}),iconPosition:"right",children:"Ver Todos"})}),a.jsx(jt,{children:s?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-primary rounded-2xl flex items-center justify-center animate-pulse",children:a.jsx(qe,{className:"h-8 w-8 text-white"})}),a.jsx("div",{className:"absolute -inset-2 bg-gradient-primary rounded-2xl opacity-20 animate-ping"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-semibold text-foreground",children:"Carregando chamados..."}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Aguarde um momento"})]})]})}):0===e.length?a.jsxs("div",{className:"text-center py-16",children:[a.jsxs("div",{className:"relative mx-auto w-24 h-24 bg-gradient-primary rounded-3xl flex items-center justify-center mb-6 shadow-xl",children:[a.jsx(qe,{className:"h-12 w-12 text-white"}),a.jsx("div",{className:"absolute -inset-2 bg-gradient-primary rounded-3xl opacity-20 animate-pulse"})]}),a.jsx("h3",{className:"text-2xl font-bold text-foreground mb-3",children:"Nenhum chamado encontrado"}),a.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto leading-relaxed",children:"Comece criando seu primeiro chamado para organizar suas tarefas e acompanhar o progresso dos seus projetos"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-8",children:[a.jsx(ht,{variant:"gradient",onClick:()=>i("/criar-chamado"),icon:a.jsx(S,{className:"h-4 w-4"}),className:"px-8 py-3",children:"Criar Primeiro Chamado"}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-card/50 px-4 py-2 rounded-xl border border-border/20",children:[a.jsx(ze,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{children:"Sistema pronto para uso"})]})]}),a.jsxs(bt,{cols:3,gap:"md",className:"max-w-2xl mx-auto",children:[a.jsx(vt,{children:a.jsx(pt,{variant:"glass",className:"text-center p-4",children:a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-blue rounded-xl",children:a.jsx(qe,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-foreground",children:"Organize"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Mantenha suas tarefas organizadas"})]})]})})}),a.jsx(vt,{children:a.jsx(pt,{variant:"glass",className:"text-center p-4",children:a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-purple rounded-xl",children:a.jsx(h,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-foreground",children:"Acompanhe"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitore o progresso dos chamados"})]})]})})}),a.jsx(vt,{children:a.jsx(pt,{variant:"glass",className:"text-center p-4",children:a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-green rounded-xl",children:a.jsx(D,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-foreground",children:"Colabore"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Trabalhe em equipe"})]})]})})})]})]}):a.jsx(bt,{cols:3,gap:"md",children:e.map(e=>a.jsx(vt,{children:a.jsx(pt,{variant:"glass",hover:!0,glow:!0,className:"group cursor-pointer h-full",onClick:()=>t(e),children:a.jsx(jt,{className:"p-4",children:a.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx("div",{className:"p-2 bg-gradient-primary rounded-xl shadow-soft group-hover:shadow-glow transition-all duration-300",children:a.jsx(qe,{className:"h-4 w-4 text-white"})}),a.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all duration-300",children:[a.jsx(cr,{size:"sm",variant:"ghost",onClick:a=>{a.stopPropagation(),r(e)},className:"h-8 w-8 p-0 text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20",title:"Duplicar",children:a.jsx(Ve,{className:"h-4 w-4"})}),a.jsx(cr,{size:"sm",variant:"ghost",onClick:a=>{a.stopPropagation(),t(e)},className:"h-8 w-8 p-0 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20",title:"Editar",children:a.jsx(Me,{className:"h-4 w-4"})}),a.jsxs(ur,{children:[a.jsx(xr,{asChild:!0,children:a.jsx(cr,{size:"sm",variant:"ghost",onClick:e=>e.stopPropagation(),className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Excluir",children:a.jsx(Le,{className:"h-4 w-4"})})}),a.jsxs(hr,{className:"bg-card/95 backdrop-blur-xl border-border/20",onClick:e=>e.stopPropagation(),children:[a.jsxs(gr,{children:[a.jsx(pr,{className:"text-foreground",children:"Confirmar exclusão"}),a.jsx(fr,{className:"text-muted-foreground",children:"Tem certeza que deseja excluir este chamado? Esta ação não pode ser desfeita."})]}),a.jsxs(jr,{children:[a.jsx(br,{onClick:e=>e.stopPropagation(),children:"Cancelar"}),a.jsx(vr,{onClick:a=>{a.stopPropagation(),o(e.id)},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})]})]})]}),a.jsxs("div",{className:"space-y-3 flex-1",children:[a.jsx("h3",{className:"font-semibold text-sm line-clamp-2 text-foreground group-hover:text-primary transition-colors leading-snug",children:e.assunto||"Chamado sem título"}),a.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(h,{className:"h-4 w-4"}),a.jsxs("span",{children:[new Date(e.created_at).toLocaleDateString("pt-BR")," às "," ",new Date(e.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),e.categoria&&a.jsxs("div",{className:"bg-primary/10 px-3 py-1 rounded-lg text-xs",children:[a.jsx("span",{className:"font-medium",children:"Categoria:"})," ",e.categoria]}),e.usuario_criador_nome&&a.jsxs("div",{className:"bg-purple-500/10 px-3 py-1 rounded-lg text-xs",children:[a.jsx("span",{className:"font-medium",children:"Criado por:"})," ",e.usuario_criador_nome]})]})]}),a.jsx("div",{className:"h-1 bg-gradient-primary rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 transform scale-x-0 group-hover:scale-x-100"})]})})})},e.id))})})]})},ho=()=>a.jsx(pt,{variant:"glass",className:"mt-12",children:a.jsx(jt,{className:"p-8",children:a.jsxs("div",{className:"text-center space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-primary rounded-xl",children:a.jsx(g,{className:"h-5 w-5 text-white"})}),a.jsx("span",{className:"font-semibold text-foreground",children:"© 2025 TRT15 - Núcleo de Apoio ao PJe"})]}),a.jsx("div",{className:"hidden sm:block w-2 h-2 bg-primary rounded-full animate-pulse"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-4 w-4 text-primary"}),a.jsx("span",{children:"Ferramenta inteligente de apoio ao PJe"})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("div",{className:"h-px w-24 bg-gradient-to-r from-transparent to-primary/30"}),a.jsx("div",{className:"p-3 bg-gradient-primary rounded-2xl shadow-soft",children:a.jsx($e,{className:"h-4 w-4 text-white animate-pulse"})}),a.jsx("div",{className:"h-px w-24 bg-gradient-to-l from-transparent to-primary/30"})]}),a.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Re,{className:"h-4 w-4 text-green-500"}),a.jsx("span",{children:"Versão 2.0"})]}),a.jsx("div",{className:"w-1 h-1 bg-muted-foreground rounded-full"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Sistema Operacional"})]}),a.jsx("div",{className:"w-1 h-1 bg-muted-foreground rounded-full"}),a.jsx("span",{children:"Mar-IA"})]})]})})}),go=()=>{const{user:e}=tt();return f({queryKey:["profile",e?.id],queryFn:async()=>{if(!e?.id)return null;try{const{data:a,error:s}=await dr.from("profiles").select("*").eq("id",e.id).single();if(s)throw new Error(`Failed to fetch profile: ${s.message}`);return a}catch(a){throw a}},enabled:!!e?.id,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)})},po=()=>{const[a,s]=e.useState(!1),[r,t]=e.useState(null),[o,i]=e.useState({nome:"",data_nascimento:""}),n=(()=>{const e=Be();return Ge({mutationFn:async e=>{const{data:a,error:s}=await dr.from("aniversariantes").insert(e).select().single();if(s)throw s;return a},onSuccess:()=>{e.invalidateQueries({queryKey:["aniversariantes"]}),e.invalidateQueries({queryKey:["aniversariantes-mes"]}),qr({title:"Sucesso",description:"Aniversariante adicionado com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao adicionar aniversariante: "+e.message,variant:"destructive"})}})})(),l=(()=>{const e=Be();return Ge({mutationFn:async({id:e,...a})=>{const{data:s,error:r}=await dr.from("aniversariantes").update(a).eq("id",e).select().single();if(r)throw r;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["aniversariantes"]}),e.invalidateQueries({queryKey:["aniversariantes-mes"]}),qr({title:"Sucesso",description:"Aniversariante atualizado com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao atualizar aniversariante: "+e.message,variant:"destructive"})}})})(),d=(()=>{const e=Be();return Ge({mutationFn:async e=>{const{error:a}=await dr.from("aniversariantes").delete().eq("id",e);if(a)throw a},onSuccess:()=>{e.invalidateQueries({queryKey:["aniversariantes"]}),e.invalidateQueries({queryKey:["aniversariantes-mes"]}),qr({title:"Sucesso",description:"Aniversariante removido com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao remover aniversariante: "+e.message,variant:"destructive"})}})})(),c=()=>{i({nome:"",data_nascimento:""}),t(null)};return{isDialogOpen:a,setIsDialogOpen:s,editingId:r,formData:o,setFormData:i,handleSubmit:e=>{e.preventDefault(),r?l.mutate({id:r,nome:o.nome,data_nascimento:o.data_nascimento}):n.mutate({nome:o.nome,data_nascimento:o.data_nascimento}),s(!1),c()},resetForm:c,handleEdit:e=>{i({nome:e.nome,data_nascimento:e.data_nascimento}),t(e.id),s(!0)},handleDelete:e=>{confirm("Tem certeza que deseja excluir este aniversariante?")&&d.mutate(e)}}},fo=({isOpen:e,onOpenChange:s,editingId:r,formData:t,onFormDataChange:o,onSubmit:i,onResetForm:n,isAdmin:l})=>l?a.jsxs(wr,{open:e,onOpenChange:s,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"border-pink-300 text-pink-700 hover:bg-pink-100 mt-2",onClick:n,children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Adicionar"]})}),a.jsxs(yr,{children:[a.jsx(Cr,{children:a.jsx(kr,{children:r?"Editar Aniversariante":"Adicionar Aniversariante"})}),a.jsxs("form",{onSubmit:i,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"nome",children:"Nome"}),a.jsx(Sr,{id:"nome",value:t.nome,onChange:e=>o({...t,nome:e.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"data_nascimento",children:"Data de Nascimento"}),a.jsx(Sr,{id:"data_nascimento",type:"date",value:t.data_nascimento,onChange:e=>o({...t,data_nascimento:e.target.value}),required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancelar"}),a.jsx(cr,{type:"submit",children:r?"Atualizar":"Adicionar"})]})]})]})]}):null,jo=({aniversariante:e,isAdmin:s,onEdit:r,onDelete:t})=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg shadow-sm border border-pink-100",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center",children:a.jsx(le,{className:"h-5 w-5 text-pink-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.nome}),a.jsx("p",{className:"text-sm text-muted-foreground",children:ks(new Date(e.data_nascimento+"T12:00:00"),"dd/MM",{locale:Es})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mr,{variant:"secondary",className:"bg-pink-100 text-pink-700",children:"🎂"}),s&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(e),className:"h-8 w-8 p-0",children:a.jsx(He,{className:"h-4 w-4"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>t(e.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:a.jsx(P,{className:"h-4 w-4"})})]})]})]}),bo=({currentDate:e,onPrevMonth:s,onNextMonth:r})=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(cr,{variant:"outline",size:"sm",onClick:s,className:"h-8 w-8 p-0 border-pink-300",children:a.jsx(xe,{className:"h-4 w-4"})}),a.jsx("span",{className:"text-sm font-medium text-pink-700 min-w-[100px] text-center",children:ks(e,"MMM yyyy",{locale:Es})}),a.jsx(cr,{variant:"outline",size:"sm",onClick:r,className:"h-8 w-8 p-0 border-pink-300",children:a.jsx(q,{className:"h-4 w-4"})})]}),vo=()=>{const[s,r]=e.useState(new Date),{data:t}=go(),{isDialogOpen:o,setIsDialogOpen:i,editingId:n,formData:l,setFormData:d,handleSubmit:c,resetForm:m,handleEdit:u,handleDelete:x}=po(),h=s.getMonth()+1,{data:g,isLoading:p}=f({queryKey:["aniversariantes"],queryFn:async()=>{const{data:e,error:a}=await dr.from("aniversariantes").select("*").order("data_nascimento",{ascending:!0});if(a)throw a;return e}}),j=g?.filter(e=>new Date(e.data_nascimento+"T12:00:00").getMonth()+1===h),b=t?.is_admin&&"aprovado"===t?.status;return p?null:j&&0!==j.length?a.jsxs(nt,{className:"bg-gradient-to-br from-pink-50 to-purple-50 border-pink-200",children:[a.jsxs(lt,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(dt,{className:"flex items-center gap-2 text-pink-700",children:[a.jsx(Xe,{className:"h-5 w-5"}),"Aniversariantes"]}),a.jsx(bo,{currentDate:s,onPrevMonth:()=>r(Ts(s)),onNextMonth:()=>r(Ss(s,1))})]}),a.jsx(fo,{isOpen:o,onOpenChange:i,editingId:n,formData:l,onFormDataChange:d,onSubmit:c,onResetForm:m,isAdmin:b})]}),a.jsx(mt,{children:a.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:j.map(e=>a.jsx(jo,{aniversariante:e,isAdmin:b,onEdit:u,onDelete:x},e.id))})})]}):null},No=()=>f({queryKey:["feriados"],queryFn:async()=>{const{data:e,error:a}=await dr.from("feriados").select("*").order("data",{ascending:!0});if(a)throw a;return e}}),wo=()=>{const e=Be();return Ge({mutationFn:async e=>{const{data:a,error:s}=await dr.from("feriados").insert(e).select().single();if(s)throw s;return a},onSuccess:()=>{e.invalidateQueries({queryKey:["feriados"]}),qr({title:"Sucesso",description:"Feriado adicionado com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao adicionar feriado: "+e.message,variant:"destructive"})}})},yo=()=>{const e=Be();return Ge({mutationFn:async e=>{const{error:a}=await dr.from("feriados").delete().eq("id",e);if(a)throw a},onSuccess:()=>{e.invalidateQueries({queryKey:["feriados"]}),qr({title:"Sucesso",description:"Feriado removido com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao remover feriado: "+e.message,variant:"destructive"})}})},Co=e=>{switch(e){case"nacional":return"bg-green-100 text-green-700 border-green-200";case"estadual":return"bg-blue-100 text-blue-700 border-blue-200";case"municipal":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},ko=()=>{const[s,r]=e.useState(new Date),{data:t,isLoading:o}=No(),{data:i}=go(),n=wo(),l=(()=>{const e=Be();return Ge({mutationFn:async({id:e,...a})=>{const{data:s,error:r}=await dr.from("feriados").update(a).eq("id",e).select().single();if(r)throw r;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["feriados"]}),qr({title:"Sucesso",description:"Feriado atualizado com sucesso!"})},onError:e=>{qr({title:"Erro",description:"Erro ao atualizar feriado: "+e.message,variant:"destructive"})}})})(),d=yo(),c=s.getMonth()+1,m=s.getFullYear(),u=t?.filter(e=>{if(!e.data)return!1;const a=new Date(e.data+"T12:00:00");return!isNaN(a.getTime())&&(a.getMonth()+1===c&&a.getFullYear()===m)}),[x,h]=e.useState(!1),[g,p]=e.useState(null),[f,j]=e.useState({data:"",descricao:"",tipo:""}),b=i?.is_admin&&"aprovado"===i?.status,v=()=>{j({data:"",descricao:"",tipo:""}),p(null)};if(o)return null;const N=u&&u.length>0,w=u?.length||0;return a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(wt,{children:[a.jsx(yt,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"flex items-center gap-2 border-green-300 text-green-700 hover:bg-green-50",children:[a.jsx(Qe,{className:"h-4 w-4"}),a.jsxs("span",{className:"text-xs",children:[w," feriado",1!==w?"s":""," em ",ks(s,"MMM",{locale:Es})]})]})}),a.jsxs(Ct,{className:"w-80 p-0",align:"start",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h4",{className:"font-semibold text-green-700 flex items-center gap-2",children:[a.jsx(Qe,{className:"h-4 w-4"}),"Feriados"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(Ts(s)),className:"h-6 w-6 p-0",children:a.jsx(xe,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium min-w-[80px] text-center",children:ks(s,"MMM/yy",{locale:Es})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(Ss(s,1)),className:"h-6 w-6 p-0",children:a.jsx(q,{className:"h-3 w-3"})})]})]}),b&&a.jsxs(wr,{open:x,onOpenChange:h,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",onClick:v,children:[a.jsx(S,{className:"h-3 w-3 mr-1"}),"Adicionar"]})}),a.jsxs(yr,{children:[a.jsx(Cr,{children:a.jsx(kr,{children:g?"Editar Feriado":"Adicionar Feriado"})}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),g?l.mutate({id:g,data:f.data,descricao:f.descricao,tipo:f.tipo}):n.mutate({data:f.data,descricao:f.descricao,tipo:f.tipo}),h(!1),v()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"data",children:"Data"}),a.jsx(Sr,{id:"data",type:"date",value:f.data,onChange:e=>j({...f,data:e.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"descricao",children:"Descrição"}),a.jsx(Sr,{id:"descricao",value:f.descricao,onChange:e=>j({...f,descricao:e.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"tipo",children:"Tipo"}),a.jsxs(ao,{value:f.tipo,onValueChange:e=>j({...f,tipo:e}),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione o tipo"})}),a.jsxs(io,{children:[a.jsx(no,{value:"nacional",children:"Nacional"}),a.jsx(no,{value:"estadual",children:"Estadual"}),a.jsx(no,{value:"municipal",children:"Municipal"})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),a.jsx(cr,{type:"submit",children:g?"Atualizar":"Adicionar"})]})]})]})]})]}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:N?a.jsx("div",{className:"space-y-1 p-2",children:u.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[a.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Ke,{className:"h-3 w-3 text-green-600"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.descricao}),a.jsx("p",{className:"text-xs text-muted-foreground",children:ks(new Date(e.data+"T12:00:00"),"dd/MM",{locale:Es})})]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a.jsx(mr,{className:`text-xs px-1.5 py-0.5 ${Co(e.tipo)}`,children:e.tipo.charAt(0).toUpperCase()}),b&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(e=>{j({data:e.data,descricao:e.descricao,tipo:e.tipo}),p(e.id),h(!0)})(e),className:"h-6 w-6 p-0",children:a.jsx(He,{className:"h-3 w-3"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>{return a=e.id,void(confirm("Tem certeza que deseja excluir este feriado?")&&d.mutate(a));var a},className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:a.jsx(P,{className:"h-3 w-3"})})]})]})]},e.id))}):a.jsx("div",{className:"p-4 text-center",children:a.jsxs("p",{className:"text-gray-500 text-sm",children:["Nenhum feriado em ",ks(s,"MMMM",{locale:Es})]})})})]})]})})},Eo=ea,So=e.forwardRef(({className:e,...s},r)=>a.jsx(Ye,{ref:r,className:lr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));So.displayName=Ye.displayName;const To=e.forwardRef(({className:e,...s},r)=>a.jsx(We,{ref:r,className:lr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));To.displayName=We.displayName;const Ao=e.forwardRef(({className:e,...s},r)=>a.jsx(Ze,{ref:r,className:lr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));Ao.displayName=Ze.displayName;const _o={showModalForUrgent:!0,showToastsForAll:!0,snoozeTime:30,lastShownToast:null,dismissedEvents:[],eventStatuses:[],autoHideAfterHours:4,showPastEvents:!1},Po=()=>{const{events:a,loading:s,hasUpcomingEvents:r}=(()=>{const[a,s]=e.useState({feriados:[],aniversariantes:[]}),[r,t]=e.useState(!0);return e.useEffect(()=>{const e=async()=>{try{t(!0);const e=As(new Date),a=(_s(e),Ps(e)),r=Ps(Ds(a,30)),{data:o,error:i}=await dr.from("feriados").select("*").gte("data",ks(e,"yyyy-MM-dd")).lte("data",ks(r,"yyyy-MM-dd")),{data:n,error:l}=await dr.from("aniversariantes").select("*"),d=n?.map(a=>{if(!a.data_nascimento)return null;const s=zs(a.data_nascimento);if(isNaN(s.getTime()))return null;const r=e.getFullYear(),t=new Date(r,s.getMonth(),s.getDate()),o=Is(As(t),e),i=r-s.getFullYear();return{...a,daysUntil:o,idade:i}}).filter(e=>!!e&&e.daysUntil>=-7&&e.daysUntil<=30)||[],c=o?.map(a=>{if(!a.data)return null;const s=zs(a.data);if(isNaN(s.getTime()))return null;const r=Is(As(s),e);return{...a,daysUntil:r}}).filter(e=>!!e&&e.daysUntil>=-7&&e.daysUntil<=30)||[];s({feriados:c,aniversariantes:d})}catch(e){}finally{t(!1)}};e();const a=setInterval(e,18e5);return()=>clearInterval(a)},[]),{events:a,loading:r,hasUpcomingEvents:a.feriados.length>0||a.aniversariantes.length>0}})(),{toast:t}=Vr(),[o,i]=e.useState(()=>{try{const e=localStorage.getItem("event-notification-settings");return e?{..._o,...JSON.parse(e)}:_o}catch{return _o}}),[n,l]=e.useState(!1),[d,c]=e.useState(!1);e.useEffect(()=>{},[s,r,o.showToastsForAll,d,a]),e.useEffect(()=>{localStorage.setItem("event-notification-settings",JSON.stringify(o))},[o]);const m=[...a.feriados.map(e=>({type:"feriado",title:e.descricao,subtitle:e.tipo,daysUntil:e.daysUntil,id:`feriado-${e.id}`,data:e,date:e.data})),...a.aniversariantes.map(e=>({type:"aniversario",title:e.nome,subtitle:`${e.idade} anos`,daysUntil:e.daysUntil,id:`aniversario-${e.id}`,data:e,date:e.data_nascimento}))].sort((e,a)=>e.daysUntil-a.daysUntil),u=e=>o.eventStatuses.find(a=>a.eventId===e)||null,x=(e,a)=>{i(s=>{const r=s.eventStatuses.filter(a=>a.eventId!==e),t={eventId:e,status:a,..."finished"===a&&{finishedAt:(new Date).toISOString()},..."hidden"===a&&{hiddenAt:(new Date).toISOString()}};return{...s,eventStatuses:[...r,t]}})};e.useEffect(()=>{const e=new Date,a=o.eventStatuses.map(a=>{if("finished"===a.status&&a.finishedAt){const s=new Date(a.finishedAt),r=Ms(s,o.autoHideAfterHours);if(Fs(e,r))return{...a,status:"hidden",hiddenAt:e.toISOString()}}return a});JSON.stringify(a)!==JSON.stringify(o.eventStatuses)&&i(e=>({...e,eventStatuses:a}))},[o.eventStatuses,o.autoHideAfterHours]);const h=m.filter(e=>{const a=u(e.id);return!a||"active"===a.status||(!("finished"!==a.status||!o.showPastEvents)||"hidden"===a.status&&o.showPastEvents)}),g=h.filter(e=>{const a=u(e.id),s=!o.dismissedEvents.includes(e.id),r=!a||"finished"!==a.status;return e.daysUntil<=1&&s&&r});e.useEffect(()=>{As(new Date),m.forEach(e=>{if(e.daysUntil<0){const a=u(e.id);a&&"active"!==a.status||x(e.id,"finished")}})},[m]),e.useEffect(()=>{if(!s&&g.length>0&&o.showModalForUrgent){const e=new Date,a=o.lastShownToast?new Date(o.lastShownToast):null;(!a||e.getTime()-a.getTime()>60*o.snoozeTime*1e3)&&l(!0)}},[g,s,o]);return{allEvents:h,urgentEvents:g,loading:s,hasUpcomingEvents:r,modalOpen:n,setModalOpen:l,settings:o,updateSettings:e=>{i(a=>({...a,...e}))},dismissEvent:e=>{i(a=>({...a,dismissedEvents:[...a.dismissedEvents,e]}))},snoozeNotifications:e=>{i(a=>({...a,snoozeTime:e,lastShownToast:(new Date).toISOString()})),l(!1)},clearDismissedEvents:()=>{i(e=>({...e,dismissedEvents:[]}))},markEventAsFinished:e=>{x(e,"finished"),t({title:"✅ Evento Finalizado",description:"O evento foi marcado como finalizado e será ocultado em algumas horas.",duration:3e3})},restoreEvent:e=>{x(e,"active"),t({title:"🔄 Evento Restaurado",description:"O evento foi restaurado e voltará a aparecer nas notificações.",duration:3e3})},updateEventStatus:x,pastEvents:o.eventStatuses.filter(e=>"finished"===e.status||"hidden"===e.status).map(e=>{const a=m.find(a=>a.id===e.eventId);return a?{...a,status:e}:null}).filter(Boolean).sort((e,a)=>{const s=e.status.finishedAt||e.status.hiddenAt||"",r=a.status.finishedAt||a.status.hiddenAt||"";return new Date(r).getTime()-new Date(s).getTime()}),stats:(()=>{const e=h.length,a=g.length,s=h.filter(e=>0===e.daysUntil).length,r=h.filter(e=>1===e.daysUntil).length,t=h.filter(e=>e.daysUntil<=7).length,i=o.eventStatuses.filter(e=>"finished"===e.status).length,n=o.eventStatuses.filter(e=>"hidden"===e.status).length;return{total:e,urgent:a,today:s,tomorrow:r,thisWeek:t,dismissed:o.dismissedEvents.length,finished:i,hidden:n,past:i+n}})()}},Do=new Map,zo=a=>{const{user:s}=tt(),[r,t]=e.useState([]),[o,i]=e.useState(!1),[n,l]=e.useState(null),d=e.useCallback(async()=>{if(!s)return;const e=`${s.id}-${a.getFullYear()}-${a.getMonth()}`,r=Do.get(e),o=Date.now();if(r&&o-r.timestamp<3e5)t(r.data);else{i(!0),l(null);try{const r=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),a.getMonth()+1,0),{data:n,error:l}=await dr.from("user_custom_events").select("*").eq("user_id",s.id).gte("date",r.toISOString().slice(0,10)).lte("date",i.toISOString().slice(0,10)).order("date",{ascending:!0});if(l)throw l;const d=n||[];t(d),Do.set(e,{data:d,timestamp:o})}catch(n){const e=n instanceof Error?n.message:"Erro ao buscar eventos personalizados";l(e)}finally{i(!1)}}},[s,a.getFullYear(),a.getMonth()]),c=e.useCallback(async e=>{if(!s?.id)throw Cs.error("Usuário não autenticado"),new Error("Usuário não autenticado");if(o)return;if(!e.date||!e.title||!e.type)throw Cs.error("Dados obrigatórios faltando (data, título ou tipo)"),new Error("Dados obrigatórios não preenchidos");if(!/^\d{4}-\d{2}-\d{2}$/.test(e.date))throw Cs.error("Formato de data inválido. Use YYYY-MM-DD"),new Error("Formato de data inválido");if(!["curso","webinario","reuniao","outro"].includes(e.type))throw Cs.error("Tipo de evento inválido"),new Error("Tipo de evento inválido");if(e.title.length>128)throw Cs.error("Título muito longo (máximo 128 caracteres)"),new Error("Título muito longo");if(e.description&&e.description.length>1e3)throw Cs.error("Descrição muito longa (máximo 1000 caracteres)"),new Error("Descrição muito longa");i(!0),l(null);try{const r={user_id:s.id,date:e.date,type:e.type,title:e.title};e.description&&(r.description=e.description),e.start_time&&(r.start_time=e.start_time),e.end_time&&(r.end_time=e.end_time),e.url&&(r.url=e.url);const{data:o,error:i}=await dr.from("user_custom_events").insert(r).select().single();if(i){if("PGRST301"===i.code)throw new Error("Erro de permissões. Verifique as políticas RLS da tabela.");if("23503"===i.code)throw new Error("Erro de referência. Verifique se o user_id existe na tabela profiles.");if(i.message.includes("violates not-null constraint"))throw new Error("Campo obrigatório não preenchido. Verifique os dados do evento.");throw i}t(e=>[...e,o].sort((e,a)=>new Date(e.date).getTime()-new Date(a.date).getTime()));const n=`${s.id}-${a.getFullYear()}-${a.getMonth()}`;Do.delete(n);const l={webinario:"Webinário",reuniao:"Reunião",curso:"Curso",outro:"Evento"}[e.type]||"Evento";Cs.success(`${l} adicionado!`,{description:`"${e.title}" - ${ks(new Date(e.date),"dd/MM/yyyy")}`})}catch(r){const e=r instanceof Error?r.message:"Erro ao adicionar evento";throw l(e),Cs.error("Erro ao salvar evento",{description:e}),r}finally{i(!1)}},[s,d]),m=e.useCallback(async(e,r)=>{if(!s?.id)throw Cs.error("Usuário não autenticado"),new Error("Usuário não autenticado");if(!o){i(!0),l(null);try{const{data:o,error:i}=await dr.from("user_custom_events").update(r).eq("id",e).eq("user_id",s.id).select().single();if(i)throw i;t(a=>a.map(a=>a.id===e?o:a));const n=`${s.id}-${a.getFullYear()}-${a.getMonth()}`;Do.delete(n),Cs.success("Evento atualizado!",{description:`"${r.title}" foi modificado com sucesso`})}catch(n){const e=n instanceof Error?n.message:"Erro ao atualizar evento";throw l(e),Cs.error("Erro ao atualizar evento",{description:e}),n}finally{i(!1)}}},[s]),u=e.useCallback(async e=>{if(o)return;const n=r.find(a=>a.id===e);t(a=>a.filter(a=>a.id!==e)),i(!0),l(null);try{const{error:r}=await dr.from("user_custom_events").delete().eq("id",e);if(r)throw r;const t=`${s.id}-${a.getFullYear()}-${a.getMonth()}`;Do.delete(t),Cs.success("Evento removido!",{description:n?`"${n.title}" foi excluído`:"Evento excluído com sucesso"})}catch(d){const e=d instanceof Error?d.message:"Erro ao remover evento";throw l(e),n&&t(e=>[...e,n].sort((e,a)=>new Date(e.date).getTime()-new Date(a.date).getTime())),Cs.error("Erro ao remover evento",{description:e}),d}finally{i(!1)}},[o,r,s]),x=a.getFullYear(),h=a.getMonth();return e.useEffect(()=>{s&&d()},[s,x,h,d]),{customEvents:r,fetchCustomEvents:d,addCustomEvent:c,updateCustomEvent:m,removeCustomEvent:u,loading:o,error:n}},Io=[{value:"curso",label:"Curso",icon:a.jsx(aa,{className:"h-4 w-4 mr-1 text-blue-600"})},{value:"webinario",label:"Webinário",icon:a.jsx(sa,{className:"h-4 w-4 mr-1 text-purple-600"})},{value:"reuniao",label:"Reunião",icon:a.jsx(ra,{className:"h-4 w-4 mr-1 text-green-600"})},{value:"outro",label:"Outro",icon:a.jsx(D,{className:"h-4 w-4 mr-1 text-amber-600"})}];function Mo({isOpen:s,onOpenChange:r,event:t,onUpdate:o}){const[i,n]=e.useState(""),[l,d]=e.useState("curso"),[c,m]=e.useState(""),[u,x]=e.useState(""),[h,g]=e.useState(""),[p,f]=e.useState(""),[j,b]=e.useState(""),[v,N]=e.useState(!1);e.useEffect(()=>{t&&(n(t.date),d(t.type),m(t.title),x(t.description||""),g(t.start_time||""),f(t.end_time||""),b(t.url||""))},[t]);const w=()=>{r(!1),n(""),d("curso"),m(""),x(""),g(""),f(""),b("")};return a.jsx(wr,{open:s,onOpenChange:w,children:a.jsxs(yr,{className:"max-w-md w-full",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(Me,{className:"h-5 w-5 text-primary"}),"Editar Evento Personalizado"]})}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),t){N(!0);try{await o(t.id,{date:i,type:l,title:c,description:u||void 0,start_time:h||void 0,end_time:p||void 0,url:j||void 0}),r(!1)}catch(a){zr(async()=>{const{toast:e}=await import("./vendor-CNX07ziR.js").then(e=>e.aR);return{toast:e}},__vite__mapDeps([0,1])).then(({toast:e})=>{e.error("Não foi possível salvar as alterações. Tente novamente.")})}finally{N(!1)}}},className:"space-y-4 mt-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Data"}),a.jsx(Sr,{type:"date",value:i,onChange:e=>n(e.target.value),required:!0,min:ks(new Date,"yyyy-MM-dd")})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Horário de Início (opcional)"}),a.jsx(Sr,{type:"time",value:h,onChange:e=>g(e.target.value),placeholder:"HH:MM"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Horário de Fim (opcional)"}),a.jsx(Sr,{type:"time",value:p,onChange:e=>f(e.target.value),placeholder:"HH:MM"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tipo"}),a.jsx("div",{className:"flex gap-2",children:Io.map(e=>a.jsxs(cr,{type:"button",variant:l===e.value?"default":"outline",className:"flex items-center gap-1 px-3 py-1 text-xs "+(l===e.value?"":"bg-white"),onClick:()=>d(e.value),children:[e.icon,e.label]},e.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Título"}),a.jsx(Sr,{value:c,onChange:e=>m(e.target.value),required:!0,maxLength:64,placeholder:"Ex: Curso de Atualização"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descrição (opcional)"}),a.jsx(Nt,{value:u,onChange:e=>x(e.target.value),maxLength:256,placeholder:"Detalhes, local, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Link/URL (opcional)"}),a.jsx(Sr,{value:j,onChange:e=>b(e.target.value),type:"url",placeholder:"https://exemplo.com"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:w,disabled:v,children:"Cancelar"}),a.jsx(cr,{type:"submit",disabled:v||!i||!c,className:"bg-primary text-white hover:bg-primary/90",children:v?"Salvando...":"Salvar Alterações"})]})]})]})})}const Fo={curso:a.jsx(aa,{className:"h-4 w-4 text-blue-600"}),webinario:a.jsx(sa,{className:"h-4 w-4 text-purple-600"}),reuniao:a.jsx(ra,{className:"h-4 w-4 text-green-600"}),outro:a.jsx(D,{className:"h-4 w-4 text-amber-600"})},Oo={curso:"bg-blue-100 text-blue-800 border-blue-200",webinario:"bg-purple-100 text-purple-800 border-purple-200",reuniao:"bg-green-100 text-green-800 border-green-200",outro:"bg-amber-100 text-amber-800 border-amber-200"},Ro=()=>{const{pastEvents:s,restoreEvent:r,updateEventStatus:t,stats:o,settings:i,updateSettings:n}=Po(),l=new Date,{customEvents:d,updateCustomEvent:c,removeCustomEvent:m}=zo(l),{createManualReminder:u,upcomingEventsCount:x}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState(()=>{const e=`notified_events_${(new Date).toDateString()}`,a=sessionStorage.getItem(e);return a?new Set(JSON.parse(a)):new Set}),o=new Date,{customEvents:i}=zo(o),n=e.useCallback(()=>{const e=new Date,r=[];i.forEach(s=>{const t=zs(s.date);Os(t,e),(Rs(t)||Js(t))&&(a.find(e=>e.eventId===s.id)||r.push({id:`reminder-${s.id}`,eventId:s.id,title:s.title,date:s.date,type:s.type,reminderTime:e,notified:!1}))}),r.length>0&&s(e=>[...e,...r])},[i,a]),l=e.useCallback(()=>{a.forEach(e=>{if(!e.notified&&!r.has(e.eventId)){const a=zs(e.date);Rs(a)?(Cs(`🎯 Evento Hoje: ${e.title}`,{description:`Seu evento "${e.title}" acontece hoje!`,duration:8e3,action:{label:"Ver Calendário",onClick:()=>window.location.href="/calendario"}}),t(a=>{const s=new Set([...a,e.eventId]),r=`notified_events_${(new Date).toDateString()}`;return sessionStorage.setItem(r,JSON.stringify([...s])),s})):Js(a)&&(Cs(`⏰ Evento Amanhã: ${e.title}`,{description:`Lembre-se: "${e.title}" acontece amanhã (${ks(a,"dd/MM/yyyy",{locale:Es})})`,duration:6e3,action:{label:"Ver Calendário",onClick:()=>window.location.href="/calendario"}}),t(a=>{const s=new Set([...a,e.eventId]),r=`notified_events_${(new Date).toDateString()}`;return sessionStorage.setItem(r,JSON.stringify([...s])),s})),s(a=>a.map(a=>a.id===e.id?{...a,notified:!0}:a))}})},[a,r]),d=e.useCallback((e,a)=>{const r=i.find(a=>a.id===e);if(!r)return;const t={id:`manual-${e}-${Date.now()}`,eventId:e,title:r.title,date:r.date,type:r.type,reminderTime:a,notified:!1};s(e=>[...e,t]);const o=a.getTime()-(new Date).getTime();o>0&&o<=864e5&&setTimeout(()=>{Cs(`🔔 Lembrete: ${r.title}`,{description:`Evento: ${ks(zs(r.date),"dd/MM/yyyy",{locale:Es})}`,duration:1e4,action:{label:"Ver Calendário",onClick:()=>window.location.href="/calendario"}})},o),Cs.success(`Lembrete criado para "${r.title}"`,{description:`Você será notificado em ${ks(a,"dd/MM/yyyy HH:mm",{locale:Es})}`,duration:5e3})},[i]),c=e.useCallback(e=>{s(a=>a.filter(a=>a.id!==e))},[]);return e.useEffect(()=>{n();const e=setInterval(n,3e5);return()=>clearInterval(e)},[n]),e.useEffect(()=>{const e=setTimeout(()=>{l()},2e3);return()=>clearTimeout(e)},[l]),{reminders:a,createManualReminder:d,removeReminder:c,upcomingEventsCount:a.filter(e=>!e.notified).length}})(),[g,p]=e.useState(!1),[f,j]=e.useState(null),[b,v]=e.useState(!1),N=d.filter(e=>{const a=zs(e.date);return Fs(a,As(new Date))}).sort((e,a)=>new Date(e.date).getTime()-new Date(a.date).getTime()),w=e=>"finished"===e?"Finalizado":"Oculto",y=e=>{try{const a=zs(e);return ks(a,"dd/MM/yyyy",{locale:Es})}catch{return"Data inválida"}},C=e=>{try{const a=new Date(e);return ks(a,"dd/MM/yyyy 'às' HH:mm",{locale:Es})}catch{return"Data inválida"}},k=(e,a)=>e||a?e&&a?`${e} - ${a}`:e?`${e}`:null:null,E=o.past+N.length;return a.jsxs(a.Fragment,{children:[a.jsxs(wr,{open:g,onOpenChange:p,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"bg-white/80 hover:bg-white transition-all duration-200",children:[a.jsx(le,{className:"h-4 w-4 mr-2"}),"Gerenciar Eventos",a.jsx(mr,{className:"ml-2 bg-blue-100 text-blue-800",children:E}),x>0&&a.jsxs(mr,{className:"ml-1 bg-red-100 text-red-800 animate-pulse",children:[x," 🔔"]})]})}),a.jsxs(yr,{className:"max-w-3xl max-h-[85vh] overflow-hidden",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:a.jsx(le,{className:"h-5 w-5 text-white"})}),"Gerenciar Eventos"]})}),a.jsxs(Eo,{defaultValue:"future",className:"w-full",children:[a.jsxs(So,{className:"grid w-full grid-cols-2",children:[a.jsxs(To,{value:"future",className:"flex items-center gap-2",children:[a.jsx(le,{className:"h-4 w-4"}),"Eventos Futuros",a.jsx(mr,{className:"ml-1 bg-blue-100 text-blue-800",children:N.length})]}),a.jsxs(To,{value:"past",className:"flex items-center gap-2",children:[a.jsx(ta,{className:"h-4 w-4"}),"Eventos Passados",a.jsx(mr,{className:"ml-1 bg-gray-100 text-gray-800",children:o.past})]})]}),a.jsx(Ao,{value:"future",className:"space-y-4 mt-4",children:0===N.length?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-4xl mb-4",children:"📅"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum evento futuro encontrado."}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:'Use o botão "Adicionar Evento" no calendário para criar novos eventos.'})]}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N.map(e=>a.jsx(nt,{className:"hover:bg-gray-50 transition-colors",children:a.jsx(mt,{className:"p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("div",{className:`p-2 rounded-full bg-white border-2 ${Oo[e.type].replace("bg-","border-").replace("-100","-200")}`,children:Fo[e.type]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"font-medium text-sm truncate",children:e.title}),a.jsx(mr,{variant:"secondary",className:`text-xs ${Oo[e.type]}`,children:e.type})]}),e.description&&a.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:e.description}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(le,{className:"h-3 w-3"}),a.jsx("span",{children:y(e.date)})]}),k(e.start_time,e.end_time)&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"h-3 w-3"}),a.jsx("span",{children:k(e.start_time,e.end_time)})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(e=>{const a=zs(e.date),s=new Date;if(Fs(a,s)){const r=Ms(a,-2),t=Fs(r,s)?r:s;u(e.id,t)}else Cs.error("Não é possível criar lembrete para eventos passados")})(e),className:"h-8 w-8 p-0",title:"Criar lembrete",children:a.jsx(oe,{className:"h-3 w-3"})}),e.url&&a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>{return a=e.url,void window.open(a,"_blank");var a},className:"h-8 w-8 p-0",title:"Abrir link",children:a.jsx(te,{className:"h-3 w-3"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(e=>{j(e),v(!0)})(e),className:"h-8 w-8 p-0",title:"Editar evento",children:a.jsx(Me,{className:"h-3 w-3"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(async(e,a)=>{if(confirm(`Tem certeza que deseja excluir o evento "${a}"?`))try{await m(e),Cs.success("Evento excluído com sucesso!")}catch(s){Cs.error("Erro ao excluir evento")}})(e.id,e.title),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Excluir evento",children:a.jsx(P,{className:"h-3 w-3"})})]})]})})},e.id))})}),a.jsxs(Ao,{value:"past",className:"space-y-4 mt-4",children:[a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsxs(dt,{className:"text-sm flex items-center justify-between",children:[a.jsx("span",{children:"Resumo"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>{n({showPastEvents:!i.showPastEvents})},className:"h-6 px-2 text-xs",children:[i.showPastEvents?a.jsx(oa,{className:"h-3 w-3 mr-1"}):a.jsx(ia,{className:"h-3 w-3 mr-1"}),i.showPastEvents?"Ocultar no calendário":"Mostrar no calendário"]})})]})}),a.jsx(mt,{className:"pt-0",children:a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-green-100 text-green-800 border-green-200",children:[o.finished," Finalizado",1!==o.finished?"s":""]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-gray-100 text-gray-800 border-gray-200",children:[o.hidden," Oculto",1!==o.hidden?"s":""]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-blue-100 text-blue-800 border-blue-200",children:[o.past," Total"]})})]})})]}),a.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Histórico de Eventos"}),0===s.length?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-4xl mb-4",children:"📅"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum evento passado encontrado."})]}):s.map(e=>{return a.jsx(nt,{className:"hover:bg-gray-50 transition-colors",children:a.jsxs(mt,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 rounded-full "+("aniversario"===e.type?"bg-pink-100 text-pink-600":"bg-blue-100 text-blue-600"),children:(o=e.type,"aniversario"===o?a.jsx(la,{className:"h-4 w-4"}):a.jsx(le,{className:"h-4 w-4"}))}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"text-sm font-medium",children:e.title}),(s=e.status.status,"finished"===s?a.jsx(ze,{className:"h-4 w-4 text-green-600"}):a.jsx(ia,{className:"h-4 w-4 text-gray-500"}))]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:e.subtitle}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(h,{className:"h-3 w-3 text-muted-foreground"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:y(e.date)})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1",children:[a.jsx(mr,{variant:"secondary",className:"text-xs",children:w(e.status.status)}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(e.id),className:"h-6 px-2",title:"Restaurar evento",children:a.jsx(na,{className:"h-3 w-3"})}),"finished"===e.status.status&&a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>{return a=e.id,void t(a,"hidden");var a},className:"h-6 px-2",title:"Ocultar evento",children:a.jsx(ia,{className:"h-3 w-3"})})]})]})]}),a.jsx("div",{className:"mt-2 pt-2 border-t",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:["finished"===e.status.status&&e.status.finishedAt&&a.jsxs(a.Fragment,{children:["Finalizado em: ",C(e.status.finishedAt)]}),"hidden"===e.status.status&&e.status.hiddenAt&&a.jsxs(a.Fragment,{children:["Ocultado em: ",C(e.status.hiddenAt)]})]})})]})},e.id);var s,o})]}),a.jsx(nt,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:a.jsx(mt,{className:"p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:"text-lg",children:"💡"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-blue-800 mb-1",children:"Dica sobre Eventos Passados"}),a.jsxs("p",{className:"text-xs text-blue-700",children:["Eventos finalizados são ocultados automaticamente após ",i.autoHideAfterHours,' horas. Use o botão "Restaurar" para reativar um evento.']})]})]})})})]})]})]})]}),a.jsx(Mo,{isOpen:b,onOpenChange:v,event:f,onUpdate:c})]})},Jo=({className:e=""})=>{const s=new Date,{customEvents:r}=zo(s),t=r.filter(e=>Fs(zs(e.date),As(new Date))).sort((e,a)=>new Date(e.date).getTime()-new Date(a.date).getTime()).slice(0,3),o={curso:a.jsx(aa,{className:"h-3 w-3 text-blue-600"}),webinario:a.jsx(sa,{className:"h-3 w-3 text-purple-600"}),reuniao:a.jsx(ra,{className:"h-3 w-3 text-green-600"}),outro:a.jsx(D,{className:"h-3 w-3 text-amber-600"})},i=a.jsx(vo,{}),n=a.jsx(ko,{});if(!i&&!n)return null;const l=null!==i,d=null!==n;return a.jsxs("div",{className:`mb-8 ${e}`,children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"h-1 w-8 bg-gradient-primary rounded-full"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(le,{className:"h-5 w-5 text-primary"}),a.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Eventos & Calendário"})]}),a.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-border to-transparent"}),a.jsx(Ro,{})]}),l&&!d&&a.jsx("div",{className:"max-w-lg mx-auto",children:i}),!l&&d&&a.jsx("div",{className:"max-w-lg mx-auto",children:n}),l&&d&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i,n]}),t.length>0&&a.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[a.jsxs("h3",{className:"text-sm font-semibold text-blue-800 dark:text-blue-200 mb-3 flex items-center gap-2",children:[a.jsx(le,{className:"h-4 w-4"}),"Próximos Eventos Personalizados"]}),a.jsx("div",{className:"space-y-2",children:t.map(e=>a.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[o[e.type],a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:e.title})]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400",children:[a.jsx(h,{className:"h-3 w-3"}),a.jsx("span",{children:ks(zs(e.date),"dd/MM",{locale:Es})}),e.start_time&&a.jsxs("span",{children:["às ",e.start_time.substring(0,5)]})]})]},e.id))})]}),a.jsx("div",{className:"mt-6 h-px bg-gradient-to-r from-transparent via-border to-transparent"})]})},Uo=({isOpen:s=!1,onToggle:r})=>{const{data:t}=go(),o=()=>`Como posso ajudar ${t?.nome_completo||t?.email?.split("@")[0]||"Usuário"}?`,[n,l]=e.useState([{id:"welcome",role:"assistant",content:o(),timestamp:new Date}]),[d,c]=e.useState(""),[m,u]=e.useState(!1),[x,h]=e.useState(!0),[g,p]=e.useState("auto"),f=e.useRef(null),j=e.useRef(null);e.useEffect(()=>{t&&l(e=>e.map(e=>"welcome"===e.id?{...e,content:o()}:e))},[t]),e.useEffect(()=>{if(f.current){const e=f.current.querySelector("[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}},[n]),e.useEffect(()=>{s&&j.current&&j.current.focus()},[s]);const b=async()=>{if(!d.trim()||m)return;const e={id:Date.now().toString(),role:"user",content:d.trim(),timestamp:new Date};l(a=>[...a,e]),c(""),u(!0);try{const a=n.map(e=>({role:e.role,content:e.content})),s={message:e.content,conversationHistory:a,enableWebSearch:"auto"===g?x:"web"===g,searchMode:g},{data:r,error:t}=await dr.functions.invoke("chat-assistant",{body:s});if(t)throw new Error(`Erro na chamada da função: ${t.message||JSON.stringify(t)}`);if(!r)throw new Error("Nenhuma resposta recebida da função");if(!r.success)throw new Error(r?.error||"Erro desconhecido na resposta");const o={id:(Date.now()+1).toString(),role:"assistant",content:r.response,timestamp:new Date};l(e=>[...e,o])}catch(a){const s=N(e.content),r={id:(Date.now()+1).toString(),role:"assistant",content:s,timestamp:new Date};l(e=>[...e,r]),qr({title:"Modo Offline",description:`Conectividade limitada. Usando respostas locais. Erro: ${a.message}`,variant:"default"})}finally{u(!1)}},N=e=>{const a=e.toLowerCase();return a.includes("chamado")||a.includes("ticket")?'Para criar um chamado no sistema do TRT15:\n\n1. Acesse a seção "Criar Chamado" no painel\n2. Selecione o tipo apropriado (Incidente, Solicitação, etc.)\n3. Preencha o título e descrição detalhada\n4. Selecione o assunto relacionado\n5. Adicione anexos se necessário\n6. Clique em "Criar Chamado"\n\nO sistema gerará automaticamente um número de protocolo para acompanhamento.':a.includes("acesso")||a.includes("login")||a.includes("senha")?'Para problemas de acesso ao sistema:\n\n🔐 **Reset de Senha:**\n- Use a opção "Esqueci minha senha" na tela de login\n- Verifique seu email institucional\n- Siga as instruções do link recebido\n\n🔑 **Problemas de Login:**\n- Verifique se está usando o email correto (@trt15.jus.br)\n- Limpe o cache do navegador\n- Tente em modo anônimo/privado\n- Entre em contato com o suporte se persistir\n\n⚠️ **Conta Bloqueada:**\n- Entre em contato com a equipe de TI\n- Forneça seu nome completo e matrícula':a.includes("sistema")||a.includes("status")||a.includes("funcionando")?"Status dos sistemas TRT15:\n\n✅ **Sistemas Principais:**\n- PJe (Processo Judicial Eletrônico)\n- Sistema de Chamados\n- Portal do Servidor\n\n🔄 **Para verificar status atual:**\n- Consulte o painel de status interno\n- Verifique comunicados oficiais\n- Entre em contato com a equipe de TI\n\n📞 **Suporte:**\n- Sistema de Chamados: Prioridade 1\n- Email: suporte@trt15.jus.br\n- Ramal interno: 2345":a.includes("pje")||a.includes("processo")?"Informações sobre o PJe (Processo Judicial Eletrônico):\n\n📋 **Funcionalidades Principais:**\n- Consulta de processos\n- Movimentação processual\n- Audiências virtuais\n- Documentos eletrônicos\n\n🔧 **Problemas Comuns:**\n- Certificado digital expirado\n- Navegador incompatível\n- Cache do navegador\n- Conexão de internet\n\n📞 **Suporte PJe:**\n- Abra chamado específico para PJe\n- Informe número do processo\n- Descreva o erro detalhadamente":"Sou o Assistente-Bot e estou operando em modo offline limitado.\n\n📋 **Posso ajudar com:**\n- Orientações sobre criação de chamados\n- Problemas de acesso e senha\n- Status dos sistemas\n- Informações sobre PJe\n- Procedimentos básicos de TI\n\n💡 **Para suporte completo:**\n- Abra um chamado no sistema\n- Entre em contato com a equipe de TI\n- Consulte a base de conhecimento\n\n🔄 **Aguarde:** Trabalhamos para restabelecer a conectividade completa da IA.\n\nComo posso ajudá-lo com base nas informações disponíveis?"};return s?a.jsxs(nt,{className:"fixed bottom-6 right-6 w-[600px] h-[700px] max-h-[90vh] shadow-xl z-50 flex flex-col max-w-[calc(100vw-3rem)] bg-gradient-card backdrop-blur-sm border-2 border-blue-200/40 animate-fade-in font-roboto dark:bg-gray-900/95 dark:border-gray-700/50 dark:shadow-2xl",children:[a.jsxs(lt,{className:"bg-gradient-pastel-blue/40 backdrop-blur-sm border-b border-blue-200/30 flex flex-row items-center justify-between space-y-0 pb-3 pt-3 dark:bg-gray-800/80 dark:border-gray-700/50",children:[a.jsxs(dt,{className:"flex items-center gap-3 text-xl font-roboto",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-pastel-blue rounded-full flex items-center justify-center shadow-soft dark:bg-gradient-to-br dark:from-blue-600 dark:to-purple-600",children:a.jsx(ne,{className:"h-7 w-7 text-blue-700 dark:text-blue-100"})}),a.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-gradient-pastel-green rounded-full border-2 border-white flex items-center justify-center dark:bg-green-400 dark:border-gray-800",children:a.jsx(D,{className:"h-2 w-2 text-green-700 dark:text-green-900"})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-bold text-blue-800 text-lg dark:text-blue-100",children:"Assistente-Bot"}),a.jsx("span",{className:"text-sm text-blue-600 font-normal dark:text-blue-300",children:"Mar-IA"})]}),a.jsxs(mr,{className:"text-sm font-medium font-roboto border "+("auto"===g?"bg-gradient-pastel-green/60 text-green-700 border-green-200/60 dark:bg-green-600/80 dark:text-green-100 dark:border-green-500/50":"internal"===g?"bg-gradient-pastel-blue/60 text-blue-700 border-blue-200/60 dark:bg-blue-600/80 dark:text-blue-100 dark:border-blue-500/50":"bg-gradient-pastel-purple/60 text-purple-700 border-purple-200/60 dark:bg-purple-600/80 dark:text-purple-100 dark:border-purple-500/50"),children:["auto"===g&&a.jsx(Re,{className:"h-4 w-4 mr-1"}),"internal"===g&&a.jsx(ca,{className:"h-4 w-4 mr-1"}),"web"===g&&a.jsx(ma,{className:"h-4 w-4 mr-1"}),"auto"===g?"Inteligente":"internal"===g?"Base Interna":"Busca Web"]})]}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx(Wr,{children:a.jsxs(Zr,{children:[a.jsx(et,{asChild:!0,children:a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>{const e=["auto","internal","web"],a=e.indexOf(g),s=e[(a+1)%e.length];p(s),qr({title:"Modo de busca alterado",description:"Agora usando: "+("auto"===s?"Busca Inteligente (recomendado)":"internal"===s?"Apenas Base Interna":"Busca Web Prioritária"),duration:2e3})},className:"h-8 px-3 hover:bg-blue-100/60 transition-colors dark:hover:bg-blue-900/50 text-xs",children:[a.jsx(ua,{className:"h-3 w-3 mr-1"}),"auto"===g?"Auto":"internal"===g?"Base":"Web"]})}),a.jsx(at,{children:a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Modo atual:"})," ","auto"===g?"Busca Inteligente":"internal"===g?"Apenas Base Interna":"Busca Web Prioritária",a.jsx("br",{}),a.jsx("em",{children:"Clique para alternar"})]})})]})}),a.jsx(cr,{variant:"ghost",size:"icon",onClick:()=>{l([{id:"welcome",role:"assistant",content:o(),timestamp:new Date}])},className:"h-8 w-8 hover:bg-red-100/60 transition-colors dark:hover:bg-red-900/50 dark:text-red-400",title:"Limpar conversa",children:a.jsx(P,{className:"h-4 w-4 text-red-600 dark:text-red-400"})}),a.jsx(cr,{variant:"ghost",size:"icon",onClick:r,className:"h-8 w-8 hover:bg-blue-100/60 transition-colors dark:hover:bg-blue-900/50 dark:text-blue-400",children:a.jsx(i,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})})]})]}),a.jsxs(mt,{className:"flex-1 flex flex-col p-0 bg-gradient-to-b from-blue-50/20 to-purple-50/10 min-h-0 dark:bg-gradient-to-b dark:from-gray-800/50 dark:to-gray-900/50",children:[a.jsx("div",{className:"flex-1 min-h-0",children:a.jsx(Ar,{className:"h-full px-4",ref:f,children:a.jsxs("div",{className:"space-y-4 py-4",children:[n.map((e,s)=>{return a.jsxs("div",{className:"flex gap-3 animate-fade-in "+("user"===e.role?"justify-end":"justify-start"),style:{animationDelay:100*s+"ms"},children:["assistant"===e.role&&a.jsx("div",{className:"w-8 h-8 bg-gradient-pastel-blue rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-soft border border-blue-200/40 dark:bg-gradient-to-br dark:from-blue-600 dark:to-purple-600 dark:border-blue-500/50",children:a.jsx(ne,{className:"h-4 w-4 text-blue-700 dark:text-blue-100"})}),a.jsxs("div",{className:"max-w-[480px] rounded-2xl px-5 py-4 text-base shadow-soft transition-all duration-200 hover:shadow-medium "+("user"===e.role?"bg-gradient-pastel-purple/70 text-purple-800 ml-auto border border-purple-200/40 dark:bg-gradient-to-br dark:from-purple-600/80 dark:to-blue-600/80 dark:text-purple-100 dark:border-purple-500/50":"bg-gradient-card border border-blue-200/30 text-gray-700 dark:bg-gray-800/90 dark:border-gray-600/50 dark:text-gray-100"),children:[a.jsx("div",{className:"whitespace-pre-wrap leading-relaxed break-words max-h-[400px] overflow-y-auto custom-scrollbar font-medium",children:e.content}),a.jsx("div",{className:"text-sm mt-3 opacity-70 font-medium "+("user"===e.role?"text-right text-purple-700 dark:text-purple-300":"text-left text-gray-500 dark:text-gray-400"),children:(r=e.timestamp,r.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}))})]}),"user"===e.role&&a.jsx("div",{className:"w-8 h-8 bg-gradient-pastel-purple rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-soft border border-purple-200/40 dark:bg-gradient-to-br dark:from-purple-600 dark:to-pink-600 dark:border-purple-500/50",children:a.jsx(se,{className:"h-4 w-4 text-purple-700 dark:text-purple-100"})})]},e.id);var r}),m&&a.jsxs("div",{className:"flex gap-3 justify-start animate-fade-in",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-pastel-blue rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-soft border border-blue-200/40 dark:bg-gradient-to-br dark:from-blue-600 dark:to-purple-600 dark:border-blue-500/50",children:a.jsx(ne,{className:"h-4 w-4 text-blue-700 dark:text-blue-100"})}),a.jsx("div",{className:"bg-gradient-card rounded-2xl px-5 py-4 text-base shadow-soft border border-blue-200/30 dark:bg-gray-800/90 dark:border-gray-600/50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce dark:bg-blue-300"}),a.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce dark:bg-blue-300",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce dark:bg-blue-300",style:{animationDelay:"0.2s"}})]}),a.jsx("span",{className:"text-blue-600 text-sm font-medium dark:text-blue-300",children:"Assistente está digitando..."})]})})]})]})})}),a.jsxs("div",{className:"flex-shrink-0 p-4 bg-gradient-card/50 backdrop-blur-sm border-t border-blue-200/30 dark:bg-gray-800/50 dark:border-gray-700/50",children:[a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Sr,{ref:j,value:d,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},placeholder:"Digite sua mensagem...",disabled:m,className:"pr-12 py-4 rounded-2xl bg-white/90 border-2 border-blue-200/40 focus:border-blue-300/60 shadow-soft transition-all duration-200 text-base font-medium placeholder:text-gray-500 font-roboto dark:bg-gray-800/90 dark:border-gray-600/50 dark:text-gray-100 dark:placeholder:text-gray-400 dark:focus:border-blue-500/60"}),a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:d.length>0&&a.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:d.length})})]}),a.jsx(cr,{onClick:b,disabled:!d.trim()||m,className:"h-12 w-12 rounded-full bg-gradient-pastel-blue hover:bg-gradient-pastel-purple shadow-soft hover:shadow-medium transition-all duration-200 border-2 border-blue-200/40 hover:scale-105 disabled:opacity-50 disabled:hover:scale-100 dark:bg-gradient-to-br dark:from-blue-600 dark:to-purple-600 dark:hover:from-blue-500 dark:hover:to-purple-500 dark:border-blue-500/50",size:"icon",children:m?a.jsx(v,{className:"h-5 w-5 animate-spin text-blue-700 dark:text-blue-100"}):a.jsx(xa,{className:"h-5 w-5 text-blue-700 dark:text-blue-100"})})]}),1===n.length&&!m&&a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"flex gap-2 flex-wrap mb-3",children:["Erro ao assinar Documento","Problemas com o PDPJ","Sistema PJe indisponível"].map(e=>a.jsx("button",{onClick:()=>c(e),className:"text-sm px-4 py-2 bg-gradient-pastel-green/40 text-green-700 rounded-full border border-green-200/40 hover:bg-gradient-pastel-green/60 transition-all duration-200 hover:scale-105 font-medium font-roboto dark:bg-green-600/60 dark:text-green-100 dark:border-green-500/50 dark:hover:bg-green-600/80",children:e},e))}),a.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-2 bg-gray-50/50 dark:bg-gray-800/30 rounded-lg p-2",children:["auto"===g&&a.jsxs(a.Fragment,{children:[a.jsx(Re,{className:"h-3 w-3 text-green-600"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Busca Inteligente:"})," Prioriza base interna, complementa com web quando necessário"]})]}),"internal"===g&&a.jsxs(a.Fragment,{children:[a.jsx(ca,{className:"h-3 w-3 text-blue-600"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Base Interna:"})," Busca apenas na base de conhecimento e chamados do TRT15"]})]}),"web"===g&&a.jsxs(a.Fragment,{children:[a.jsx(ma,{className:"h-3 w-3 text-purple-600"}),a.jsxs("span",{children:[a.jsx("strong",{children:"Busca Web:"})," Inclui sites oficiais (TRT15, CNJ, TST) além da base interna"]})]})]})]})]})]})]}):a.jsx(cr,{onClick:r,className:"fixed bottom-6 right-6 h-16 w-16 rounded-full bg-gradient-pastel-blue hover:bg-gradient-pastel-purple shadow-large hover:shadow-xl transition-all duration-300 z-50 group hover:scale-110 border-2 border-blue-200/60 dark:border-blue-700/60 dark:bg-gradient-to-br dark:from-blue-600 dark:to-purple-600 dark:hover:from-blue-500 dark:hover:to-purple-500",size:"icon",children:a.jsxs("div",{className:"relative",children:[a.jsx(da,{className:"h-7 w-7 text-blue-700 group-hover:text-purple-700 transition-colors dark:text-blue-100 dark:group-hover:text-purple-100"}),a.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gradient-pastel-green rounded-full animate-pulse dark:bg-green-400"})]})})};class qo extends b.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,a){}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:a.jsxs(pt,{variant:"glass",className:"max-w-md w-full",children:[a.jsx(ft,{title:"Ops! Algo deu errado",description:"Ocorreu um erro inesperado",icon:a.jsx(ha,{className:"h-5 w-5 text-destructive"})}),a.jsxs(jt,{className:"space-y-4",children:[a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsx("p",{children:"Não se preocupe, isso pode acontecer às vezes."}),a.jsx("p",{className:"mt-2",children:"Tente recarregar a página ou entre em contato com o suporte se o problema persistir."})]}),this.state.error&&a.jsxs("details",{className:"text-xs text-muted-foreground bg-muted/50 p-3 rounded-lg",children:[a.jsx("summary",{className:"cursor-pointer font-medium",children:"Detalhes técnicos"}),a.jsx("pre",{className:"mt-2 whitespace-pre-wrap break-words",children:this.state.error.message})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{onClick:()=>window.location.reload(),className:"flex-1",variant:"default",children:[a.jsx(na,{className:"h-4 w-4 mr-2"}),"Recarregar Página"]}),a.jsx(cr,{onClick:()=>this.setState({hasError:!1}),variant:"outline",className:"flex-1",children:"Tentar Novamente"})]})]})]})}):this.props.children}}const Vo=()=>{const s=F(),{user:r}=tt(),{isOpen:t,toggleChat:o}=(()=>{const[a,s]=e.useState(!1);return{isOpen:a,toggleChat:()=>{s(!a)},openChat:()=>{s(!0)},closeChat:()=>{s(!1)}}})(),{notes:i,loading:n,stats:l,latestNote:d}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState(!0);e.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:{user:e}}=await dr.auth.getUser();if(!e)return void t(!1);const{data:a,error:r}=await dr.from("postit_notes").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(5);if(r)throw r;s(a||[])}catch(e){s([])}finally{t(!1)}};return{notes:a,loading:r,stats:(()=>{const e=(new Date).toDateString(),s=a.filter(a=>new Date(a.created_at).toDateString()===e);return{total:a.length,today:s.length}})(),latestNote:a.length>0?a[0]:null,refreshNotes:o}})(),[c,m]=e.useState(!1),[u,x]=e.useState(!1);e.useEffect(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),x(!0))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[]);const{duplicarChamado:h,editarChamado:g}=zt(),p=async()=>{w(!0);try{const{data:e,error:a}=await dr.from("chamados").select("*").order("created_at",{ascending:!1}).limit(3);if(a);else{const a=(e||[]).map(e=>({id:e.id,titulo:e.titulo||"Sem título",descricao:e.descricao||"Sem descrição",grau:e.grau,numero_processo:e.numero_processo,orgao_julgador:e.orgao_julgador,perfil_usuario_afetado:e.perfil_usuario_afetado,nome_usuario_afetado:e.nome_usuario_afetado,cpf_usuario_afetado:e.cpf_usuario_afetado,chamado_origem:e.chamado_origem,created_at:e.created_at,status:e.status||"Aberto"}));v(a)}}catch(e){}finally{w(!1)}},{data:j}=f({queryKey:["user-admin",r?.id],queryFn:async()=>{if(!r?.id)return!1;const{data:e,error:a}=await dr.from("profiles").select("is_admin").eq("id",r.id).single();return!a&&(e?.is_admin||!1)},enabled:!!r?.id}),[b,v]=e.useState([]),[N,w]=e.useState(!0);e.useEffect(()=>{(async()=>{w(!0);try{const{data:e,error:a}=await dr.from("chamados").select("*").order("created_at",{ascending:!1}).limit(3);if(a)v([]);else{const a=(e||[]).map(e=>({id:e.id,assunto:e.titulo||"Sem título",descricao:e.descricao||"Sem descrição",categoria:e.grau,numero_processo:e.numero_processo,orgao_julgador:e.orgao_julgador,perfil_usuario_afetado:e.perfil_usuario_afetado,usuario_criador_nome:e.nome_usuario_afetado,cpf_usuario_afetado:e.cpf_usuario_afetado,chamado_origem:e.chamado_origem,created_at:e.created_at,status:e.status||"Aberto"}));v(a)}}catch(e){v([])}finally{w(!1)}})()},[]);const y=async()=>{try{const{data:e,error:a,count:s}=await dr.from("chamados").select("*",{count:"exact"}).order("created_at",{ascending:!1}).limit(10);a||qr({title:"Debug: Dados da Tabela",description:`Encontrados ${s} chamados na tabela. Veja o console para detalhes.`,duration:5e3})}catch(e){}};e.useEffect(()=>{const e=`debug_test_${(new Date).toDateString()}`;sessionStorage.getItem(e)||(setTimeout(y,1e3),sessionStorage.setItem(e,"true"))},[]),e.useEffect(()=>{},[b,N]);const C=[{icon:S,title:"Novo Chamado",description:"Criar um novo chamado",onClick:()=>s("/criar-chamado"),color:"bg-gradient-to-r from-blue-500 to-blue-600"},{icon:le,title:"Calendário",description:"Agendar compromissos",onClick:()=>s("/calendario"),color:"bg-gradient-to-r from-indigo-500 to-indigo-600"},{icon:Re,title:"Atalhos",description:"Gerenciar atalhos",onClick:()=>s("/atalhos"),color:"bg-gradient-to-r from-yellow-500 to-orange-600"},{icon:aa,title:"Base de Conhecimento",description:"Consultar documentos",onClick:()=>s("/base-conhecimento"),color:"bg-gradient-to-r from-purple-500 to-purple-600"},{icon:ga,title:"Órgãos Julgadores",description:"Consultar órgãos",onClick:()=>s("/orgaos-julgadores"),color:"bg-gradient-to-r from-orange-500 to-orange-600"}];return a.jsx(qo,{children:a.jsxs(gt,{children:[a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl py-6 space-y-8",children:[a.jsx(mo,{user:r,onSearch:()=>x(!0)}),a.jsxs(bt,{cols:4,gap:"lg",children:[a.jsx(vt,{span:3,children:a.jsxs("div",{className:"space-y-8",children:[a.jsx(Jo,{}),a.jsx(uo,{actions:C}),a.jsx(xo,{chamados:b,isLoading:N,onDuplicar:e=>{h(e),setTimeout(p,500)},onEditar:e=>{g(e),setTimeout(p,500)},onExcluir:async e=>{try{const{data:{user:a}}=await dr.auth.getUser(),{error:s,data:r}=await dr.from("chamados").delete().eq("id",e).select();if(s)return void qr({title:"Erro ao excluir",description:`${s.message}`,variant:"destructive",duration:5e3});v(a=>a.filter(a=>a.id!==e)),qr({title:"Sucesso",description:"Chamado excluído com sucesso",duration:3e3})}catch(a){qr({title:"Erro",description:"Erro inesperado ao excluir chamado",variant:"destructive",duration:3e3})}}})]})}),a.jsx(vt,{span:1,children:a.jsxs("div",{className:"space-y-6 sticky top-6",children:[a.jsxs(pt,{variant:"glass",glow:!0,children:[a.jsx(ft,{title:"Insights de IA",description:"Recomendações inteligentes",icon:a.jsx(Oe,{className:"h-5 w-5 text-white"}),action:a.jsx(cr,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a.jsx(na,{className:"h-4 w-4"})})}),a.jsx(jt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-card/60 backdrop-blur-sm rounded-xl p-4 border border-border/20",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"p-2 bg-gradient-blue rounded-lg",children:a.jsx(pa,{className:"h-4 w-4 text-white"})}),a.jsx("span",{className:"font-medium text-foreground",children:"Bem-vindo ao NAPJe!"})]}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed mb-3",children:"Comece criando seu primeiro chamado para organizar suas tarefas e acompanhar o progresso dos seus projetos."}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(mr,{variant:"outline",className:"text-xs",children:"medium"}),a.jsx(mr,{variant:"outline",className:"text-xs",children:"productivity"})]}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"95% confiança"})]})]}),a.jsx(ht,{variant:"gradient",className:"w-full",onClick:()=>s("/criar-chamado"),children:"Criar Chamado →"})]})})]}),a.jsxs(pt,{variant:"glass",children:[a.jsx(ft,{title:"Notas Rápidas",description:"Lembretes e anotações",icon:a.jsx(k,{className:"h-5 w-5 text-white"}),action:a.jsx(ht,{variant:"outline",size:"sm",onClick:()=>m(!0),icon:a.jsx(S,{className:"h-4 w-4"}),className:"h-8 px-3",children:"Nova"})}),a.jsx(jt,{children:a.jsxs("div",{className:"space-y-4",children:[n?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):d?a.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-xl p-4 border border-yellow-200/50 dark:border-yellow-700/50",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-1.5 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg flex-shrink-0",children:a.jsx(k,{className:"h-3 w-3 text-white"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"text-sm font-medium text-foreground mb-1",children:"Nota Recente"}),a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:d.content||"Nota sem conteúdo"}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-xs text-yellow-600 dark:text-yellow-400 font-medium",children:new Date(d.created_at).toLocaleDateString("pt-BR")}),a.jsx("div",{className:"w-1 h-1 bg-yellow-400 rounded-full"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(d.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]})]})}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(k,{className:"h-8 w-8 text-white"})}),a.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Nenhuma nota criada"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Crie sua primeira nota rápida para organizar lembretes"}),a.jsx(ht,{variant:"outline",size:"sm",onClick:()=>m(!0),icon:a.jsx(S,{className:"h-4 w-4"}),children:"Criar Primeira Nota"})]}),i.length>0&&a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"text-center p-3 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-lg font-bold text-orange-600",children:l.total}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Notas Ativas"})]}),a.jsxs("div",{className:"text-center p-3 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-lg font-bold text-green-600",children:l.today}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Hoje"})]})]}),i.length>0&&a.jsx(ht,{variant:"gradient",className:"w-full",onClick:()=>m(!0),icon:a.jsx(k,{className:"h-4 w-4"}),children:"Gerenciar Notas"})]})})]})]})})]}),a.jsx(ho,{})]}),a.jsx(_r,{isOpen:u,onClose:()=>x(!1),onResultSelect:e=>{try{if(qr({title:"Navegando...",description:`Abrindo: ${e.title}`,duration:2e3}),e.metadata?.action)return void s(`/${e.metadata.action}`);switch(e.title?.toLowerCase().includes("problema")||e.title?.toLowerCase().includes("perito"),e.type){case"chamado":const a=e.metadata?.searchTerm||e.metadata?.originalQuery||e.title,r=`/chamados-recentes?search=${encodeURIComponent(a)}&highlight=${encodeURIComponent(e.id)}`;s(r);break;case"conhecimento":let t=e.metadata?.searchTerm||"";if(!t)if(e.metadata?.tags&&Array.isArray(e.metadata.tags))t=e.metadata.tags[0];else{const a=e.title?.toLowerCase()||"";t=["horário","problema","perito","usuário","backup","configuração","manual","erro","sistema"].find(e=>a.includes(e))||a.split(" ")[0]||""}s(t?`/base-conhecimento?search=${encodeURIComponent(t)}&highlight=${encodeURIComponent(e.id)}`:"/base-conhecimento");break;case"atalho":if(e.url)window.open(e.url,"_blank");else{const a=e.metadata?.searchTerm||e.title;s(`/atalhos?search=${encodeURIComponent(a)}`)}break;case"usuario":const o=e.metadata?.searchTerm||e.title;s(`/admin/usuarios?search=${encodeURIComponent(o)}`);break;default:if("orgao"===e.type){const a=e.metadata?.searchTerm||e.title;s(`/orgaos-julgadores?search=${encodeURIComponent(a)}`)}else if("evento"===e.type)s("/calendario");else if("memoria"===e.type){const a=e.metadata?.searchTerm||e.title;s(`/memorias-importantes?search=${encodeURIComponent(a)}`)}else{const a=e.metadata?.searchTerm||e.title;s(`/chamados-recentes?search=${encodeURIComponent(a)}`)}}}catch(a){qr({title:"Erro",description:"Ocorreu um erro ao processar o resultado. Tente novamente.",variant:"destructive",duration:3e3})}x(!1)}}),a.jsx(wr,{open:c,onOpenChange:m,children:a.jsxs(yr,{className:"max-w-4xl max-h-[80vh] bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-white/20",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[a.jsx("div",{className:"p-1.5 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg",children:a.jsx(k,{className:"h-4 w-4 text-white"})}),"Notas Rápidas"]})}),a.jsx("div",{className:"overflow-auto max-h-[60vh]",children:a.jsx(Et,{})})]})}),a.jsx(Uo,{isOpen:t,onToggle:o})]})})},Lo=({title:e,subtitle:s,showBackButton:r=!0,backTo:t="/",children:o})=>{const i=F();return a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[r&&a.jsxs(cr,{variant:"outline",onClick:()=>i(t),className:"flex items-center gap-2",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar"]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:e}),s&&a.jsx("p",{className:"text-muted-foreground",children:s})]}),o]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Qt,{}),a.jsx(Yt,{}),a.jsx(Xt,{}),a.jsx(Ht,{})]})]})},$o=(e=(new Date).getFullYear())=>f({queryKey:["vacation-suggestions",e],queryFn:async()=>{try{const a=ks(Us(new Date(e,0,1)),"yyyy-MM-dd"),s=ks(qs(new Date(e,11,31)),"yyyy-MM-dd"),{data:r,error:t}=await dr.from("feriados").select("*").gte("data",a).lte("data",s).order("data",{ascending:!0});if(t)return[];const o=new Date;return function(e,a){try{const s=[];if(!e||0===e.length)return Go(a);const r=function(e){const a=[];let s=[];return e.forEach((r,t)=>{const o=Ho(r.data);if(0===s.length)s.push(r);else{const e=Ho(s[s.length-1].data);Is(o,e)<=10?s.push(r):(s.length>0&&a.push([...s]),s=[r])}t===e.length-1&&s.length>0&&a.push([...s])}),a}(e);r.forEach((e,r)=>{try{const t=function(e,a,s){const r=[];if(0===e.length)return r;const t=Ho(e[0].data),o=Ho(e[e.length-1].data),i=Bo(Ds(t,-1),"backward"),n=Bo(Ds(i,-9),"backward");n.getFullYear()===a&&r.push({id:`before-${s}`,startDate:ks(n,"yyyy-MM-dd"),endDate:ks(i,"yyyy-MM-dd"),totalDays:Is(i,n)+1,workDays:Xo(n,i),score:Qo(n,i,e,"before"),reason:`Emendar com ${e.map(e=>e.descricao).join(", ")}`,holidays:e.map(e=>e.descricao),benefits:["Período estendido de descanso","Aproveita feriados sequenciais","Menor custo de viagem"],period:Ko(t)});let l=Ds(o,1);l=Bo(l,"forward");let d=new Date(l),c=0;for(;c<6;)d=Ds(d,1),Vs(d)||c++;d=Bo(d,"backward"),d.getFullYear()===a&&r.push({id:`after-${s}`,startDate:ks(l,"yyyy-MM-dd"),endDate:ks(d,"yyyy-MM-dd"),totalDays:Is(d,l)+1,workDays:Xo(l,d),score:Qo(l,d,e,"after"),reason:`Estender após ${e.map(e=>e.descricao).join(", ")}`,holidays:e.map(e=>e.descricao),benefits:["Máximo aproveitamento dos feriados","Volta ao trabalho mais descansado","Evita multidões do retorno","Período otimizado (evita fins de semana)"],period:Ko(o)});return r}(e,a,r);s.push(...t)}catch(t){}});try{const e=function(e,a){const s=[],r=new Date(a,0,8),t=new Date(a,0,17);s.push({id:"strategic-january",startDate:ks(r,"yyyy-MM-dd"),endDate:ks(t,"yyyy-MM-dd"),totalDays:10,workDays:Xo(r,t),score:75,reason:"Início de ano tranquilo e preços baixos",holidays:[],benefits:["Destinos vazios pós-festividades","Preços promocionais","Clima de verão"],period:"primeiro-semestre"});const o=new Date(a,4,6),i=new Date(a,4,15);return s.push({id:"strategic-may",startDate:ks(o,"yyyy-MM-dd"),endDate:ks(i,"yyyy-MM-dd"),totalDays:10,workDays:Xo(o,i),score:70,reason:"Outono com clima agradável",holidays:[],benefits:["Clima perfeito para turismo","Baixa temporada","Natureza em transição"],period:"primeiro-semestre"}),s}(0,a);s.push(...e)}catch(t){}try{const r=function(e,a){const s=[],r=new Date(a,11,20),t=new Date(a+1,0,10);return s.push({id:"year-end-extended",startDate:ks(r,"yyyy-MM-dd"),endDate:ks(t,"yyyy-MM-dd"),totalDays:22,workDays:Xo(r,t),score:90,reason:"Virada de ano estendida - máximo descanso",holidays:e.filter(e=>{const a=new Date(e.data);return a>=r&&a<=t}).map(e=>e.descricao),benefits:["Período completo de renovação","Aproveita todas as festas","Momento perfeito para viagens longas"],period:"virada-ano"}),s}(e,a);s.push(...r)}catch(t){}return s.filter(e=>e&&e.id&&e.startDate&&e.endDate).sort((e,a)=>a.score-e.score).slice(0,6)}catch(t){return Go(a)}}((r||[]).filter(e=>{const a=new Date(e.data);return Fs(a,o)||a.toDateString()===o.toDateString()}),e)}catch(a){return[]}},retry:2,staleTime:3e5});function Bo(e,a){const s=new Date(e),r=Ls(s);if("forward"===a){if(6===r)return Ds(s,2);if(0===r)return Ds(s,1)}else{if(6===r)return Ds(s,-1);if(0===r)return Ds(s,-2)}return s}function Go(e){return[{id:"basic-january",startDate:`${e}-01-08`,endDate:`${e}-01-17`,totalDays:10,workDays:8,score:60,reason:"Início de ano tranquilo",holidays:[],benefits:["Preços baixos","Destinos menos movimentados"],period:"primeiro-semestre"},{id:"basic-may",startDate:`${e}-05-06`,endDate:`${e}-05-15`,totalDays:10,workDays:8,score:55,reason:"Outono agradável",holidays:[],benefits:["Clima ameno","Baixa temporada"],period:"primeiro-semestre"}]}function Ho(e){const[a,s,r]=e.split("-").map(Number);return new Date(a,s-1,r)}function Xo(e,a){let s=0,r=new Date(e);for(;r<=a;)Vs(r)||s++,r=Ds(r,1);return s}function Qo(e,a,s,r){let t=50;t+=15*s.length,"after"===r&&(t+=10);const o=e.getMonth();return 11!==o&&0!==o||(t+=20),o>=5&&o<=7&&(t+=15),o>=2&&o<=4&&(t+=10),1===o&&(t-=5),Math.min(100,t)}function Ko(e){const a=e.getMonth();return a>=0&&a<=5?"primeiro-semestre":a>=6&&a<=11?"segundo-semestre":11===a||0===a?"virada-ano":1===a||2===a?"carnaval":5===a||6===a?"junho-julho":"custom"}const Yo=ja,Wo=ba,Zo=va,ei=({year:s=(new Date).getFullYear(),onSelectSuggestion:r})=>{Be();const{data:t=[],isLoading:o,error:i}=$o(s),{generateAISuggestions:n,isLoading:l}=(()=>{const[a,s]=e.useState(!1),[r,t]=e.useState(null);return{generateAISuggestions:async e=>{s(!0),t(null);try{const{data:a,error:s}=await dr.functions.invoke("generate-vacation-suggestions",{body:{year:e}});if(s)throw new Error(s.message||"Erro ao gerar sugestões com IA");if(a.error)throw new Error(a.error);const r=a;if(!r.suggestions||0===r.suggestions.length)throw new Error("Nenhuma sugestão foi gerada pela IA");return Cs.success(`✨ IA gerou ${r.suggestions.length} sugestões inteligentes de férias!`,{description:"Sugestões baseadas nos feriados oficiais e estratégias de otimização"}),r.suggestions}catch(a){const e=a instanceof Error?a.message:"Erro desconhecido";throw t(e),e.includes("OPENAI_API_KEY")?Cs.error("🔑 OpenAI não configurada",{description:"Configure a chave da OpenAI nas Edge Functions do Supabase"}):e.includes("Rate limit")?Cs.error("⏱️ Limite de uso atingido",{description:"Aguarde alguns minutos antes de tentar novamente"}):Cs.error("❌ Erro ao gerar sugestões com IA",{description:e}),a}finally{s(!1)}},isLoading:a,error:r}})(),[d,c]=e.useState(null),[m,u]=e.useState([]),[x,g]=e.useState(!1);if(i)return a.jsxs(nt,{className:"shadow-lg",children:[a.jsx(lt,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:a.jsxs(dt,{className:"flex items-center gap-2",children:[a.jsx(Oe,{className:"h-5 w-5"}),"IA de Férias Inteligentes"]})}),a.jsx(mt,{className:"p-6",children:a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx(le,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"Erro ao carregar sugestões de IA"}),a.jsx("p",{className:"text-sm",children:"Tente novamente mais tarde"}),i.message&&i.message.includes("401")&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Erro de autenticação na API (verifique a chave da OpenAI)"})]})})]});const p=e=>{switch(e){case"virada-ano":return a.jsx(D,{className:"h-4 w-4"});case"carnaval":return a.jsx(la,{className:"h-4 w-4"});case"junho-julho":return a.jsx(Na,{className:"h-4 w-4"});default:return a.jsx(le,{className:"h-4 w-4"})}};return o?a.jsxs(nt,{className:"shadow-lg",children:[a.jsx(lt,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:a.jsxs(dt,{className:"flex items-center gap-2",children:[a.jsx(Oe,{className:"h-5 w-5 animate-pulse"}),"IA de Férias Inteligentes"]})}),a.jsx(mt,{className:"p-6",children:a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx(Oe,{className:"h-8 w-8 mx-auto mb-2 animate-pulse"}),a.jsx("p",{children:"Analisando feriados e gerando sugestões..."})]})})]}):a.jsxs(nt,{className:"shadow-lg",children:[a.jsxs(lt,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:[a.jsxs(dt,{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Oe,{className:"h-5 w-5"}),"IA de Férias Inteligentes ",s]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(cr,{onClick:async()=>{try{const e=await n(s);u(e),g(!0)}catch(e){}},disabled:l,size:"sm",className:"bg-white/20 hover:bg-white/30 text-white border-white/30",children:[l?a.jsx(Oe,{className:"h-4 w-4 mr-1 animate-pulse"}):a.jsx(Re,{className:"h-4 w-4 mr-1"}),l?"Gerando...":"IA OpenAI"]}),a.jsxs(mr,{variant:"secondary",className:"bg-white/20 text-white",children:[x?m.length:t.length," sugestões"]})]})]}),a.jsx("p",{className:"text-purple-100 text-sm",children:x?"Sugestões geradas pela IA OpenAI com base nos feriados oficiais":"Sugestões personalizadas baseadas nos feriados oficiais"})]}),a.jsxs(mt,{className:"p-6 space-y-4",children:[x&&m.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Re,{className:"h-4 w-4 text-blue-600"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Sugestões da IA OpenAI"}),a.jsx(mr,{className:"bg-blue-100 text-blue-800 text-xs",children:"Novo"})]}),a.jsx(cr,{onClick:()=>g(!1),variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800",children:"Ver sugestões padrão"})]})}),0===(x?m:t).length?a.jsxs("div",{className:"text-center text-gray-500 py-8",children:[a.jsx(le,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium mb-2",children:"Nenhuma sugestão disponível"}),a.jsx("p",{className:"text-sm",children:x?'Clique em "IA OpenAI" para gerar sugestões inteligentes':`Adicione feriados para ${s} para receber sugestões personalizadas`})]}):a.jsx("div",{className:"space-y-3",children:(x?m:t).map(e=>{return a.jsx(Yo,{open:d===e.id,onOpenChange:a=>c(a?e.id:null),children:a.jsxs(nt,{className:"hover:shadow-md transition-shadow duration-200 border-l-4 border-l-purple-500",children:[a.jsx(Wo,{asChild:!0,children:a.jsx(lt,{className:"pb-3 cursor-pointer hover:bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p(e.period),a.jsx("span",{className:"font-semibold text-gray-900",children:e.startDate&&e.endDate?a.jsxs(a.Fragment,{children:[ks(new Date(e.startDate),"dd MMM",{locale:Es})," - "," ",ks(new Date(e.endDate),"dd MMM",{locale:Es})]}):"Datas inválidas"}),a.jsxs(mr,{className:(t=e.score,t>=85?"bg-emerald-100 text-emerald-800 border-emerald-200":t>=70?"bg-blue-100 text-blue-800 border-blue-200":t>=55?"bg-amber-100 text-amber-800 border-amber-200":"bg-gray-100 text-gray-800 border-gray-200"),children:[a.jsx(Ke,{className:"h-3 w-3 mr-1"}),e.score,"%"]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.reason}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(le,{className:"h-3 w-3"}),e.totalDays," dias"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"h-3 w-3"}),e.workDays," dias úteis"]}),a.jsx(mr,{variant:"outline",className:"text-xs",children:(s=e.period,{"primeiro-semestre":"1º Semestre","segundo-semestre":"2º Semestre","virada-ano":"Virada de Ano",carnaval:"Carnaval","junho-julho":"Férias de Inverno",custom:"Personalizado"}[s])})]})]}),a.jsx(Ue,{className:"h-4 w-4 text-gray-400"})]})})}),a.jsx(Zo,{children:a.jsx(mt,{className:"pt-0 pb-4",children:a.jsxs("div",{className:"space-y-4",children:[e.holidays.length>0&&a.jsxs("div",{children:[a.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-2 flex items-center gap-1",children:[a.jsx(la,{className:"h-4 w-4 text-orange-500"}),"Feriados Relacionados"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.holidays.map((e,s)=>a.jsx(mr,{variant:"secondary",className:"text-xs",children:e},s))})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-2 flex items-center gap-1",children:[a.jsx(D,{className:"h-4 w-4 text-purple-500"}),"Vantagens deste período"]}),a.jsx("ul",{className:"space-y-1",children:e.benefits.map((e,s)=>a.jsxs("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-400 mt-2 flex-shrink-0"}),e]},s))})]}),a.jsx("div",{className:"flex gap-2 pt-2",children:a.jsxs(cr,{onClick:()=>r?.(e),size:"sm",className:"bg-purple-600 hover:bg-purple-700",children:[a.jsx(le,{className:"h-3 w-3 mr-1"}),"Marcar no Calendário"]})})]})})})]})},e.id);var s,t})}),a.jsx("div",{className:"mt-6 p-4 bg-purple-50 rounded-lg border border-purple-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Oe,{className:"h-5 w-5 text-purple-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Dica da IA"}),a.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"As sugestões são calculadas considerando proximidade com feriados, economia em viagens e melhor aproveitamento do tempo de descanso."})]})]})})]})]})},ai=[{value:"curso",label:"Curso",icon:a.jsx(aa,{className:"h-4 w-4 mr-1 text-blue-600"})},{value:"webinario",label:"Webinário",icon:a.jsx(sa,{className:"h-4 w-4 mr-1 text-purple-600"})},{value:"reuniao",label:"Reunião",icon:a.jsx(ra,{className:"h-4 w-4 mr-1 text-green-600"})},{value:"outro",label:"Outro",icon:a.jsx(D,{className:"h-4 w-4 mr-1 text-amber-600"})}];function si({onAdd:s}){const[r,t]=e.useState(!1),[o,i]=e.useState(""),[n,l]=e.useState("curso"),[d,c]=e.useState(""),[m,u]=e.useState(""),[x,h]=e.useState(""),[g,p]=e.useState(""),[f,j]=e.useState(""),[b,v]=e.useState(!1);return a.jsxs(wr,{open:r,onOpenChange:t,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"flex items-center gap-2 text-sm font-medium px-3 py-2 bg-gradient-to-r from-green-50 to-emerald-50 border-green-200 hover:from-green-100 hover:to-emerald-100 hover:border-green-300 transition-all duration-200 shadow-sm hover:shadow-md text-green-700 hover:text-green-800",children:[a.jsx(S,{className:"h-4 w-4"}),"Adicionar Evento"]})}),a.jsxs(yr,{className:"max-w-md w-full",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(le,{className:"h-5 w-5 text-primary"}),"Novo Evento Personalizado"]})}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!o||!d)return void Cs.error("Preencha todos os campos obrigatórios");if(!/^\d{4}-\d{2}-\d{2}$/.test(o))return void Cs.error("Formato de data inválido. Use o formato YYYY-MM-DD");const a=new Date(o),r=new Date;if(r.setHours(0,0,0,0),a<r)Cs.error("Não é possível criar eventos para datas passadas");else{v(!0);try{await s({date:o,type:n,title:d,description:m||void 0,start_time:x||void 0,end_time:g||void 0,url:f||void 0}),t(!1),i(""),l("curso"),c(""),u(""),h(""),p(""),j("")}catch(b){}finally{v(!1)}}},className:"space-y-4 mt-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Data"}),a.jsx(Sr,{type:"date",value:o,onChange:e=>i(e.target.value),required:!0,min:ks(new Date,"yyyy-MM-dd")})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Horário de Início (opcional)"}),a.jsx(Sr,{type:"time",value:x,onChange:e=>h(e.target.value),placeholder:"HH:MM"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Horário de Fim (opcional)"}),a.jsx(Sr,{type:"time",value:g,onChange:e=>p(e.target.value),placeholder:"HH:MM"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tipo"}),a.jsx("div",{className:"flex gap-2",children:ai.map(e=>a.jsxs(cr,{type:"button",variant:n===e.value?"default":"outline",className:"flex items-center gap-1 px-3 py-1 text-xs "+(n===e.value?"":"bg-white"),onClick:()=>l(e.value),children:[e.icon,e.label]},e.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Título"}),a.jsx(Sr,{value:d,onChange:e=>c(e.target.value),required:!0,maxLength:64,placeholder:"Ex: Curso de Atualização"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descrição (opcional)"}),a.jsx(Nt,{value:m,onChange:e=>u(e.target.value),maxLength:256,placeholder:"Detalhes, local, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Link/URL (opcional)"}),a.jsx(Sr,{value:f,onChange:e=>j(e.target.value),type:"url",placeholder:"https://exemplo.com"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(cr,{type:"submit",disabled:b||!o||!d,className:"bg-primary text-white hover:bg-primary/90",children:b?"Salvando...":"Salvar Evento"})})]})]})]})}const ri={presencial:{label:"Presencial",color:"#f5e7c4",icon:a.jsx(wa,{className:"h-5 w-5 text-[#8b7355] drop-shadow-sm"})},ferias:{label:"Férias",color:"#ffe6e6",icon:a.jsx(ya,{className:"h-5 w-5 text-[#d4756b] drop-shadow-sm"})},remoto:{label:"Remoto",color:"#e6f7ff",icon:a.jsx(Ca,{className:"h-5 w-5 text-[#5ba3d4] drop-shadow-sm"})},plantao:{label:"Plantão",color:"#e6ffe6",icon:a.jsx(ka,{className:"h-5 w-5 text-[#2e7d32] drop-shadow-sm"})},folga:{label:"Folga",color:"#e0e0e0",icon:a.jsx(ya,{className:"h-5 w-5 text-[#424242] drop-shadow-sm"})},none:{label:"",color:"#fff",icon:null}};function ti(){const s=new Date,[r,t]=e.useState(s),[o,i]=e.useState(!1),[n,l]=e.useState(null),[d,c]=e.useState(!1),[m,u]=e.useState(null),{marks:x,saveMark:h,removeMark:g}=(a=>{const{user:s}=tt(),[r,t]=e.useState({}),[o,i]=e.useState(!1),[n,l]=e.useState(null),d=e.useCallback(async()=>{if(s&&!o){i(!0),l(null);try{const e=new Date(a.getFullYear(),a.getMonth(),1),r=new Date(a.getFullYear(),a.getMonth()+1,0),{data:o,error:i}=await dr.from("user_work_calendar").select("id, date, status").limit(1);if(i)throw new Error(`Problema na estrutura da tabela: ${i.message}`);const{data:n,error:l}=await dr.from("user_work_calendar").select("id, date, status").eq("user_id",s.id).gte("date",e.toISOString().slice(0,10)).lte("date",r.toISOString().slice(0,10));if(l)throw l;const d={};(n||[]).forEach(e=>{d[e.date]=e.status}),t(d)}catch(e){const a=e instanceof Error?e.message:"Erro ao buscar marcações";l(a),Cs.error("Erro ao carregar marcações do calendário",{description:a})}finally{i(!1)}}},[s,a.getFullYear(),a.getMonth()]),c=e.useCallback(async(e,a)=>{if(s){if(!o){t(s=>({...s,[e]:a})),i(!0),l(null);try{const{data:r,error:t}=await dr.from("user_work_calendar").upsert({user_id:s.id,date:e,status:a,updated_at:(new Date).toISOString()},{onConflict:"user_id, date"}).select("id, date, status");if(t)throw t;const o={presencial:"Presencial",ferias:"Férias",remoto:"Remoto",folga:"Folga",plantao:"Plantão"};Cs.success(`${o[a]} marcado!`,{description:`Data: ${ks(new Date(e),"dd/MM/yyyy")}`})}catch(r){const a=r instanceof Error?r.message:"Erro ao salvar marcação";l(a),t(a=>{const s={...a};return delete s[e],s}),Cs.error("Erro ao salvar modalidade",{description:a})}finally{i(!1)}}}else Cs.error("Usuário não autenticado")},[s]),m=e.useCallback(async e=>{if(!s)return void Cs.error("Usuário não autenticado");if(o)return;const a=r[e];t(a=>{const s={...a};return delete s[e],s}),i(!0),l(null);try{const{error:a}=await dr.from("user_work_calendar").delete().eq("user_id",s.id).eq("date",e);if(a)throw a;Cs.success("Modalidade removida!",{description:`Data: ${ks(new Date(e),"dd/MM/yyyy")}`})}catch(n){const s=n instanceof Error?n.message:"Erro ao remover marcação";l(s),a&&t(s=>({...s,[e]:a})),Cs.error("Erro ao remover modalidade",{description:s})}finally{i(!1)}},[s,r]),u=a.getFullYear(),x=a.getMonth();return e.useEffect(()=>{s&&d()},[s,u,x,d]),{marks:r,loading:o,error:n,fetchMarks:d,saveMark:c,removeMark:m}})(r),{customEvents:p,addCustomEvent:j,updateCustomEvent:b,removeCustomEvent:v}=zo(r),{data:N=[],isLoading:w}=(e=>{const a=_s(e),s=Ps(e),r=ks(a,"yyyy-MM-dd"),t=ks(s,"yyyy-MM-dd");return f({queryKey:["calendar-events",ks(e,"yyyy-MM")],queryFn:async()=>{const a=[],{data:s,error:o}=await dr.from("feriados").select("*").gte("data",r).lte("data",t);o||s?.forEach(e=>{a.push({id:e.id,date:e.data,title:e.descricao,type:"feriado",description:e.tipo})});const{data:i,error:n}=await dr.from("aniversariantes").select("*");if(n);else{const s=e.getFullYear(),r=e.getMonth()+1;i?.forEach(e=>{if(!e.data_nascimento)return;const t=new Date(e.data_nascimento);if(isNaN(t.getTime()))return;const o=t.getMonth()+1,i=t.getDate();if(o===r){const r=`${s}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}`;a.push({id:e.id+1e4,date:r,title:e.nome,type:"aniversario"})}})}return a}})})(r),y=$s({start:_s(r),end:Ps(r)}),C=N.reduce((e,a)=>(e[a.date]||(e[a.date]=[]),e[a.date].push(a),e),{});return a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"bg-[#f8f5e4] border border-[#e2d8b8] rounded-xl shadow-sm p-6 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{className:"font-semibold text-[#7c6a3c] text-xl flex items-center gap-2",children:[a.jsx(le,{className:"h-6 w-6 text-[#bfae7c]"}),"Meu Calendário de Trabalho"]}),a.jsx("span",{className:"text-[#bfae7c] text-base",children:ks(r,"MMMM yyyy",{locale:Es})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(si,{onAdd:async e=>{await j(e)}}),a.jsx(cr,{size:"sm",variant:"outline",className:"px-3 py-2 hover:bg-gray-50 transition-colors",onClick:()=>t(Ds(r,-30)),children:"Anterior"}),a.jsx(cr,{size:"sm",variant:"outline",className:"px-3 py-2 hover:bg-gray-50 transition-colors",onClick:()=>t(Ds(r,30)),children:"Próximo"}),a.jsxs(cr,{size:"sm",variant:o?"default":"outline",className:"px-3 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white hover:from-purple-700 hover:to-blue-700 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>i(!o),title:"Sugestões inteligentes de férias com IA",children:[a.jsx(Oe,{className:"h-4 w-4 mr-1"}),"IA Férias"]})]})]}),a.jsxs("div",{className:"grid grid-cols-7 gap-2 mb-4",children:[["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(e=>a.jsx("div",{className:"text-[#bfae7c] font-semibold text-center py-2 text-sm",children:e},e)),Array(y[0].getDay()).fill(null).map((e,s)=>a.jsx("div",{},"empty-"+s)),y.map(e=>{const s=ks(e,"yyyy-MM-dd"),r=x[s],t=Rs(e),o=C[s]||[],i=o.some(e=>"feriado"===e.type),n=o.some(e=>"aniversario"===e.type),d="plantao"===r,m="folga"===r,u=p.filter(e=>e.date===s);let f=r?ri[r].color:ri.presencial.color;i&&n?f="linear-gradient(45deg, #ffeb3b 50%, #ff9800 50%)":i?f="#ffeb3b":n&&(f="#ff9800");let j="";i?j="animate-pulse-slow bg-yellow-100":d?j="animate-bounce-slow bg-green-100":m?j="animate-fade-slow bg-gray-200":n&&(j="animate-bounce-slow bg-orange-100");const b=o.map(e=>e.title).join("\n"),N=[r?ri[r].label:"",b].filter(Boolean).join("\n"),w={curso:a.jsx(aa,{className:"h-4 w-4 text-blue-700 drop-shadow-sm"}),webinario:a.jsx(sa,{className:"h-4 w-4 text-purple-700 drop-shadow-sm"}),reuniao:a.jsx(ra,{className:"h-4 w-4 text-green-700 drop-shadow-sm"}),outro:a.jsx(D,{className:"h-4 w-4 text-amber-700 drop-shadow-sm"})};return a.jsx(Wr,{children:a.jsxs(Zr,{children:[a.jsx(et,{asChild:!0,children:a.jsxs("button",{onClick:()=>(e=>{const a=ks(e,"yyyy-MM-dd"),s=x[a]||null,r=C[a]||[],t=0===e.getDay()||6===e.getDay(),o=r.some(e=>"feriado"===e.type),i=null===s?"presencial":"presencial"===s?"ferias":"ferias"===s?"remoto":"remoto"===s?"folga":"folga"===s?"plantao":null;if(null===i)g(a);else{if((t||o)&&"plantao"!==i)return void Cs.warning("Em finais de semana e feriados só é permitido marcar Plantão.");h(a,i)}})(e),className:`rounded-lg border border-[#e2d8b8] flex flex-col items-center justify-center h-16 w-full transition-all duration-150 focus:outline-none hover:shadow-md relative ${t?"ring-2 ring-[#bfae7c]":""} ${j}`,style:{background:f},title:N,children:[a.jsx("span",{className:"font-semibold text-[#7c6a3c] text-base",children:e.getDate()}),a.jsxs("div",{className:"flex gap-1 absolute bottom-1 left-1",children:[i&&a.jsx("div",{className:"bg-white/90 rounded-full p-1 shadow-md",children:a.jsx(Ke,{className:"h-4 w-4 text-amber-600 drop-shadow-sm"})}),n&&a.jsx("div",{className:"bg-white/90 rounded-full p-1 shadow-md",children:a.jsx(la,{className:"h-4 w-4 text-orange-600 drop-shadow-sm"})}),u.map(e=>a.jsxs("span",{title:e.title,className:"relative group",children:[a.jsx("div",{className:"bg-white/90 rounded-full p-1 shadow-md",children:w[e.type]}),a.jsx("div",{className:"hidden group-hover:block absolute z-50 left-6 top-0 bg-white text-xs text-gray-700 rounded shadow border border-gray-200 min-w-[160px]",children:a.jsxs("div",{className:"p-2",children:[a.jsx("div",{className:"font-semibold mb-1",children:e.title}),e.description&&a.jsx("div",{className:"mb-2 text-gray-600",children:e.description}),a.jsxs("div",{className:"flex gap-1 pt-1 border-t",children:[a.jsxs("button",{onClick:a=>{a.stopPropagation(),l(e),c(!0)},className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition-colors",title:"Editar evento",children:[a.jsx(Me,{className:"h-3 w-3"}),"Editar"]}),a.jsxs("button",{onClick:a=>{a.stopPropagation(),(async(e,a)=>{if(confirm(`Tem certeza que deseja excluir o evento "${a}"?`))try{await v(e),Cs.success("Evento excluído com sucesso!")}catch(s){Cs.error("Erro ao excluir evento")}})(e.id,e.title)},className:"flex items-center gap-1 px-2 py-1 text-xs bg-red-50 text-red-600 rounded hover:bg-red-100 transition-colors",title:"Excluir evento",children:[a.jsx(P,{className:"h-3 w-3"}),"Excluir"]})]})]})})]},e.id))]}),r&&a.jsx("div",{className:"absolute bottom-1 right-1",children:a.jsx("div",{className:"bg-white/90 rounded-full p-1 shadow-md",children:ri[r].icon})})]})}),o.length>0&&a.jsx(at,{children:a.jsxs("div",{className:"space-y-1",children:[o.map((e,s)=>a.jsxs("div",{className:"flex items-center gap-2",children:["feriado"===e.type?a.jsx(Ke,{className:"h-3 w-3 text-amber-500"}):a.jsx(la,{className:"h-3 w-3 text-orange-500"}),a.jsx("span",{className:"text-sm",children:e.title})]},s)),u.map(e=>a.jsxs("div",{className:"flex items-center gap-2",children:[w[e.type],a.jsx("span",{className:"text-sm font-semibold",children:e.title}),e.description&&a.jsx("span",{className:"text-xs text-gray-500",children:e.description})]},e.id))]})})]})},s)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm bg-white/70 dark:bg-gray-800/80 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-semibold text-[#7c6a3c] dark:text-amber-300 text-sm",children:"Modalidade de Trabalho"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#f5e7c4] dark:bg-amber-200 border border-[#e2d8b8] dark:border-amber-300 shadow-sm"}),a.jsx(wa,{className:"h-5 w-5 text-amber-700 dark:text-amber-400 drop-shadow-sm"}),"Presencial (TRT15)"]}),a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#ffe6e6] dark:bg-red-200 border border-[#e2d8b8] dark:border-red-300 shadow-sm"}),a.jsx(ya,{className:"h-5 w-5 text-red-600 dark:text-red-400 drop-shadow-sm"}),"Férias"]}),a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#e6f7ff] dark:bg-blue-200 border border-[#e2d8b8] dark:border-blue-300 shadow-sm"}),a.jsx(Ca,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 drop-shadow-sm"}),"Home Office"]}),a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#e6ffe6] dark:bg-green-200 border border-[#e2d8b8] dark:border-green-300 shadow-sm"}),a.jsx(ka,{className:"h-5 w-5 text-green-600 dark:text-green-400 drop-shadow-sm"}),"Plantão"]}),a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#e0e0e0] dark:bg-gray-300 border border-[#e2d8b8] dark:border-gray-400 shadow-sm"}),a.jsx(ya,{className:"h-5 w-5 text-gray-600 dark:text-gray-400 drop-shadow-sm"}),"Folga"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-semibold text-[#7c6a3c] dark:text-amber-300 text-sm",children:"Eventos"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#ffeb3b] dark:bg-yellow-300 border border-[#e2d8b8] dark:border-yellow-400 shadow-sm"}),a.jsx("div",{className:"bg-white/90 dark:bg-gray-700/90 rounded-full p-1 shadow-sm",children:a.jsx(Ke,{className:"h-4 w-4 text-amber-600 dark:text-yellow-400 drop-shadow-sm"})}),"Feriados"]}),a.jsxs("span",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[a.jsx("span",{className:"inline-block w-4 h-4 rounded bg-[#ff9800] dark:bg-orange-300 border border-[#e2d8b8] dark:border-orange-400 shadow-sm"}),a.jsx("div",{className:"bg-white/90 dark:bg-gray-700/90 rounded-full p-1 shadow-sm",children:a.jsx(la,{className:"h-4 w-4 text-orange-600 dark:text-orange-400 drop-shadow-sm"})}),"Aniversários"]})]})]})]}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx("div",{className:"text-center text-sm text-[#bfae7c]",children:a.jsx("p",{children:"Clique nos dias para marcar seu tipo de trabalho"})}),N.length>0&&a.jsx("div",{className:"text-center text-xs text-[#bfae7c] bg-white/30 p-2 rounded",children:a.jsxs("span",{className:"font-medium",children:[N.filter(e=>"feriado"===e.type).length," feriado(s) e ",N.filter(e=>"aniversario"===e.type).length," aniversário(s) este mês"]})}),w&&a.jsx("div",{className:"text-center text-xs text-[#bfae7c]",children:a.jsx("span",{children:"Carregando eventos..."})})]})]}),a.jsx(Mo,{isOpen:d,onOpenChange:c,event:n,onUpdate:b}),a.jsx("div",{className:"fixed top-4 right-4 w-96 max-h-[90vh] overflow-hidden transition-all duration-500 ease-in-out z-50 "+(o?"transform translate-x-0 opacity-100":"transform translate-x-full opacity-0 pointer-events-none"),children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200",children:[a.jsxs("div",{className:"p-4 border-b bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-t-xl",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5"}),a.jsx("span",{className:"font-semibold",children:"Assistente de Férias"})]}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>i(!1),className:"text-white hover:bg-white/20",children:"×"})]}),a.jsxs("p",{className:"text-sm text-purple-100 mt-1",children:["Sugestões inteligentes para ",r.getFullYear()]})]}),a.jsx("div",{className:"max-h-[calc(90vh-8rem)] overflow-y-auto p-4",children:a.jsx(ei,{year:r.getFullYear(),onSelectSuggestion:e=>{try{if(!e||!e.startDate||!e.endDate)return void Cs.error("Erro: dados da sugestão de férias são inválidos");const a=new Date(e.startDate),s=new Date(e.endDate);if(isNaN(a.getTime())||isNaN(s.getTime()))return void Cs.error("Erro: datas da sugestão são inválidas");let o=new Date(a);for(;o<=s;){const e=ks(o,"yyyy-MM-dd");h(e,"ferias"),o=Ds(o,1)}a.getMonth()===r.getMonth()&&a.getFullYear()===r.getFullYear()||t(a),i(!1)}catch(a){Cs.error("Erro ao aplicar sugestão de férias")}}})})]})})]})}const oi=()=>{const e=F();return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-4",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx(Lo,{title:"Calendário de Trabalho",subtitle:"Organize sua agenda de trabalho presencial, remoto e férias"}),a.jsx("div",{className:"mb-6",children:a.jsxs(cr,{onClick:()=>e("/"),variant:"outline",className:"flex items-center gap-2",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar ao Dashboard"]})}),a.jsx(ti,{})]})})},ii=["1º Grau","2º Grau"],ni=[{codigo:"1",nome:"1ª Vara do Trabalho de Campinas"},{codigo:"2",nome:"1ª Vara do Trabalho de Jundiaí"},{codigo:"3",nome:"1ª Vara do Trabalho de Sorocaba"},{codigo:"4",nome:"1ª Vara do Trabalho de Ribeirão Preto"},{codigo:"5",nome:"1ª Vara do Trabalho de Bauru"},{codigo:"6",nome:"1ª Vara do Trabalho de Araraquara"},{codigo:"7",nome:"1ª Vara do Trabalho de Americana"},{codigo:"8",nome:"1ª Vara do Trabalho de São Carlos"},{codigo:"9",nome:"1ª Vara do Trabalho de Taubaté"},{codigo:"10",nome:"Vara do Trabalho de Rio Claro"},{codigo:"11",nome:"Vara do Trabalho de Barretos"},{codigo:"12",nome:"1ª Vara do Trabalho de Piracicaba"},{codigo:"13",nome:"1ª Vara do Trabalho de São José dos Campos"},{codigo:"14",nome:"1ª Vara do Trabalho de Limeira"},{codigo:"15",nome:"1ª Vara do Trabalho de Franca"},{codigo:"16",nome:"2ª Vara do Trabalho de Sorocaba"},{codigo:"17",nome:"1ª Vara do Trabalho de São José do Rio Preto"},{codigo:"18",nome:"Vara do Trabalho de Itu"},{codigo:"19",nome:"1ª Vara do Trabalho de Araçatuba"},{codigo:"20",nome:"Vara do Trabalho de Guaratinguetá"},{codigo:"21",nome:"2ª Vara do Trabalho de Jundiaí"},{codigo:"22",nome:"Vara do Trabalho de Mogi Mirim"},{codigo:"23",nome:"1ª Vara do Trabalho de Jacareí"},{codigo:"24",nome:"1ª Vara do Trabalho de Jaú"},{codigo:"25",nome:"Vara do Trabalho de Botucatu"},{codigo:"26",nome:"1ª Vara do Trabalho de Presidente Prudente"},{codigo:"27",nome:"Vara do Trabalho de Votuporanga"},{codigo:"28",nome:"1ª Vara do Trabalho de Catanduva"},{codigo:"29",nome:"1ª Vara do Trabalho de Jaboticabal"},{codigo:"30",nome:"Vara do Trabalho de Ourinhos"},{codigo:"31",nome:"Vara do Trabalho de Avaré"},{codigo:"32",nome:"2ª Vara do Trabalho de Campinas"},{codigo:"33",nome:"1ª Vara do Trabalho de Marília"},{codigo:"34",nome:"Vara do Trabalho de São João da Boa Vista"},{codigo:"35",nome:"Vara do Trabalho de São José do Rio Pardo"},{codigo:"36",nome:"1ª Vara do Trabalho de Assis"},{codigo:"37",nome:"Vara do Trabalho de Fernandópolis"},{codigo:"38",nome:"Vara do Trabalho de Bragança Paulista"},{codigo:"39",nome:"Vara do Trabalho de Capivari"},{codigo:"40",nome:"Vara do Trabalho de Cruzeiro"},{codigo:"41",nome:"Vara do Trabalho de Itapetininga"},{codigo:"42",nome:"2ª Vara do Trabalho de Ribeirão Preto"},{codigo:"43",nome:"3ª Vara do Trabalho de Campinas"},{codigo:"44",nome:"2ª Vara do Trabalho de São José do Rio Preto"},{codigo:"45",nome:"2ª Vara do Trabalho de São José dos Campos"},{codigo:"46",nome:"Vara do Trabalho de Araras"},{codigo:"47",nome:"Vara do Trabalho de Itapeva"},{codigo:"48",nome:"Vara do Trabalho de Porto Ferreira"},{codigo:"49",nome:"Vara do Trabalho de Itápolis"},{codigo:"50",nome:"Vara do Trabalho de Dracena"},{codigo:"51",nome:"2ª Vara do Trabalho de Piracicaba"},{codigo:"52",nome:"Vara do Trabalho de Ituverava"},{codigo:"53",nome:"4ª Vara do Trabalho de Campinas"},{codigo:"54",nome:"1ª Vara do Trabalho de Sertãozinho"},{codigo:"55",nome:"2ª Vara do Trabalho de Jaú"},{codigo:"56",nome:"Vara do Trabalho de Andradina"},{codigo:"57",nome:"Vara do Trabalho de Presidente Venceslau"},{codigo:"58",nome:"Vara do Trabalho de Bebedouro"},{codigo:"59",nome:"Vara do Trabalho de Pindamonhangaba"},{codigo:"60",nome:"Vara do Trabalho de Amparo"},{codigo:"61",nome:"2ª Vara do Trabalho de Araçatuba"},{codigo:"62",nome:"Vara do Trabalho de Lins"},{codigo:"63",nome:"Vara do Trabalho de Caraguatatuba"},{codigo:"64",nome:"Vara do Trabalho de Itanhaém"},{codigo:"65",nome:"Vara do Trabalho de Tupã"},{codigo:"66",nome:"3ª Vara do Trabalho de Ribeirão Preto"},{codigo:"67",nome:"4ª Vara do Trabalho de Ribeirão Preto"},{codigo:"68",nome:"Vara do Trabalho de Adamantina"},{codigo:"69",nome:"Vara do Trabalho de Registro"},{codigo:"70",nome:"2ª Vara do Trabalho de Catanduva"},{codigo:"71",nome:"Vara do Trabalho de Mogi Guaçu"},{codigo:"72",nome:"Vara do Trabalho de Rancharia"},{codigo:"73",nome:"Vara do Trabalho de Birigui"},{codigo:"74",nome:"1ª Vara do Trabalho de Lençóis Paulista"},{codigo:"75",nome:"Vara do Trabalho de Batatais"},{codigo:"76",nome:"2ª Vara do Trabalho de Franca"},{codigo:"77",nome:"Vara do Trabalho de Indaiatuba"},{codigo:"78",nome:"Vara do Trabalho de Piedade"},{codigo:"79",nome:"2ª Vara do Trabalho de Araraquara"},{codigo:"80",nome:"Vara do Trabalho de Jales"},{codigo:"81",nome:"Vara do Trabalho de Matão"},{codigo:"82",nome:"3ª Vara do Trabalho de São José do Rio Preto"},{codigo:"83",nome:"3ª Vara do Trabalho de São José dos Campos"},{codigo:"84",nome:"4ª Vara do Trabalho de São José dos Campos"},{codigo:"85",nome:"Vara do Trabalho de Salto"},{codigo:"86",nome:"Vara do Trabalho de Santa Bárbara D'Oeste"},{codigo:"87",nome:"1ª Vara do Trabalho de Paulínia"},{codigo:"88",nome:"Vara do Trabalho de Lorena"},{codigo:"89",nome:"2ª Vara do Trabalho de Bauru"},{codigo:"90",nome:"3ª Vara do Trabalho de Bauru"},{codigo:"91",nome:"4ª Vara do Trabalho de Bauru"},{codigo:"92",nome:"5ª Vara do Trabalho de Campinas"},{codigo:"93",nome:"6ª Vara do Trabalho de Campinas"},{codigo:"94",nome:"7ª Vara do Trabalho de Campinas"},{codigo:"95",nome:"8ª Vara do Trabalho de Campinas"},{codigo:"96",nome:"3ª Vara do Trabalho de Jundiaí"},{codigo:"97",nome:"4ª Vara do Trabalho de Jundiaí"},{codigo:"98",nome:"Vara do Trabalho de Garça"},{codigo:"99",nome:"2ª Vara do Trabalho de Americana"},{codigo:"100",nome:"2ª Vara do Trabalho de Assis"},{codigo:"101",nome:"2ª Vara do Trabalho de Marília"},{codigo:"102",nome:"2ª Vara do Trabalho de Taubaté"},{codigo:"103",nome:"3ª Vara do Trabalho de Araçatuba"},{codigo:"104",nome:"Vara do Trabalho de Tanabi"},{codigo:"105",nome:"Vara do Trabalho de Campo Limpo Paulista"},{codigo:"106",nome:"2ª Vara do Trabalho de São Carlos"},{codigo:"107",nome:"Vara do Trabalho de Olímpia"},{codigo:"108",nome:"Vara do Trabalho de São Roque"},{codigo:"109",nome:"3ª Vara do Trabalho de Sorocaba"},{codigo:"110",nome:"Vara do Trabalho de José Bonifácio"},{codigo:"111",nome:"Vara do Trabalho de Tietê"},{codigo:"112",nome:"Vara do Trabalho de Cajuru"},{codigo:"113",nome:"5ª Vara do Trabalho de Ribeirão Preto"},{codigo:"114",nome:"9ª Vara do Trabalho de Campinas"},{codigo:"115",nome:"2ª Vara do Trabalho de Presidente Prudente"},{codigo:"116",nome:"Vara do Trabalho de Tatuí"},{codigo:"117",nome:"Vara do Trabalho de São Joaquim da Barra"},{codigo:"118",nome:"Vara do Trabalho de Itapira"},{codigo:"119",nome:"Vara do Trabalho de Caçapava"},{codigo:"120",nome:"2ª Vara do Trabalho de Jaboticabal"},{codigo:"121",nome:"Vara do Trabalho de São Sebastião"},{codigo:"122",nome:"Vara do Trabalho de Sumaré"},{codigo:"123",nome:"Vara do Trabalho de Capão Bonito"},{codigo:"124",nome:"Vara do Trabalho de Penápolis"},{codigo:"125",nome:"2ª Vara do Trabalho de Sertãozinho"},{codigo:"126",nome:"2ª Vara do Trabalho de Paulínia"},{codigo:"127",nome:"Vara do Trabalho de Teodoro Sampaio"},{codigo:"128",nome:"2ª Vara do Trabalho de Limeira"},{codigo:"129",nome:"10ª Vara do Trabalho de Campinas"},{codigo:"130",nome:"11ª Vara do Trabalho de Campinas"},{codigo:"131",nome:"12ª Vara do Trabalho de Campinas"},{codigo:"132",nome:"5ª Vara do Trabalho de São José dos Campos"},{codigo:"133",nome:"4ª Vara do Trabalho de São José do Rio Preto"},{codigo:"134",nome:"Vara do Trabalho de Leme"},{codigo:"135",nome:"4ª Vara do Trabalho de Sorocaba"},{codigo:"136",nome:"Vara do Trabalho de Pirassununga"},{codigo:"137",nome:"3ª Vara do Trabalho de Piracicaba"},{codigo:"138",nome:"2ª Vara do Trabalho de Jacareí"},{codigo:"139",nome:"Vara do Trabalho de Ubatuba"},{codigo:"140",nome:"Vara do Trabalho de Atibaia"},{codigo:"141",nome:"Vara do Trabalho de Mococa"},{codigo:"142",nome:"Vara do Trabalho de Taquaritinga"},{codigo:"143",nome:"Vara do Trabalho de Santa Cruz do Rio Pardo"},{codigo:"144",nome:"Vara do Trabalho de Pederneiras"},{codigo:"145",nome:"Vara do Trabalho de Itatiba"},{codigo:"146",nome:"Vara do Trabalho de Orlândia"},{codigo:"147",nome:"Vara do Trabalho de Aparecida"},{codigo:"148",nome:"Vara do Trabalho de Itararé"},{codigo:"149",nome:"2ª Vara do Trabalho de Lençóis Paulista"},{codigo:"150",nome:"Vara do Trabalho de Cravinhos"},{codigo:"151",nome:"3ª Vara do Trabalho de Araraquara"},{codigo:"152",nome:"Vara do Trabalho de Hortolândia"},{codigo:"153",nome:"6ª Vara do Trabalho de Ribeirão Preto"},{codigo:"188",nome:"5ª Vara do Trabalho de Jundiaí"},{codigo:"201",nome:"Corregedoria-Geral"},{codigo:"401",nome:"Divisão de Execução de Araçatuba"},{codigo:"402",nome:"DIVEX - Araraquara"},{codigo:"403",nome:"DIVEX - Bauru"},{codigo:"404",nome:"DIVEX - Campinas"},{codigo:"405",nome:"Divisão de Execução de Franca"},{codigo:"406",nome:"DIVEX - Jundiaí"},{codigo:"407",nome:"Divisão de Execução de Limeira"},{codigo:"408",nome:"DIVEX - Piracicaba"},{codigo:"409",nome:"DIVEX - Presidente Prudente"},{codigo:"410",nome:"DIVEX - Ribeirão Preto"},{codigo:"411",nome:"DIVEX - São José dos Campos"},{codigo:"412",nome:"DIVEX - São José do Rio Preto"},{codigo:"413",nome:"DIVEX - Sorocaba"},{codigo:"414",nome:"Divisão de Execução de Taubaté"},{codigo:"415",nome:"LIQ2 - Bauru"},{codigo:"416",nome:"LIQ1 - Campinas"},{codigo:"417",nome:"LIQ1 - São José do Rio Preto"},{codigo:"418",nome:"LIQ1 - Sorocaba"},{codigo:"419",nome:"CON2 - Bauru"},{codigo:"420",nome:"CON2 - Campinas"},{codigo:"421",nome:"CON2 - São José do Rio Preto"},{codigo:"422",nome:"CON2 - Sorocaba"},{codigo:"423",nome:"EXE2 - Bauru"},{codigo:"424",nome:"EXE1 - Campinas"},{codigo:"425",nome:"EXE1 - São José do Rio Preto"},{codigo:"426",nome:"EXE1 - Sorocaba"},{codigo:"427",nome:"EXE4 - Bauru"},{codigo:"428",nome:"EXE5 - Campinas"},{codigo:"429",nome:"EXE3 - São José do Rio Preto"},{codigo:"430",nome:"EXE2 - Sorocaba"},{codigo:"431",nome:"EXE3 - Campinas"},{codigo:"432",nome:"EXE4 - Campinas"},{codigo:"433",nome:"EXE1 - Jundiaí"},{codigo:"434",nome:"EXE2 - Jundiaí"},{codigo:"435",nome:"LIQ1 - Jundiaí"},{codigo:"436",nome:"CON1 - Jundiaí"},{codigo:"437",nome:"CON2 - Jundiaí"},{codigo:"438",nome:"EXE2 - Campinas"},{codigo:"439",nome:"CON1 - São José dos Campos"},{codigo:"440",nome:"EXE1 - São José dos Campos"},{codigo:"441",nome:"EXE2 - São José dos Campos"},{codigo:"442",nome:"EXE4 - São José dos Campos"},{codigo:"443",nome:"LIQ1 - São José dos Campos"},{codigo:"444",nome:"CON1 - Piracicaba"},{codigo:"445",nome:"EXE1 - Piracicaba"},{codigo:"446",nome:"LIQ1 - Piracicaba"},{codigo:"447",nome:"CON1 - Araraquara"},{codigo:"448",nome:"EXE1 - Araraquara"},{codigo:"449",nome:"LIQ2 - Araraquara"},{codigo:"450",nome:"CON2 - Ribeirão Preto"},{codigo:"451",nome:"LIQ1 - Ribeirão Preto"},{codigo:"453",nome:"EXE2 - São José do Rio Preto"},{codigo:"454",nome:"EXE6 - Campinas"},{codigo:"455",nome:"LIQ2 - Ribeirão Preto"},{codigo:"456",nome:"EXE4 - São José do Rio Preto"},{codigo:"457",nome:"CON1 - Ribeirão Preto"},{codigo:"458",nome:"EXE1 - Ribeirão Preto"},{codigo:"459",nome:"EXE2 - Ribeirão Preto"},{codigo:"460",nome:"EXE4 - Ribeirão Preto"},{codigo:"461",nome:"DAM - Araraquara"},{codigo:"462",nome:"DAM - Bauru"},{codigo:"463",nome:"DAM - Campinas"},{codigo:"464",nome:"DAM - Jundiaí"},{codigo:"465",nome:"DAM - Piracicaba"},{codigo:"466",nome:"DAM - Ribeirão Preto"},{codigo:"467",nome:"DAM - São José do Rio Preto"},{codigo:"468",nome:"DAM - São José dos Campos"},{codigo:"469",nome:"Divisão de Apoio aos Magistrados de Sertãozinho"},{codigo:"470",nome:"DAM - Sorocaba"},{codigo:"471",nome:"Assessoria de Execução I de Sertãozinho, Orlândia, Batatais e Franca"},{codigo:"472",nome:"Assessoria de Execução II de Sertãozinho, Orlândia, Batatais e Franca"},{codigo:"473",nome:"EXE3 - Ribeirão Preto"},{codigo:"474",nome:"EXE1 - Bauru"},{codigo:"475",nome:"EXE2 - Araraquara"},{codigo:"476",nome:"EXE3 - Araraquara"},{codigo:"477",nome:"EXE4 - Araraquara"},{codigo:"478",nome:"LIQ2 - Campinas"},{codigo:"479",nome:"EXE2 - Piracicaba"},{codigo:"480",nome:"EXE4 - Piracicaba"},{codigo:"481",nome:"CON1 - São José do Rio Preto"},{codigo:"482",nome:"LIQ2 - São José do Rio Preto"},{codigo:"483",nome:"EXE4 - Sorocaba"},{codigo:"484",nome:"LIQ2 - Piracicaba"},{codigo:"485",nome:"EXE3 - Piracicaba"},{codigo:"486",nome:"CON2 - Piracicaba"},{codigo:"487",nome:"EXE3 - Sorocaba"},{codigo:"488",nome:"LIQ2 - Sorocaba"},{codigo:"489",nome:"CON1 - Sorocaba"},{codigo:"490",nome:"CON2 - Araraquara"},{codigo:"491",nome:"LIQ1 - Araraquara"},{codigo:"492",nome:"CON1 - Bauru"},{codigo:"493",nome:"LIQ1 - Bauru"},{codigo:"494",nome:"EXE3 - Bauru"},{codigo:"495",nome:"CON1 - Campinas"},{codigo:"496",nome:"LIQ2 - Jundiaí"},{codigo:"497",nome:"EXE3 - Jundiaí"},{codigo:"498",nome:"EXE4 - Jundiaí"},{codigo:"499",nome:"CON2 - São José dos Campos"},{codigo:"500",nome:"EXE3 - São José dos Campos"},{codigo:"501",nome:"LIQ2 - São José dos Campos"},{codigo:"502",nome:"CON1 - Presidente Prudente"},{codigo:"503",nome:"CON2 - Presidente Prudente"},{codigo:"504",nome:"LIQ1 - Presidente Prudente"},{codigo:"505",nome:"LIQ2 - Presidente Prudente"},{codigo:"506",nome:"EXE1 - Presidente Prudente"},{codigo:"507",nome:"EXE2 - Presidente Prudente"},{codigo:"508",nome:"EXE3 - Presidente Prudente"},{codigo:"509",nome:"EXE4 - Presidente Prudente"},{codigo:"510",nome:"DAM - Presidente Prudente"},{codigo:"601",nome:"Órgão Centralizador de Leilões Judiciais de Araçatuba"},{codigo:"602",nome:"Órgão Centralizador de Leilões Judiciais de Araraquara"},{codigo:"603",nome:"Órgão Centralizador de Leilões Judiciais de Bauru"},{codigo:"604",nome:"Órgão Centralizador de Leilões Judiciais de Campinas"},{codigo:"605",nome:"Órgão Centralizador de Leilões Judiciais de Franca"},{codigo:"606",nome:"Órgão Centralizador de Leilões Judiciais de Jundiaí"},{codigo:"607",nome:"Órgão Centralizador de Leilões Judiciais de Limeira"},{codigo:"608",nome:"Órgão Centralizador de Leilões Judiciais de Piracicaba"},{codigo:"609",nome:"Órgão Centralizador de Leilões Judiciais de Presidente Prudente"},{codigo:"610",nome:"Órgão Centralizador de Leilões Judiciais de Ribeirão Preto"},{codigo:"611",nome:"Órgão Centralizador de Leilões Judiciais de São José do Rio Preto"},{codigo:"612",nome:"Órgão Centralizador de Leilões Judiciais de São José dos Campos"},{codigo:"613",nome:"Órgão Centralizador de Leilões Judiciais de Sorocaba"},{codigo:"614",nome:"Órgão Centralizador de Leilões Judiciais de Taubaté"},{codigo:"615",nome:"CEJUSC ARAÇATUBA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"616",nome:"CEJUSC BAURU - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"617",nome:"CEJUSC CAMPINAS - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"618",nome:"CEJUSC PRESIDENTE PRUDENTE - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"619",nome:"CEJUSC RIBEIRÃO PRETO - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"620",nome:"CEJUSC SJCAMPOS - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"621",nome:"CEJUSC SJRIO PRETO - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"622",nome:"CEJUSC SOROCABA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"623",nome:"CEJUSC ARARAQUARA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"624",nome:"CEJUSC FRANCA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"625",nome:"CEJUSC LIMEIRA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"626",nome:"CEJUSC PIRACICABA - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"627",nome:"CEJUSC JUNDIAÍ - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"628",nome:"CEJUSC TAUBATÉ - JT Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho"},{codigo:"629",nome:"Juizado Especial da Infância e Adolescência de Araçatuba"},{codigo:"630",nome:"Juizado Especial da Infância e Adolescência de Bauru"},{codigo:"631",nome:"Juizado Especial da Infância e Adolescência de Campinas"},{codigo:"632",nome:"Juizado Especial da Infância e Adolescência de Fernandópolis"},{codigo:"633",nome:"Juizado Especial da Infância e Adolescência de Franca"},{codigo:"634",nome:"Juizado Especial da Infância e Adolescência de Presidente Prudente"},{codigo:"635",nome:"Juizado Especial da Infância e Adolescência de Ribeirão Preto"},{codigo:"636",nome:"Juizado Especial da Infância e Adolescência de Sorocaba"},{codigo:"637",nome:"Juizado Especial da Infância e Adolescência de São José do Rio Preto"},{codigo:"638",nome:"Juizado Especial da Infância e Adolescência de São José dos Campos"},{codigo:"900",nome:"1º Núcleo de Justiça 4.0"},{codigo:"901",nome:"Posto Avançado da Justiça do Trabalho de Amparo em Pedreira"},{codigo:"902",nome:"Posto Avançado da Justiça do Trabalho de Andradina em Pereira Barreto"},{codigo:"903",nome:"Posto Avançado da Justiça do Trabalho de Araraquara em Américo Brasiliense"},{codigo:"904",nome:"Justiça Itinerante/Posto Avançado da Justiça do Trabalho de Ituverava em Igarapava"},{codigo:"905",nome:"Posto Avançado da Justiça do Trabalho de Jundiaí em Vinhedo"},{codigo:"906",nome:"Posto Avançado da Justiça do Trabalho de Orlândia em Morro Agudo"},{codigo:"907",nome:"Posto Avançado da Justiça do Trabalho de Pederneiras em Bariri"},{codigo:"908",nome:"Posto Avançado da Justiça do Trabalho de Pindamonhangaba em Campos do Jordão"},{codigo:"909",nome:"Posto Avançado da Justiça do Trabalho de São João da Boa Vista em Espírito Santo Do Pinhal"},{codigo:"910",nome:"Posto Avançado da Justiça do Trabalho de Campinas em Valinhos"},{codigo:"1000",nome:"Posto Avançado da Justiça do Trabalho da 15ª Região"},{codigo:"1901",nome:"CCP ARARAQUARA - Centro de Conciliação Pré Processual"},{codigo:"1902",nome:"CCP ARAÇATUBA - Centro de Conciliação Pré Processual"},{codigo:"1903",nome:"CCP BAURU - Centro de Conciliação Pré Processual"},{codigo:"1904",nome:"CCP CAMPINAS - Centro de Conciliação Pré Processual"},{codigo:"1905",nome:"CCP FRANCA - Centro de Conciliação Pré Processual"},{codigo:"1906",nome:"CCP JUNDIAÍ - Centro de Conciliação Pré Processual"},{codigo:"1907",nome:"CCP LIMEIRA - Centro de Conciliação Pré Processual"},{codigo:"1908",nome:"CCP PIRACICABA - Centro de Conciliação Pré Processual"},{codigo:"1909",nome:"CCP PRESIDENTE PRUDENTE - Centro de Conciliação Pré Processual"},{codigo:"1910",nome:"CCP RIBEIRÃO PRETO - Centro de Conciliação Pré Processual"},{codigo:"1911",nome:"CCP SOROCABA - Centro de Conciliação Pré Processual"},{codigo:"1912",nome:"CCP SÃO JOSÉ DO RIO PRETO - Centro de Conciliação Pré Processual"},{codigo:"1913",nome:"CCP SÃO JOSÉ DOS CAMPOS - Centro de Conciliação Pré Processual"},{codigo:"1914",nome:"CCP TAUBATÉ - Centro de Conciliação Pré Processual"},{codigo:"1915",nome:"CCP DE 2º GRAU - Centro de Conciliação Pré Processual"}],li=e=>{const a=(e=>{if(!e)return null;const a=e.replace(/[^\d.-]/g,"");if(!/^\d{7}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}$/.test(a))return null;const s=a.split(".");if(s.length>=5)return s[4];return null})(e);return a?(e=>{if(!e)return null;const a=parseInt(e,10).toString(),s=ni.find(e=>e.codigo===a);return s?s.nome:null})(a):null},di=e.forwardRef(({className:e,...s},r)=>a.jsx(Bs,{ref:r,className:lr("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...s}));di.displayName=Bs.displayName;const ci=e.forwardRef(({className:e,...s},r)=>a.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[a.jsx(ua,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx(Bs.Input,{ref:r,className:lr("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...s})]}));ci.displayName=Bs.Input.displayName;const mi=e.forwardRef(({className:e,...s},r)=>a.jsx(Bs.List,{ref:r,className:lr("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...s}));mi.displayName=Bs.List.displayName;const ui=e.forwardRef((e,s)=>a.jsx(Bs.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));ui.displayName=Bs.Empty.displayName;const xi=e.forwardRef(({className:e,...s},r)=>a.jsx(Bs.Group,{ref:r,className:lr("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...s}));xi.displayName=Bs.Group.displayName;e.forwardRef(({className:e,...s},r)=>a.jsx(Bs.Separator,{ref:r,className:lr("-mx-1 h-px bg-border",e),...s})).displayName=Bs.Separator.displayName;const hi=e.forwardRef(({className:e,...s},r)=>a.jsx(Bs.Item,{ref:r,className:lr("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...s}));hi.displayName=Bs.Item.displayName;const gi=({value:s,onValueChange:r,placeholder:t="Buscar órgão julgador por cidade ou nome...",orgaosJulgadores:o=[]})=>{const[i,n]=e.useState(!1),[l,d]=e.useState(""),[c,m]=e.useState([]);e.useEffect(()=>{if(l){const e=o.filter(e=>e.nome.toLowerCase().includes(l.toLowerCase())||e.codigo.toLowerCase().includes(l.toLowerCase())||u(e.nome).toLowerCase().includes(l.toLowerCase()));m(e)}else m(o.slice(0,50))},[l,o]);const u=e=>{let a=e;return a=a.replace(/^\d+ª?\s/,""),["Vara do Trabalho de ","ª Vara do Trabalho de ","º Vara do Trabalho de ","Órgão Centralizador de Leilões Judiciais de ","Centro de Conciliação Pré Processual ","Centro Judiciário de Métodos Consensuais de Solução de Disputas da Justiça do Trabalho ","Posto Avançado da Justiça do Trabalho de ","Posto Avançado da Justiça do Trabalho ","Juizado Especial da Infância e Adolescência de ","Divisão de Execução de ","CEJUSC ","CCP ","DIVEX - ","LIQ1 - ","LIQ2 - ","CON1 - ","CON2 - ","EXE1 - ","EXE2 - ","EXE3 - ","EXE4 - ","EXE5 - ","EXE6 - ","DAM - "].forEach(e=>{a.includes(e)&&(a=a.replace(e,""))}),a.includes(" em ")&&(a=a.split(" em ")[1]),a=a.replace(/ - JT.*$/,""),a.trim()},x=o.find(e=>e.nome===s);return a.jsxs(wt,{open:i,onOpenChange:n,children:[a.jsx(yt,{asChild:!0,children:a.jsxs(cr,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ua,{className:"h-4 w-4 mr-2 text-gray-500"}),x?a.jsx("span",{className:"truncate",children:x.nome}):a.jsx("span",{className:"text-gray-500",children:t})]}),a.jsx(Ea,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),a.jsx(Ct,{className:"w-full p-0",align:"start",children:a.jsxs(di,{children:[a.jsx(ci,{placeholder:"Digite o nome da cidade ou órgão...",value:l,onValueChange:d}),a.jsxs(mi,{children:[a.jsx(ui,{children:"Nenhum órgão julgador encontrado."}),c.length>0&&a.jsx(xi,{heading:"Órgãos Julgadores",children:c.map(e=>a.jsxs(hi,{value:`${e.codigo} - ${e.nome}`,onSelect:()=>{r(e.nome),n(!1)},children:[a.jsx(X,{className:lr("mr-2 h-4 w-4",s===e.nome?"opacity-100":"opacity-0")}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e.nome}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Código: ",e.codigo," | Cidade: ",u(e.nome)]})]})]},e.codigo))})]})]})})]})},pi=e=>{const{toast:a}=Vr(),s=Be(),r="1grau"===e?"orgaos_julgadores_1grau":"orgaos_julgadores_2grau",{data:t=[],isLoading:o,error:i}=f({queryKey:["orgaos-julgadores",e],queryFn:async()=>{try{const{data:a,error:s}=await dr.from(r).select("*").order("codigo",{ascending:!0});if(s)throw s;if(!a||0===a.length){const a="1grau"===e?ni.filter(e=>parseInt(e.codigo)<200):ni.filter(e=>parseInt(e.codigo)>=200);return a.map((a,s)=>({id:`fallback-${e}-${s}`,codigo:a.codigo,nome:a.nome,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}))}return a}catch(a){return("1grau"===e?ni.filter(e=>parseInt(e.codigo)<200):ni.filter(e=>parseInt(e.codigo)>=200)).map((a,s)=>({id:`fallback-${e}-${s}`,codigo:a.codigo,nome:a.nome,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}))}}});return{orgaos:t,isLoading:o,error:i,createOrgao:Ge({mutationFn:async e=>{const{data:a,error:s}=await dr.from(r).insert([e]).select().single();if(s)throw s;return a},onSuccess:()=>{s.invalidateQueries({queryKey:["orgaos-julgadores",e]}),a({title:"Sucesso!",description:"Órgão julgador criado com sucesso."})},onError:e=>{a({title:"Erro",description:e.message||"Erro ao criar órgão julgador.",variant:"destructive"})}}),updateOrgao:Ge({mutationFn:async({id:e,...a})=>{const{data:s,error:t}=await dr.from(r).update(a).eq("id",e).select().single();if(t)throw t;return s},onSuccess:()=>{s.invalidateQueries({queryKey:["orgaos-julgadores",e]}),a({title:"Sucesso!",description:"Órgão julgador atualizado com sucesso."})},onError:e=>{a({title:"Erro",description:e.message||"Erro ao atualizar órgão julgador.",variant:"destructive"})}}),deleteOrgao:Ge({mutationFn:async e=>{const{error:a}=await dr.from(r).delete().eq("id",e);if(a)throw a},onSuccess:()=>{s.invalidateQueries({queryKey:["orgaos-julgadores",e]}),a({title:"Sucesso!",description:"Órgão julgador excluído com sucesso."})},onError:e=>{a({title:"Erro",description:e.message||"Erro ao excluir órgão julgador.",variant:"destructive"})}})}},fi=({value:s,onValueChange:r,placeholder:t="Buscar órgão julgador de 2º grau..."})=>{const[o,i]=e.useState(!1),[n,l]=e.useState(""),{orgaos:d,isLoading:c}=pi("2grau"),[m,u]=e.useState([]);e.useEffect(()=>{if(n){const e=d.filter(e=>e.nome.toLowerCase().includes(n.toLowerCase())||e.codigo.toLowerCase().includes(n.toLowerCase()));u(e)}else u(d.slice(0,50))},[n,d]);const x=d.find(e=>e.nome===s);return a.jsxs(wt,{open:o,onOpenChange:i,children:[a.jsx(yt,{asChild:!0,children:a.jsxs(cr,{variant:"outline",role:"combobox","aria-expanded":o,className:"w-full justify-between",disabled:c,children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ua,{className:"h-4 w-4 mr-2 text-gray-500"}),x?a.jsx("span",{className:"truncate",children:x.nome}):a.jsx("span",{className:"text-gray-500",children:c?"Carregando...":t})]}),a.jsx(Ea,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),a.jsx(Ct,{className:"w-full p-0",align:"start",children:a.jsxs(di,{children:[a.jsx(ci,{placeholder:"Digite o nome ou código do órgão...",value:n,onValueChange:l}),a.jsxs(mi,{children:[a.jsx(ui,{children:c?"Carregando órgãos...":"Nenhum órgão julgador encontrado."}),m.length>0&&a.jsx(xi,{heading:"Órgãos Julgadores de 2º Grau",children:m.map(e=>a.jsxs(hi,{value:`${e.codigo} - ${e.nome}`,onSelect:()=>{r(e.nome),i(!1)},children:[a.jsx(X,{className:lr("mr-2 h-4 w-4",s===e.nome?"opacity-100":"opacity-0")}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e.nome}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Código: ",e.codigo]})]})]},e.id))})]})]})})]})},ji=()=>{const[a,s]=e.useState(!1);return{salvarUsuario:async(e,a,r)=>{if(!e||!a)return null;try{s(!0);const{data:t}=await dr.from("usuarios").select("id").eq("cpf",e).maybeSingle();if(t){const{data:s,error:t}=await dr.from("usuarios").update({nome_completo:a,perfil:r||null,updated_at:(new Date).toISOString()}).eq("cpf",e).select().single();if(t)throw t;return s}{const{data:s,error:t}=await dr.from("usuarios").insert({cpf:e,nome_completo:a,perfil:r||null}).select().single();if(t)throw t;return s}}catch(t){return Cs.error("Erro ao salvar dados do usuário"),null}finally{s(!1)}},buscarUsuarios:async e=>{if(!e||e.length<3)return[];try{const{data:a,error:s}=await dr.from("usuarios").select("id, cpf, nome_completo, perfil").or(`cpf.ilike.%${e}%,nome_completo.ilike.%${e}%`).order("nome_completo").limit(10);if(s)throw s;return a||[]}catch(a){return[]}},buscarUsuarioPorCPF:async e=>{if(!e)return null;try{const{data:a,error:s}=await dr.from("usuarios").select("id, cpf, nome_completo, perfil").eq("cpf",e).maybeSingle();if(s)throw s;return a}catch(a){return null}},loading:a}},bi=()=>{const[a,s]=e.useState(!1);return{buscarSugestoesOrgaoJulgador:async e=>{try{s(!0);const{data:a,error:r}=await dr.from("chamados").select("orgao_julgador, created_at").not("orgao_julgador","is",null).eq("grau",e).order("created_at",{ascending:!1}).limit(100);if(r)throw r;const t=new Map;return a?.forEach(e=>{const a=e.orgao_julgador,s=t.get(a)||{count:0,ultimoUso:e.created_at};t.set(a,{count:s.count+1,ultimoUso:e.created_at>s.ultimoUso?e.created_at:s.ultimoUso})}),Array.from(t.entries()).map(([e,{count:a,ultimoUso:s}])=>({valor:e,frequencia:a,ultimo_uso:s})).sort((e,a)=>a.frequencia-e.frequencia).slice(0,10)}catch(a){return[]}finally{s(!1)}},buscarSugestoesPerfil:async()=>{try{s(!0);const{data:e,error:a}=await dr.from("chamados").select("perfil_usuario_afetado, created_at").not("perfil_usuario_afetado","is",null).order("created_at",{ascending:!1}).limit(100);if(a)throw a;const r=new Map;return e?.forEach(e=>{const a=e.perfil_usuario_afetado,s=r.get(a)||{count:0,ultimoUso:e.created_at};r.set(a,{count:s.count+1,ultimoUso:e.created_at>s.ultimoUso?e.created_at:s.ultimoUso})}),Array.from(r.entries()).map(([e,{count:a,ultimoUso:s}])=>({valor:e,frequencia:a,ultimo_uso:s})).sort((e,a)=>a.frequencia-e.frequencia).slice(0,10)}catch(e){return[]}finally{s(!1)}},buscarSugestoesChamadoOrigem:async()=>{try{s(!0);const{data:e,error:a}=await dr.from("chamados").select("chamado_origem, created_at").not("chamado_origem","is",null).order("created_at",{ascending:!1}).limit(100);if(a)throw a;const r=new Map;return e?.forEach(e=>{const a=e.chamado_origem,s=r.get(a)||{count:0,ultimoUso:e.created_at};r.set(a,{count:s.count+1,ultimoUso:e.created_at>s.ultimoUso?e.created_at:s.ultimoUso})}),Array.from(r.entries()).map(([e,{count:a,ultimoUso:s}])=>({valor:e,frequencia:a,ultimo_uso:s})).sort((e,a)=>a.frequencia-e.frequencia).slice(0,10)}catch(e){return[]}finally{s(!1)}},buscarSugestoesResumo:async()=>{try{s(!0);const{data:e,error:a}=await dr.from("chamados").select("titulo, created_at").not("titulo","is",null).order("created_at",{ascending:!1}).limit(100);if(a)throw a;const r=new Map;return e?.forEach(e=>{const a=e.titulo,s=r.get(a)||{count:0,ultimoUso:e.created_at};r.set(a,{count:s.count+1,ultimoUso:e.created_at>s.ultimoUso?e.created_at:s.ultimoUso})}),Array.from(r.entries()).map(([e,{count:a,ultimoUso:s}])=>({valor:e,frequencia:a,ultimo_uso:s})).sort((e,a)=>a.frequencia-e.frequencia).slice(0,10)}catch(e){return[]}finally{s(!1)}},loading:a}},vi=({value:s,onChange:r,placeholder:t,sugestoes:o,loading:i=!1,className:n,id:l})=>{const[d,c]=e.useState(!1),[m,u]=e.useState([]),x=e.useRef(null),g=e.useRef(null);e.useEffect(()=>{if(s.trim()){const e=o.filter(e=>e.valor.toLowerCase().includes(s.toLowerCase()));u(e)}else u(o)},[s,o]),e.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return a.jsxs("div",{ref:g,className:"relative",children:[a.jsx(Sr,{ref:x,id:l,value:s,onChange:e=>r(e.target.value),onFocus:()=>{o.length>0&&c(!0)},onKeyDown:e=>{"Escape"===e.key&&c(!1)},placeholder:t,className:n}),d&&m.length>0&&a.jsx(nt,{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-y-auto shadow-lg",children:a.jsxs(mt,{className:"p-2",children:[a.jsx("div",{className:"space-y-1",children:m.map((e,s)=>a.jsx(cr,{variant:"ghost",className:"w-full justify-start h-auto p-3 text-left",onClick:()=>(e=>{r(e.valor),c(!1),x.current?.focus()})(e),children:a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-sm",children:e.valor}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ue,{className:"h-3 w-3"}),a.jsxs("span",{children:[e.frequencia,"x"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"h-3 w-3"}),a.jsx("span",{children:Gs(new Date(e.ultimo_uso),{addSuffix:!0,locale:Es})})]})]})]})})},s))}),i&&a.jsx("div",{className:"text-center py-2 text-sm text-muted-foreground",children:"Carregando sugestões..."})]})}),d&&0===m.length&&!i&&a.jsx(nt,{className:"absolute top-full left-0 right-0 z-50 mt-1 shadow-lg",children:a.jsx(mt,{className:"p-3",children:a.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Nenhuma sugestão encontrada"})})})]})},Ni=({formData:s,onInputChange:r})=>{const[t,o]=e.useState(!1),[i,n]=e.useState([]),[l,d]=e.useState([]),[c,m]=e.useState(!1),{buscarUsuarios:u,buscarUsuarioPorCPF:x}=ji(),{buscarSugestoesPerfil:h,loading:g}=bi(),{buscarDadosUsuarioPorCPF:p}=_t();e.useEffect(()=>{(async()=>{const e=await h();d(e)})()},[]),e.useEffect(()=>{!c||""!==s.nomeUsuario&&""!==s.perfilUsuario||m(!1)},[s.nomeUsuario,s.perfilUsuario,c]),e.useEffect(()=>{const e=setTimeout(async()=>{if(s.cpfUsuario.length>=3||s.nomeUsuario.length>=3){const e=s.cpfUsuario||s.nomeUsuario,a=(await u(e)).filter(e=>{const a=Tt(e.cpf),s=St(a);return At(s)});n(a),o(a.length>0)}else n([]),o(!1)},300);return()=>clearTimeout(e)},[s.cpfUsuario,s.nomeUsuario,u]);return a.jsxs("div",{className:"space-y-4 border-t pt-4 relative",children:[a.jsxs("h4",{className:"font-medium text-gray-700 flex items-center",children:[a.jsx(se,{className:"h-4 w-4 mr-2"}),"Dados do Usuário (Opcional)"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c&&a.jsx(ze,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-green-500"}),a.jsx(Sr,{value:s.cpfUsuario,onChange:e=>(async e=>{const a=e.replace(/\D/g,""),s=a.slice(0,11),t=St(s);if(r("cpfUsuario",t),!(a.length>11))if(11===s.length&&At(t)){const e=await x(t);if(e)return r("nomeUsuario",e.nome_completo||""),r("perfilUsuario",e.perfil||""),m(!0),n([]),void o(!1);const a=await p(t);a?(r("nomeUsuario",a.nome_usuario_afetado||""),r("perfilUsuario",a.perfil_usuario_afetado||""),m(!0),n([]),o(!1)):m(!1)}else m(!1)})(e.target.value),placeholder:"000.000.000-00",className:`pl-10 ${c?"border-green-500 bg-green-50":s.cpfUsuario&&!At(s.cpfUsuario)?"border-red-500":""} ${c?"pr-10":""}`,maxLength:14,autoComplete:"off"}),s.cpfUsuario&&!At(s.cpfUsuario)&&a.jsx("p",{className:"text-xs text-red-500 mt-1",children:"CPF inválido"}),c&&a.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Dados encontrados no banco de dados"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(Sr,{value:s.nomeUsuario,onChange:e=>r("nomeUsuario",e.target.value),placeholder:"Nome do usuário",className:"pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Perfil"}),a.jsx(vi,{value:s.perfilUsuario,onChange:e=>r("perfilUsuario",e),placeholder:"Selecione o perfil",sugestoes:l,loading:g})]})]}),t&&i.length>0&&a.jsx("div",{className:"absolute z-[9999] w-full mt-1 left-0 right-0",children:a.jsxs(nt,{className:"p-2 shadow-lg bg-white border border-gray-200",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-2 font-medium",children:"Usuários encontrados:"}),a.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:i.map(e=>a.jsx("div",{onMouseDown:a=>{a.preventDefault(),a.stopPropagation(),(e=>{const a=Tt(e.cpf),s=St(a);r("cpfUsuario",s),r("nomeUsuario",e.nome_completo),r("perfilUsuario",e.perfil||""),o(!1),n([]),m(!0)})(e)},className:"w-full p-2 rounded cursor-pointer hover:bg-blue-50 border border-gray-100 transition-colors",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(se,{className:"h-4 w-4 text-gray-400"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.nome_completo}),a.jsxs("div",{className:"text-xs text-gray-500",children:[St(e.cpf)," ",e.perfil&&`• ${e.perfil}`]})]})]})},e.id))})]})})]})},wi=["Acesso ao Sistema – Erro ao Carregar Painel","Acórdão – Erro","Acumulador – Consulta de Posição","Acumulador – Regularização","Advogado – Painel do Advogado / Procurador – Erro","Agrupadores – Erro","Área de Zoneamento – Erro em Configuração do Oficial de Justiça","Assinador não Carrega – Não ativa o botão “Entrar”","Assinatura de Acórdão – Erro","Assinatura de Ata – Erro","Assuntos da Ação – Competência","Assuntos da Ação – Inexistência","Ata de Audiência – Erro de Assinatura","Ata de Audiência – Erro na Confirmação","Ata de Audiência – Erro na Exportação","Atualização de Tela","Audiência – Pauta – Erro de Designação","Audiências – Erro ao Abrir Pauta","Audiências – Erro Configuração de Sala","Audiências – Pauta Bloqueada – Marcação de Horário","Autenticação: Erro ao Consultar Dados","Autenticação: Não foi Possível Realizar","Atuação – Correção de Parte","Atuação – Erro ao Alterar a Classe","Baixa ao 1º Grau – Erro","Baixa de Documentos – Erro Webservice","Baixa para diligência – Erro","BNDT – Erro na Inclusão ou Exclusão","Cadastro de Advogado – Erro","Cadastro de Autoridade","Cadastro de Magistrado – Alteração","Cadastro de Órgãos Públicos","Cadastro de Perito – Erro","Cadastro de Pessoa Física – Atualização de Nome","Cadastro de Pessoa Física – Erro","Cadastro de Pessoa Jurídica – Erro","Cadastro de Processo CLE – Erro na Elaboração","Cadastro de Procurador – Erro","Cadastro de Usuário – Correção de Perfil","Cadastro de Usuário – Exclusão de Perfil","Calendário","Caixas das Árvores de Tarefa – Erro na listagem","CEP – Registro Ausente","CEP Inexistente na Base dos Correios – Não Encontrado","Certidão de Distribuição de Ações Trabalhistas","Competência – Classe × Assunto","Competência – Órgão Julgador × Competência","Configuração de Órgão Julgador","Configuração do Sistema – Alteração, Inclusão ou Exclusão","Consulta – Alertas em Processos – Erro","Consulta Características / Recursos do Sistema","Consulta de Processos","Controle de prazos – Erro","Decisão / Despacho – Erro na Assinatura","Defeito em Homologação","Defeito em Produção","Descrição de Tipo de Parte – Erro – Classe Judicial","Distribuição de Processos – Erro","Documento – Sem Conteúdo","Documento do Processo – Erro ao Abrir","Documento do Processo – Erro ao Salvar","Documento do Processo – Erro em Assinatura","Documento do Processo – Erro no Escaninho","Documento do Processo – Sem Assinatura","Documento do Processo – Sem Data de Juntada","Documentos – Aba Anexar Documentos – Tipos","Documentos – Anexos – Sem Vinculação com o Principal","Documentos – Exclusão","Documentos do Processo – Erro ao Baixar","Documentos do Processo – Erro na Atualização","Documentos do Processo – Erro no Tipo – Despacho","E-Rec – Configuração – Erro","EXE-Pje – Erro de Execução","GIGS – Erro","Habilitação Advogado – Erro","Inclusão de CEP","JIRA 1º grau – Consulta de Mensagens","JIRA 1º grau – Postar Mensagem","JIRA 2º grau – Consulta de Mensagens","JIRA 2º grau – Postar Mensagem","Logs do Sistema – Solicitação","MNI – Erro na Assinatura de Documentos","Modelos de Documentos – Erro na Exibição / Seleção","Movimento – Erro no Registro","Nó de Desvio – Erro na Inclusão de Processo","Nó de Desvio – Inexistência de Fluxo","Painel KZ – Filtros","Pauta de Julgamento – Fechamento – Erro","Pauta de Julgamento – Inclusão de Processos – Erro","PJE – Cadastro de usuários (Alteração ou Cadastramento de Localização, Visibilidade e Papel)","PJE – Erro de acesso","PJE 2º Grau – Produção – Alteração do Cadastro de Parte","PJE 2º Grau – Produção – Alteração Órgãos Julgadores","PJE-Calc – Erro na Execução","PJE-JT – BugFix 1º grau – Atualização","PJE-JT – BugFix 2º grau – Atualização","PJE-JT – Homologação 1º grau – Atualização de Versão","PJE-JT – Homologação 2º grau – Atualização de Versão","PJE-JT – Incidentes – Atualização de dados/versão","PJE-JT – Produção 1º grau – Atualização de Versão","PJE-JT – Produção 2º grau – Atualização de Versão","PJE-JT – Treinamento 1º grau – Copiar dados/versão da produção","PJE-JT – Treinamento 1º grau – Guardar cópia (fazer backup)","PJE-JT – Treinamento 1º grau – Restaurar cópia (voltar backup)","PJE-JT – Treinamento 2º grau – Copiar dados/versão da produção","PJE-JT – Treinamento 2º grau – Guardar cópia (fazer backup)","PJE-JT – Treinamento 2º grau – Restaurar cópia (voltar backup)","Peticionamento Avulso – Erro","Pesquisa de Log – 2º Grau","Pesquisas – Erro","Perito – Erro ao Anexar Laudo","Perito – Perícia Designada – Processo não Localizado no Painel","Plantonista – Exclusão de Magistrados do OJ","Plantonista – Usuário Sem Visibilidade","Prazo em Aberto – Erro","Prazo em Aberto – Erro ao Encerrar Expediente","Processo – Bloqueado","Processo – CHIPS – Erro de Registro","Processo – Consulta a Dados do Processo","Processo – Consulta – Erro ao Abrir","Processo – Erro na Autuação","Processo – Erro na Distribuição – Ausência de Petição Inicial","Processo – Erro na Distribuição – Processo sem Número","Processo – Localização – Não Encontrado","Processo – Movimentos – Regularização ou Inclusão","Processo – Registro de Valores – Correção de Erro","PUSH – Erro","Revisor – Erro ao Encaminhar","Registros – Erro","Redistribuição – Documento Não Assinado","Redistribuição – Erro","Remessa ao 2º Grau – Erro","Remessa ao TST – Erro","Remessa ao TST – Erro na Elaboração da Certidão de Remessa","Retificação de Autuação – Erro","SAO – Erro na Emissão de Relatório","Sentença – Erro em Assinatura","Sentença – Registro de Solução – Erro na Inclusão","Sentença – Resultados – Alteração dos Dados","SIF – Erro de Acesso / Execução","SISCONDJ – Erro de Acesso / Execução","Sistema – Correção / Inclusão de Dados","Subcaixas – Problemas com Manutenção","Tarefa – Análise de Dependência","Tarefa – Apreciar Petição – Erro","Tarefa – Arquivamento – Erro","Tarefa – Comunicação de Ato – Erro na Assinatura","Tarefa – Comunicação de Ato – Erro na Execução","Tarefa – Conclusão ao Magistrado","Tarefa – Conversão em Diligência – Erro na Movimentação","Tarefa – Desarquivar – Erro","Tarefa – Erro de fase","Tarefa – Erro de Fluxo","Tarefa – Erro de Movimentação","Tarefa – Erro na Abertura","Tarefa – Erro na Assinatura do Documento","Tarefa – Erro na Execução – Impressão de Expedientes","Tarefa – Erro na Execução – Registro de Depósito / Custas","Tarefa – Erro no Envio de Publicação DEJT","Tarefa – Oficial de Justiça – Erro na Execução","Tarefa – Processo Preso em Publicar DJe","Tarefa – Sem Opções de Tarefa","Tarefa – Trânsito em Julgado","Tarefas – Erro de fase","Tarefas – Sub Caixas","Timeline – Erro na Exibição de Documentos","Unificação de cadastros de órgãos públicos – Erro","Usuário – Acesso Bloqueado – Solicita Desbloqueio","Usuário – Erro de Acesso ao Sistema","Usuário – Recursos do Sistema – Erro de Acesso ou Falta de Autorização","Variáveis – Erro","Variáveis de Documentos – Erro","Votação Antecipada – Erro no Registro","Voto – Erro na Inclusão","Voto – Sem Visibilidade na Pauta de Julgamento"],yi=({formData:s,onInputChange:r,onMultipleInputChange:t,onGenerateDescription:o,onResetForm:i,validationErrors:n={}})=>{const{buscarSugestoesOrgaoJulgador:l,buscarSugestoesPerfil:d,buscarSugestoesChamadoOrigem:c,loading:m}=bi(),{assuntos:u,loading:x}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState(!0),[o,i]=e.useState(null),n=()=>{try{t(!0);const e=wi.map((e,a)=>({id:`local-${a}`,nome:e,categoria:null}));s(e)}catch(e){i(e instanceof Error?e.message:"Erro ao carregar assuntos")}finally{t(!1)}};return e.useEffect(()=>{n()},[]),{assuntos:a,loading:r,error:o,refetch:n,totalAssuntos:a.length}})(),[h,g]=e.useState([]),[p,f]=e.useState([]),[j,b]=e.useState([]),v=u.map((e,a)=>({valor:e.nome,frequencia:1,ultimo_uso:(new Date).toISOString()}));e.useEffect(()=>{(async()=>{const[e,a]=await Promise.all([d(),c()]);f(e),b(a)})()},[]),e.useEffect(()=>{if(s.grau){(async()=>{const e=await l(s.grau);g(e)})()}},[s.grau]);return a.jsxs(nt,{className:"shadow-lg",children:[a.jsxs(lt,{className:"bg-blue-600 text-white",children:[a.jsxs(dt,{className:"flex items-center",children:[a.jsx(Sa,{className:"h-5 w-5 mr-2"}),"Dados do Chamado"]}),a.jsx(ct,{className:"text-blue-100",children:"Preencha todos os campos obrigatórios para gerar a descrição"})]}),a.jsxs(mt,{className:"space-y-6 p-6",children:[a.jsxs("div",{children:[a.jsx("div",{className:"mb-2",children:a.jsx(eo,{htmlFor:"resumo",className:n.resumo?"text-red-600":"",children:"Resumo *"})}),a.jsx(vi,{id:"resumo",value:s.resumo,onChange:e=>r("resumo",e),placeholder:"Descreva brevemente o problema",sugestoes:v,loading:x,className:n.resumo?"border-red-500 focus:border-red-500":""}),n.resumo&&a.jsxs("p",{className:"text-red-600 text-sm mt-1 flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),n.resumo]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"chamadoOrigem",children:"Chamado Origem"}),a.jsx(vi,{id:"chamadoOrigem",value:s.chamadoOrigem,onChange:e=>r("chamadoOrigem",e),placeholder:"Ex: R303300 ou 11100",sugestoes:j,loading:m})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"grau",className:n.grau?"text-red-600":"",children:"Grau *"}),a.jsxs(ao,{value:s.grau,onValueChange:e=>r("grau",e),children:[a.jsx(ro,{className:n.grau?"border-red-500 focus:border-red-500":"",children:a.jsx(so,{placeholder:"Selecione o grau"})}),a.jsx(io,{children:ii.map(e=>a.jsx(no,{value:e,children:e},e))})]}),n.grau&&a.jsxs("p",{className:"text-red-600 text-sm mt-1 flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),n.grau]})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"processos",children:"Número(s) do(s) Processo(s)"}),a.jsx(Sr,{id:"processos",value:s.processos,onChange:e=>(e=>{if("1º Grau"===s.grau&&e.trim()){const a=li(e.trim());if(a&&t)return void t({processos:e,orgaoJulgador:a})}r("processos",e)})(e.target.value),placeholder:"Ex: 0000000-00.0000.0.00.0000"})]})]}),"Outro (personalizado)"===s.resumo&&a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"resumoCustom",children:"Resumo Personalizado *"}),a.jsx(Sr,{id:"resumoCustom",value:s.resumoCustom,onChange:e=>r("resumoCustom",e.target.value),placeholder:"Digite um resumo personalizado"})]}),"1º Grau"===s.grau&&a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"orgaoJulgador",className:n.orgaoJulgador?"text-red-600":"",children:"Órgão Julgador *"}),a.jsx(gi,{value:s.orgaoJulgador,onValueChange:e=>r("orgaoJulgador",e),placeholder:"Buscar órgão julgador por cidade ou nome...",orgaosJulgadores:ni}),n.orgaoJulgador&&a.jsxs("p",{className:"text-red-600 text-sm mt-1 flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),n.orgaoJulgador]})]}),"2º Grau"===s.grau&&a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"orgaoJulgador",className:n.orgaoJulgador?"text-red-600":"",children:"Órgão Julgador de Origem *"}),a.jsx(fi,{value:s.orgaoJulgador,onValueChange:e=>r("orgaoJulgador",e),placeholder:"Buscar órgão julgador de 2º grau..."}),n.orgaoJulgador&&a.jsxs("p",{className:"text-red-600 text-sm mt-1 flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),n.orgaoJulgador]})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"notas",className:n.notas?"text-red-600":"",children:"Descrição do Problema *"}),a.jsx(Nt,{id:"notas",value:s.notas,onChange:e=>r("notas",e.target.value),placeholder:"Descreva detalhadamente o problema, ações já realizadas e informações relevantes...",rows:4,className:n.notas?"border-red-500 focus:border-red-500":""}),n.notas&&a.jsxs("p",{className:"text-red-600 text-sm mt-1 flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),n.notas]})]}),a.jsx(Ni,{formData:s,onInputChange:r}),a.jsx("div",{className:"flex gap-3",children:a.jsxs(cr,{onClick:o,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:[a.jsx(qe,{className:"h-4 w-4 mr-2"}),"Gerar Assyst com IA"]})})]})]})},Ci=({isGenerated:e,sections:s,generatedDescription:r})=>{const t=(e,a)=>{navigator.clipboard.writeText(e),Cs.success(`${a} copiado para a área de transferência!`)};return a.jsx("div",{className:"transition-all duration-500 ease-in-out w-full "+(e?"opacity-100 translate-y-0":"opacity-0 translate-y-4 pointer-events-none"),children:a.jsxs(nt,{className:"shadow-lg w-full",children:[a.jsxs(lt,{className:"bg-green-600 text-white",children:[a.jsxs(dt,{className:"flex items-center text-xl",children:[a.jsx(X,{className:"h-6 w-6 mr-3"}),"Template JIRA - Sustentação"]}),a.jsx(ct,{className:"text-green-100 text-base",children:'Template formatado e pronto para copiar no campo "Notas" do JIRA'})]}),a.jsx(mt,{className:"p-8",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:(()=>{const{pairs:e,fullWidthSections:r}=(()=>{const e=[],a=[];s.forEach(s=>{s.fullWidth?a.push(s):e.push(s)});const r=[];for(let s=0;s<e.length;s+=2)r.push({left:e[s],right:e[s+1]||null});return{pairs:r,fullWidthSections:a}})();return a.jsxs("div",{className:"p-4 space-y-4",children:[r.map((s,o)=>a.jsxs("div",{className:""+(o!==r.length-1||e.length>0?"border-b border-gray-100 pb-4":""),children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"font-semibold text-gray-800 text-sm",children:[s.title.includes("Resumo")?"*":"",s.title]}),a.jsx(cr,{onClick:()=>t(s.content,s.title),size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-gray-100",children:a.jsx(Ta,{className:"h-3 w-3"})})]}),a.jsx("div",{className:"bg-gray-50 p-4 rounded border text-base font-mono text-gray-700 leading-relaxed",children:s.content||a.jsx("span",{className:"text-gray-400 italic",children:"Campo vazio"})})]},s.key)),e.map((s,r)=>a.jsx("div",{className:""+(r!==e.length-1?"border-b border-gray-100 pb-4":""),children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"font-semibold text-gray-800 text-sm",children:[s.left.title.includes("Resumo")?"*":"",s.left.title]}),a.jsx(cr,{onClick:()=>t(s.left.content,s.left.title),size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-gray-100",children:a.jsx(Ta,{className:"h-3 w-3"})})]}),a.jsx("div",{className:"bg-gray-50 p-4 rounded border text-base font-mono text-gray-700 leading-relaxed",children:s.left.content||a.jsx("span",{className:"text-gray-400 italic",children:"Campo vazio"})})]}),s.right&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"font-semibold text-gray-800 text-sm",children:[s.right.title.includes("Resumo")?"*":"",s.right.title]}),a.jsx(cr,{onClick:()=>t(s.right.content,s.right.title),size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-gray-100",children:a.jsx(Ta,{className:"h-3 w-3"})})]}),a.jsx("div",{className:"bg-gray-50 p-4 rounded border text-base font-mono text-gray-700 leading-relaxed",children:s.right.content||a.jsx("span",{className:"text-gray-400 italic",children:"Campo vazio"})})]})]})},`pair-${r}`))]})})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{onClick:()=>{navigator.clipboard.writeText(r),Cs.success("Descrição completa copiada para a área de transferência!")},className:"flex-1 bg-green-600 hover:bg-green-700",children:[a.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Copiar Descrição Completa"]}),a.jsxs(cr,{onClick:()=>{const e=s.map(e=>`${e.title}${e.title.includes("Resumo")?" *":""}\n${e.content}`).join("\n\n");t(e,"Template formatado")},variant:"secondary",className:"flex-1",children:[a.jsx(qe,{className:"h-4 w-4 mr-2"}),"Copiar Template Formatado"]})]})]})})]})})},ki=[{id:"creative",name:"IA Criativa",description:"Focada em soluções inovadoras e abordagens criativas",icon:a.jsx(D,{className:"h-4 w-4"}),strengths:["Soluções inovadoras","Abordagens alternativas","Linguagem envolvente"],speed:"medium"},{id:"analytical",name:"IA Analítica",description:"Especializada em análise técnica e soluções estruturadas",icon:a.jsx(Oe,{className:"h-4 w-4"}),strengths:["Análise detalhada","Soluções técnicas","Estrutura lógica"],speed:"slow"},{id:"quick",name:"IA Rápida",description:"Respostas rápidas e diretas para problemas comuns",icon:a.jsx(Re,{className:"h-4 w-4"}),strengths:["Velocidade","Respostas diretas","Eficiência"],speed:"fast"},{id:"specialized",name:"IA Especializada",description:"Focada em problemas específicos do sistema judiciário",icon:a.jsx(Aa,{className:"h-4 w-4"}),strengths:["Conhecimento jurídico","Contexto específico","Precisão técnica"],speed:"medium"}],Ei=[{value:"formal",label:"Formal"},{value:"tecnico",label:"Técnico"},{value:"amigavel",label:"Amigável"},{value:"direto",label:"Direto"},{value:"detalhado",label:"Detalhado"}],Si=[{value:"clareza",label:"Clareza"},{value:"completude",label:"Completude"},{value:"brevidade",label:"Brevidade"},{value:"precisao",label:"Precisão técnica"}],Ti=({open:s,onOpenChange:r,formData:t,onProceedToGenerate:o})=>{const[i,n]=e.useState("analytical"),[l,d]=e.useState("formal"),[c,m]=e.useState("clareza"),[u,x]=e.useState(""),[h,g]=e.useState({}),[p,f]=e.useState({}),[j,b]=e.useState("config"),{enhanceText:v}=(()=>{const[a,s]=e.useState(!1);return{enhanceText:async(e,a="geral")=>{if(!e.trim())return Cs.error("Digite algum texto para melhorar"),null;try{s(!0);const{data:r,error:t}=await dr.functions.invoke("enhance-text-with-ai",{body:{text:e.trim(),type:a}});if(t)return t.message?.includes("Invalid API key")||t.message?.includes("Missing Supabase")?Cs.error("❌ Erro de configuração do Supabase. Verifique as variáveis de ambiente."):t.message?.includes("fetch")?Cs.error("❌ Erro de conexão. Verifique sua internet e tente novamente."):Cs.error("❌ Erro ao conectar com o serviço de IA"),null;if(r?.error)return r.error.includes("OPENAI_API_KEY")?Cs.error("🔑 Chave da OpenAI não configurada no Supabase. Configure nas Edge Functions."):r.error.includes("OpenAI API")?Cs.error("🤖 Erro da API da OpenAI. Verifique os créditos da conta."):Cs.error(`❌ ${r.error}`),null;if(!r.enhancedText)return Cs.error("Não foi possível melhorar o texto"),null;const o=(e=>e.replace(/^#{1,6}\s+/gm,"").replace(/\*{1,2}([^*]+)\*{1,2}/g,"$1").replace(/_{1,2}([^_]+)_{1,2}/g,"$1").replace(/^[\s]*[-*+]\s+/gm,"").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/`([^`]+)`/g,"$1").replace(/```[\s\S]*?```/g,"").replace(/^---+$/gm,"").replace(/\n{3,}/g,"\n\n").trim())(r.enhancedText);return Cs.success("Texto melhorado com sucesso!"),o}catch(r){return Cs.error("Erro inesperado ao melhorar o texto"),null}finally{s(!1)}},isEnhancing:a}})(),N=async e=>{if(t.notas){f(a=>({...a,[e]:!0}));try{const a=ki.find(a=>a.id===e),s=`\n        Gere APENAS a descrição do problema para um chamado de suporte técnico do NAPJe.\n        \n        Modelo: ${a?.name}\n        Tom: ${l}\n        Prioridade: ${c}\n        Instruções adicionais: ${u}\n        \n        Problema relatado pelo usuário: ${t.notas}\n        \n        IMPORTANTE: \n        - Gere SOMENTE a descrição do problema\n        - NÃO inclua dados do usuário (nome, CPF, perfil)\n        - NÃO inclua dados do processo (grau, órgão julgador, número do processo)\n        - NÃO inclua possíveis causas ou soluções\n        - NÃO inclua chamado de origem\n        - Foque apenas em descrever o problema de forma clara e técnica\n      `,[r,o]=await Promise.all([v(s,"descricao"),v(s,"sugestao_solucao")]);g(a=>({...a,[e]:{description:r,solution:o}})),b("results")}catch(a){Cs.error("Erro ao gerar conteúdo com IA")}finally{f(a=>({...a,[e]:!1}))}}else Cs.error("Preencha a descrição do problema primeiro")},w=async(e,a)=>{try{await navigator.clipboard.writeText(e),Cs.success(`${a} copiado para a área de transferência`)}catch(s){Cs.error("Erro ao copiar para a área de transferência")}};return a.jsx(wr,{open:s,onOpenChange:r,children:a.jsxs(yr,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-5 w-5"}),"IA Avançada - Múltiplas Opções"]})}),a.jsxs(Eo,{value:j,onValueChange:b,className:"w-full",children:[a.jsxs(So,{className:"grid w-full grid-cols-2",children:[a.jsx(To,{value:"config",children:"Configuração"}),a.jsx(To,{value:"results",children:"Resultados"})]}),a.jsxs(Ao,{value:"config",className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Escolha o Modelo de IA"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ki.map(e=>{return a.jsxs(nt,{className:"cursor-pointer transition-all "+(i===e.id?"ring-2 ring-blue-500 bg-blue-50":"hover:shadow-md"),onClick:()=>n(e.id),children:[a.jsxs(lt,{className:"pb-3",children:[a.jsxs(dt,{className:"flex items-center justify-between text-base",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[e.icon,e.name]}),(s=e.speed,a.jsx(mr,{className:{fast:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",slow:"bg-red-100 text-red-800"}[s],children:{fast:"Rápido",medium:"Médio",slow:"Detalhado"}[s]}))]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),a.jsx(mt,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Pontos Fortes:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:e.strengths.map((e,s)=>a.jsx(mr,{variant:"outline",className:"text-xs",children:e},s))})]})})]},e.id);var s})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx(eo,{htmlFor:"tone",children:"Tom da Resposta"}),a.jsxs(ao,{value:l,onValueChange:d,children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione o tom"})}),a.jsx(io,{children:Ei.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(eo,{htmlFor:"priority",children:"Prioridade"}),a.jsxs(ao,{value:c,onValueChange:m,children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione a prioridade"})}),a.jsx(io,{children:Si.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(eo,{htmlFor:"instructions",children:"Instruções Adicionais (Opcional)"}),a.jsx(Nt,{id:"instructions",value:u,onChange:e=>x(e.target.value),placeholder:"Ex: Foque em soluções técnicas, mencione procedimentos específicos, etc.",rows:3})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(cr,{onClick:()=>N(i),disabled:p[i],className:"flex-1",children:[p[i]?a.jsx(na,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(D,{className:"h-4 w-4 mr-2"}),"Gerar com ",ki.find(e=>e.id===i)?.name]}),a.jsx(cr,{variant:"outline",onClick:()=>{ki.forEach(e=>N(e.id))},disabled:Object.values(p).some(Boolean),children:"Gerar com Todos"})]})]}),a.jsx(Ao,{value:"results",className:"space-y-6",children:0===Object.keys(h).length?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(D,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhum resultado gerado ainda"}),a.jsx("p",{className:"text-sm",children:"Configure e gere conteúdo na aba anterior"})]}):a.jsx("div",{className:"space-y-6",children:Object.entries(h).map(([e,s])=>{const r=ki.find(a=>a.id===e);return a.jsxs(nt,{className:"border-l-4 border-l-blue-500",children:[a.jsx(lt,{children:a.jsxs(dt,{className:"flex items-center gap-2",children:[r?.icon,r?.name,a.jsx(ze,{className:"h-4 w-4 text-green-600"})]})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Descrição Melhorada"}),a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>w(s.description,"Descrição"),children:[a.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Copiar"]})]}),a.jsx("div",{className:"bg-gray-50 p-3 rounded-md text-sm whitespace-pre-wrap",children:s.description})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Sugestão de Solução"}),a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>w(s.solution,"Solução"),children:[a.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Copiar"]})]}),a.jsx("div",{className:"bg-green-50 p-3 rounded-md text-sm whitespace-pre-wrap",children:s.solution})]})]})]},e)})})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx(cr,{variant:"outline",onClick:()=>r(!1),children:"Fechar"}),a.jsx(cr,{onClick:o,children:"Prosseguir para Geração"})]})]})})},Ai=[{id:"1",nome:"Problema de Login",categoria:"Acesso",descricao:"Template para problemas relacionados ao login no sistema",tags:["login","acesso","senha","autenticação"],dados:{resumo:"Problema de acesso ao sistema",grau:"1º Grau",notas:"Usuário relatou dificuldades para acessar o sistema. Verificar:\n- Credenciais do usuário\n- Status da conta\n- Configurações de rede\n- Logs de autenticação"},usageCount:45,lastUsed:new Date("2024-01-15"),isFavorite:!0},{id:"2",nome:"Erro de Certificado Digital",categoria:"Certificado",descricao:"Template para problemas com certificado digital",tags:["certificado","digital","assinatura","token"],dados:{resumo:"Problema com certificado digital",grau:"1º Grau",notas:"Problema reportado com certificado digital. Verificar:\n- Validade do certificado\n- Instalação correta\n- Drivers do token/smartcard\n- Configurações do navegador"},usageCount:32,lastUsed:new Date("2024-01-10"),isFavorite:!1},{id:"3",nome:"Lentidão no Sistema",categoria:"Performance",descricao:"Template para problemas de performance e lentidão",tags:["lentidão","performance","velocidade","timeout"],dados:{resumo:"Sistema apresentando lentidão",grau:"1º Grau",notas:"Usuário reportou lentidão no sistema. Verificar:\n- Carga do servidor\n- Conexão de rede\n- Cache do navegador\n- Recursos do computador\n- Horário de maior uso"},usageCount:28,lastUsed:new Date("2024-01-08"),isFavorite:!0},{id:"4",nome:"Erro ao Enviar Petição",categoria:"Peticionamento",descricao:"Template para problemas no envio de petições",tags:["petição","envio","protocolo","anexo"],dados:{resumo:"Erro no envio de petição eletrônica",grau:"1º Grau",notas:"Erro reportado durante o envio de petição. Verificar:\n- Tamanho dos arquivos anexados\n- Formato dos documentos\n- Certificado digital\n- Dados do processo\n- Logs de erro do sistema"},usageCount:38,lastUsed:new Date("2024-01-12"),isFavorite:!1},{id:"5",nome:"Problema de Impressão",categoria:"Impressão",descricao:"Template para problemas relacionados à impressão",tags:["impressão","impressora","documento","pdf"],dados:{resumo:"Problema na impressão de documentos",grau:"1º Grau",notas:"Problema reportado na impressão. Verificar:\n- Status da impressora\n- Drivers atualizados\n- Configurações de impressão\n- Formato do documento\n- Permissões de acesso"},usageCount:22,lastUsed:new Date("2024-01-05"),isFavorite:!1}],_i=({onSelectTemplate:s,onClose:r})=>{const[t,o]=e.useState(""),[i,n]=e.useState("Todos"),[l,d]=e.useState(Ai),c=["Todos",...Array.from(new Set(Ai.map(e=>e.categoria)))];e.useEffect(()=>{let e=Ai;if("Todos"!==i&&(e=e.filter(e=>e.categoria===i)),t){const a=t.toLowerCase();e=e.filter(e=>e.nome.toLowerCase().includes(a)||e.descricao.toLowerCase().includes(a)||e.tags.some(e=>e.toLowerCase().includes(a)))}e.sort((e,a)=>e.isFavorite&&!a.isFavorite?-1:!e.isFavorite&&a.isFavorite?1:a.usageCount-e.usageCount),d(e)},[t,i]);const m=e=>{if(!e)return"Nunca usado";const a=new Date,s=Math.abs(a.getTime()-e.getTime()),r=Math.ceil(s/864e5);return 1===r?"Usado ontem":r<7?`Usado há ${r} dias`:r<30?`Usado há ${Math.ceil(r/7)} semanas`:`Usado há ${Math.ceil(r/30)} meses`};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(qe,{className:"h-6 w-6"}),"Selecionar Template"]}),a.jsx(cr,{variant:"outline",onClick:r,children:"Fechar"})]}),a.jsx("div",{className:"flex gap-4 mb-4",children:a.jsxs("div",{className:"flex-1",children:[a.jsx(eo,{htmlFor:"search",children:"Buscar templates"}),a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(Sr,{id:"search",placeholder:"Buscar por nome, descrição ou tags...",value:t,onChange:e=>o(e.target.value),className:"pl-10"})]})]})}),a.jsx("div",{className:"flex gap-2 flex-wrap",children:c.map(e=>a.jsx(cr,{variant:i===e?"default":"outline",size:"sm",onClick:()=>n(e),children:e},e))})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(e=>a.jsxs(nt,{className:"cursor-pointer hover:shadow-lg transition-shadow",children:[a.jsx(lt,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs(dt,{className:"text-lg flex items-center gap-2",children:[e.nome,e.isFavorite&&a.jsx(Ke,{className:"h-4 w-4 text-yellow-500 fill-current"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.descricao})]}),a.jsx(mr,{variant:"secondary",children:e.categoria})]})}),a.jsx(mt,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"flex flex-wrap gap-1",children:e.tags.map(e=>a.jsx(mr,{variant:"outline",className:"text-xs",children:e},e))}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"h-3 w-3"}),m(e.lastUsed)]}),a.jsxs("span",{children:[e.usageCount," usos"]})]}),a.jsx(cr,{className:"w-full",onClick:()=>s(e),children:"Usar Template"})]})})]},e.id))}),0===l.length&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(qe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhum template encontrado"}),a.jsx("p",{className:"text-sm",children:"Tente ajustar os filtros de busca"})]})]})]})})},Pi=Ns("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Di=e.forwardRef(({className:e,variant:s,...r},t)=>a.jsx("div",{ref:t,role:"alert",className:lr(Pi({variant:s}),e),...r}));Di.displayName="Alert";e.forwardRef(({className:e,...s},r)=>a.jsx("h5",{ref:r,className:lr("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";const zi=e.forwardRef(({className:e,...s},r)=>a.jsx("div",{ref:r,className:lr("text-sm [&_p]:leading-relaxed",e),...s}));zi.displayName="AlertDescription";const Ii=a=>{const[s,r]=e.useState([]),[t,o]=e.useState(!1),[i,n]=e.useState([]),[l,d]=e.useState([]),{buscarChamadosRecentes:c}=_t();return e.useEffect(()=>{const e=setTimeout(async()=>{if(!a.resumo&&!a.notas)return r([]),void n([]);o(!0);try{const e=`${a.resumo} ${a.notas}`.trim();if(!e||e.length<10)return r([]),void n([]);const s=l.map(a=>{const s=`${a.titulo} ${a.descricao||""}`,r=((e,a)=>{if(!e||!a)return 0;const s=e.toLowerCase().split(/\s+/).filter(e=>e.length>3),r=a.toLowerCase().split(/\s+/).filter(e=>e.length>3);return 0===s.length||0===r.length?0:2*s.filter(e=>r.includes(e)).length/(s.length+r.length)})(e,s);return{id:a.id,resumo:a.titulo,notas:a.descricao,orgaoJulgador:a.orgao_julgador||"",grau:a.grau||"",similarity:r,createdAt:new Date(a.created_at),resolucao:a.resolucao}}).filter(e=>e.similarity>.3).sort((e,a)=>a.similarity-e.similarity).slice(0,5);r(s),n((e=>{const a=[];if(e.length>0){a.push(`Encontrados ${e.length} chamados similares`),e.filter(e=>e.resolucao).length>0&&a.push("Há chamados similares já resolvidos que podem ajudar");const s=e.reduce((e,a)=>(e[a.orgaoJulgador]=(e[a.orgaoJulgador]||0)+1,e),{}),r=Object.entries(s).sort(([,e],[,a])=>a-e)[0];r&&r[1]>1&&a.push(`Problema frequente no órgão: ${r[0]}`),e.filter(e=>((new Date).getTime()-e.createdAt.getTime())/864e5<=30).length>=3&&a.push("Problema recorrente - considere investigação mais profunda")}return a})(s))}catch(e){r([]),n([])}finally{o(!1)}},1e3);return()=>clearTimeout(e)},[a.resumo,a.notas,l]),e.useEffect(()=>{(async()=>{try{const e=await c(100);d(e)}catch(e){}})()},[c]),{similarChamados:s,isAnalyzing:t,suggestions:i}},Mi=({formData:s})=>{const{similarChamados:r,isAnalyzing:t,suggestions:o}=Ii(s),[i,n]=e.useState(new Set),l=e=>e>=.7?"Alta":e>=.5?"Média":"Baixa";return s.resumo||s.notas?a.jsxs(nt,{className:"mt-6",children:[a.jsx(lt,{children:a.jsxs(dt,{className:"flex items-center gap-2",children:[a.jsx(ua,{className:"h-5 w-5"}),"Análise de Similaridade",t&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]})}),a.jsxs(mt,{className:"space-y-4",children:[o.length>0&&a.jsx("div",{className:"space-y-2",children:o.map((e,s)=>a.jsxs(Di,{className:"border-blue-200",children:[a.jsx(ha,{className:"h-4 w-4"}),a.jsx(zi,{children:e})]},s))}),r.length>0?a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"Chamados Similares Encontrados"}),r.map(e=>{return a.jsx(nt,{className:"border-l-4 border-l-blue-500",children:a.jsxs(mt,{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900 mb-1",children:e.resumo}),a.jsx("p",{className:"text-sm text-gray-600 "+(i.has(e.id)?"":"line-clamp-2"),children:e.notas})]}),a.jsxs(mr,{className:(r=e.similarity,r>=.7?"bg-red-100 text-red-800":r>=.5?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:[l(e.similarity)," (",Math.round(100*e.similarity),"%)"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-3",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"h-3 w-3"}),(s=e.createdAt,new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(s))]}),e.grau&&a.jsx(mr,{variant:"outline",className:"text-xs",children:e.grau}),e.orgaoJulgador&&a.jsx("span",{className:"truncate max-w-[200px]",children:e.orgaoJulgador})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[e.resolucao&&a.jsxs(mr,{variant:"outline",className:"text-green-600 border-green-600",children:[a.jsx(ze,{className:"h-3 w-3 mr-1"}),"Resolvido"]}),a.jsx(cr,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>(e=>{const a=new Set(i);a.has(e)?a.delete(e):a.add(e),n(a)})(e.id),children:i.has(e.id)?a.jsxs(a.Fragment,{children:[a.jsx(ia,{className:"h-3 w-3 mr-1"}),"Ocultar"]}):a.jsxs(a.Fragment,{children:[a.jsx(oa,{className:"h-3 w-3 mr-1"}),"Ver"]})})]})]}),e.resolucao&&a.jsx("div",{className:"mt-3 p-3 bg-green-50 rounded-md border border-green-200",children:a.jsxs("p",{className:"text-sm text-green-800",children:[a.jsx("strong",{children:"Resolução:"})," ",e.resolucao]})})]})},e.id);var s,r})]}):!t&&a.jsxs("div",{className:"text-center py-6 text-gray-500",children:[a.jsx(ua,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"Nenhum chamado similar encontrado"}),a.jsx("p",{className:"text-sm",children:"Continue preenchendo os dados para uma análise mais precisa"})]}),t&&a.jsxs("div",{className:"text-center py-6 text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),a.jsx("p",{children:"Analisando similaridade..."})]})]})]}):null},Fi={creative:a.jsx(D,{className:"h-4 w-4"}),analytical:a.jsx(Oe,{className:"h-4 w-4"}),quick:a.jsx(Re,{className:"h-4 w-4"}),specialized:a.jsx(Aa,{className:"h-4 w-4"})},Oi={creative:"IA Criativa",analytical:"IA Analítica",quick:"IA Rápida",specialized:"IA Especializada"},Ri=({onSelectItem:s,onApplyToForm:r})=>{const[t,o]=e.useState([]),[i,n]=e.useState([]),[l,d]=e.useState(""),[c,m]=e.useState("all"),[u,x]=e.useState(!1),[h,g]=e.useState("date");e.useEffect(()=>{const e=localStorage.getItem("ai-history");if(e)try{const a=JSON.parse(e).map(e=>({...e,timestamp:new Date(e.timestamp)}));o(a)}catch(a){}},[]),e.useEffect(()=>{let e=[...t];l&&(e=e.filter(e=>e.description.toLowerCase().includes(l.toLowerCase())||e.solution.toLowerCase().includes(l.toLowerCase())||e.formData.resumo.toLowerCase().includes(l.toLowerCase())||e.formData.notas.toLowerCase().includes(l.toLowerCase()))),"all"!==c&&(e=e.filter(e=>e.model===c)),u&&(e=e.filter(e=>e.isFavorite)),e.sort((e,a)=>{switch(h){case"date":return a.timestamp.getTime()-e.timestamp.getTime();case"model":return e.model.localeCompare(a.model);case"favorites":return e.isFavorite&&!a.isFavorite?-1:!e.isFavorite&&a.isFavorite?1:a.timestamp.getTime()-e.timestamp.getTime();default:return 0}}),n(e)},[t,l,c,u,h]);const p=e=>{try{localStorage.setItem("ai-history",JSON.stringify(e)),o(e)}catch(a){Cs.error("Erro ao salvar histórico")}},f=async(e,a)=>{try{await navigator.clipboard.writeText(e),Cs.success(`${a} copiado para a área de transferência`)}catch(s){Cs.error("Erro ao copiar para a área de transferência")}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ta,{className:"h-5 w-5"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Histórico de IA"}),a.jsxs(mr,{variant:"outline",children:[i.length," itens"]})]}),a.jsxs(cr,{variant:"outline",size:"sm",onClick:()=>{window.confirm("Tem certeza que deseja limpar todo o histórico?")&&(p([]),Cs.success("Histórico limpo"))},disabled:0===t.length,className:"text-red-600 hover:text-red-700",children:[a.jsx(P,{className:"h-3 w-3 mr-1"}),"Limpar"]})]}),a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsxs(dt,{className:"text-base flex items-center gap-2",children:[a.jsx(_a,{className:"h-4 w-4"}),"Filtros"]})}),a.jsx(mt,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(Sr,{placeholder:"Buscar no histórico...",value:l,onChange:e=>d(e.target.value),className:"pl-10"})]}),a.jsxs(ao,{value:c,onValueChange:m,children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Todos os modelos"})}),a.jsxs(io,{children:[a.jsx(no,{value:"all",children:"Todos os modelos"}),a.jsx(no,{value:"creative",children:"IA Criativa"}),a.jsx(no,{value:"analytical",children:"IA Analítica"}),a.jsx(no,{value:"quick",children:"IA Rápida"}),a.jsx(no,{value:"specialized",children:"IA Especializada"})]})]}),a.jsxs(ao,{value:h,onValueChange:e=>g(e),children:[a.jsx(ro,{children:a.jsx(so,{})}),a.jsxs(io,{children:[a.jsx(no,{value:"date",children:"Mais recentes"}),a.jsx(no,{value:"model",children:"Por modelo"}),a.jsx(no,{value:"favorites",children:"Favoritos primeiro"})]})]}),a.jsxs(cr,{variant:u?"default":"outline",onClick:()=>x(!u),className:"flex items-center gap-2",children:[a.jsx(Ke,{className:"h-4 w-4 "+(u?"fill-current":"")}),"Favoritos"]})]})})]}),a.jsx("div",{className:"space-y-4",children:0===i.length?a.jsx(nt,{children:a.jsxs(mt,{className:"text-center py-8",children:[a.jsx(ta,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{className:"text-gray-500",children:0===t.length?"Nenhum histórico encontrado":"Nenhum item corresponde aos filtros aplicados"})]})}):i.map(e=>a.jsxs(nt,{className:"hover:shadow-md transition-shadow",children:[a.jsx(lt,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[Fi[e.model],a.jsx("span",{className:"font-medium",children:Oi[e.model]}),a.jsx(mr,{variant:"outline",className:"text-xs",children:e.settings.tone})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[a.jsx(le,{className:"h-3 w-3"}),Gs(e.timestamp,{addSuffix:!0,locale:Es})]}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(e=>{const a=t.map(a=>a.id===e?{...a,isFavorite:!a.isFavorite}:a);p(a),Cs.success("Favorito atualizado")})(e.id),children:e.isFavorite?a.jsx(Ke,{className:"h-4 w-4 fill-current text-yellow-500"}):a.jsx(Pa,{className:"h-4 w-4"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>(e=>{const a=t.filter(a=>a.id!==e);p(a),Cs.success("Item removido do histórico")})(e.id),className:"text-red-600 hover:text-red-700",children:a.jsx(P,{className:"h-4 w-4"})})]})]})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[a.jsx("p",{className:"font-medium mb-1",children:"Dados Originais:"}),a.jsxs("p",{children:[a.jsx("strong",{children:"Resumo:"})," ",e.formData.resumo]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Grau:"})," ",e.formData.grau]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Órgão:"})," ",e.formData.orgaoJulgador]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Problema:"})," ",e.formData.notas.substring(0,100),"..."]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Descrição Gerada"}),a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>f(e.description,"Descrição"),children:[a.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Copiar"]})]}),a.jsx("div",{className:"bg-blue-50 p-3 rounded text-sm whitespace-pre-wrap max-h-32 overflow-y-auto",children:e.description})]}),e.solution&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:"Solução Sugerida"}),a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>f(e.solution,"Solução"),children:[a.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Copiar"]})]}),a.jsx("div",{className:"bg-green-50 p-3 rounded text-sm whitespace-pre-wrap max-h-32 overflow-y-auto",children:e.solution})]}),a.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>s?.(e),className:"flex-1",children:"Ver Detalhes"}),a.jsx(cr,{size:"sm",onClick:()=>r?.(e),className:"flex-1",children:"Aplicar ao Formulário"})]})]})]},e.id))})]})},Ji=e.forwardRef(({className:e,...s},r)=>a.jsxs(Da,{ref:r,className:lr("relative flex w-full touch-none select-none items-center",e),...s,children:[a.jsx(za,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:a.jsx(Ia,{className:"absolute h-full bg-primary"})}),a.jsx(Ma,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ji.displayName=Da.displayName;const Ui={creativity:50,technicality:70,verbosity:60,includeExamples:!0,includeSuggestions:!0,autoImprove:!1,preferredModel:"analytical",customPrompt:"",outputFormat:"structured",tone:"profissional",priority:"alta",maxTokens:1e3,temperature:.7},qi=[{value:"creative",label:"IA Criativa",icon:a.jsx(D,{className:"h-4 w-4"}),description:"Mais criativa e inovadora"},{value:"analytical",label:"IA Analítica",icon:a.jsx(Oe,{className:"h-4 w-4"}),description:"Focada em análise e precisão"},{value:"quick",label:"IA Rápida",icon:a.jsx(Re,{className:"h-4 w-4"}),description:"Respostas rápidas e diretas"},{value:"specialized",label:"IA Especializada",icon:a.jsx(Aa,{className:"h-4 w-4"}),description:"Especializada em contexto jurídico"}],Vi=[{value:"profissional",label:"Profissional"},{value:"formal",label:"Formal"},{value:"tecnico",label:"Técnico"},{value:"amigavel",label:"Amigável"},{value:"conciso",label:"Conciso"}],Li=[{value:"baixa",label:"Baixa"},{value:"media",label:"Média"},{value:"alta",label:"Alta"},{value:"critica",label:"Crítica"}],$i=[{value:"structured",label:"Estruturado"},{value:"narrative",label:"Narrativo"},{value:"bullet_points",label:"Tópicos"},{value:"technical",label:"Técnico"}],Bi=({onSettingsChange:s,onClose:r})=>{const[t,o]=e.useState(Ui),[i,n]=e.useState({});e.useEffect(()=>{const e=localStorage.getItem("ai-advanced-settings"),a=localStorage.getItem("ai-settings-presets");if(e)try{o(JSON.parse(e))}catch(s){}if(a)try{n(JSON.parse(a))}catch(s){}},[]);const l=(e,a)=>{o(s=>({...s,[e]:a}))};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ie,{className:"h-5 w-5"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Configurações Avançadas de IA"})]}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:r,children:"✕"})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)] space-y-6",children:[a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsx(dt,{className:"text-base",children:"Presets Salvos"})}),a.jsxs(mt,{children:[a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Object.keys(i).map(e=>a.jsx(mr,{variant:"outline",className:"cursor-pointer hover:bg-blue-50",onClick:()=>(e=>{i[e]&&(o(i[e]),Cs.success(`Preset "${e}" carregado!`))})(e),children:e},e))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{size:"sm",onClick:()=>{const e=prompt("Nome do preset:");if(e){const a={...i,[e]:t};n(a),localStorage.setItem("ai-settings-presets",JSON.stringify(a)),Cs.success(`Preset "${e}" salvo!`)}},children:[a.jsx(z,{className:"h-3 w-3 mr-1"}),"Salvar Preset"]}),a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>{const e=JSON.stringify(t,null,2),a=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download="ai-settings.json",r.click(),URL.revokeObjectURL(s)},children:[a.jsx(Fa,{className:"h-3 w-3 mr-1"}),"Exportar"]}),a.jsxs("label",{className:"cursor-pointer",children:[a.jsx(cr,{size:"sm",variant:"outline",asChild:!0,children:a.jsxs("span",{children:[a.jsx(Oa,{className:"h-3 w-3 mr-1"}),"Importar"]})}),a.jsx("input",{type:"file",accept:".json",onChange:e=>{const a=e.target.files?.[0];if(a){const e=new FileReader;e.onload=e=>{try{const a=JSON.parse(e.target?.result);o(a),Cs.success("Configurações importadas com sucesso!")}catch(a){Cs.error("Erro ao importar configurações")}},e.readAsText(a)}},className:"hidden"})]})]})]})]}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsx(dt,{className:"text-base",children:"Modelo de IA"})}),a.jsx(mt,{children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:qi.map(e=>a.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors "+(t.preferredModel===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>l("preferredModel",e.value),children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.icon,a.jsx("span",{className:"font-medium",children:e.label})]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},e.value))})})]}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsx(dt,{className:"text-base",children:"Parâmetros de Geração"})}),a.jsxs(mt,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx(eo,{children:"Criatividade"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[t.creativity,"%"]})]}),a.jsx(Ji,{value:[t.creativity],onValueChange:([e])=>l("creativity",e),max:100,step:1,className:"w-full"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Controla o nível de criatividade nas respostas"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx(eo,{children:"Tecnicidade"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[t.technicality,"%"]})]}),a.jsx(Ji,{value:[t.technicality],onValueChange:([e])=>l("technicality",e),max:100,step:1,className:"w-full"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nível de detalhamento técnico"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx(eo,{children:"Verbosidade"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[t.verbosity,"%"]})]}),a.jsx(Ji,{value:[t.verbosity],onValueChange:([e])=>l("verbosity",e),max:100,step:1,className:"w-full"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Extensão das respostas geradas"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx(eo,{children:"Temperature"}),a.jsx("span",{className:"text-sm text-gray-500",children:t.temperature})]}),a.jsx(Ji,{value:[100*t.temperature],onValueChange:([e])=>l("temperature",e/100),max:100,step:1,className:"w-full"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Controla a aleatoriedade das respostas (0.0 - 1.0)"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"maxTokens",children:"Máximo de Tokens"}),a.jsx(Sr,{id:"maxTokens",type:"number",value:t.maxTokens,onChange:e=>l("maxTokens",parseInt(e.target.value)||1e3),min:100,max:4e3,className:"mt-1"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Limite máximo de tokens para a resposta"})]})]})]}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsx(dt,{className:"text-base",children:"Configurações de Conteúdo"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{children:"Tom da Resposta"}),a.jsxs(ao,{value:t.tone,onValueChange:e=>l("tone",e),children:[a.jsx(ro,{className:"mt-1",children:a.jsx(so,{})}),a.jsx(io,{children:Vi.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{children:[a.jsx(eo,{children:"Prioridade do Chamado"}),a.jsxs(ao,{value:t.priority,onValueChange:e=>l("priority",e),children:[a.jsx(ro,{className:"mt-1",children:a.jsx(so,{})}),a.jsx(io,{children:Li.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{children:[a.jsx(eo,{children:"Formato de Saída"}),a.jsxs(ao,{value:t.outputFormat,onValueChange:e=>l("outputFormat",e),children:[a.jsx(ro,{className:"mt-1",children:a.jsx(so,{})}),a.jsx(io,{children:$i.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(eo,{children:"Incluir Exemplos"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Adicionar exemplos práticos"})]}),a.jsx(Wt,{checked:t.includeExamples,onCheckedChange:e=>l("includeExamples",e)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(eo,{children:"Incluir Sugestões"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Adicionar sugestões de solução"})]}),a.jsx(Wt,{checked:t.includeSuggestions,onCheckedChange:e=>l("includeSuggestions",e)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(eo,{children:"Melhoria Automática"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Aplicar melhorias automáticas no texto"})]}),a.jsx(Wt,{checked:t.autoImprove,onCheckedChange:e=>l("autoImprove",e)})]})]})]})]}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsxs(dt,{className:"text-base flex items-center gap-2",children:["Prompt Personalizado",a.jsx(Ra,{className:"h-4 w-4 text-gray-400"})]})}),a.jsxs(mt,{children:[a.jsx(Nt,{value:t.customPrompt,onChange:e=>l("customPrompt",e.target.value),placeholder:"Adicione instruções específicas para a IA...",rows:4,className:"w-full"}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Instruções adicionais que serão incluídas em todas as gerações"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50",children:[a.jsxs(cr,{variant:"outline",onClick:()=>{o(Ui),Cs.info("Configurações restauradas para o padrão")},children:[a.jsx(Ja,{className:"h-4 w-4 mr-2"}),"Restaurar Padrão"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cr,{variant:"outline",onClick:r,children:"Cancelar"}),a.jsxs(cr,{onClick:()=>{try{localStorage.setItem("ai-advanced-settings",JSON.stringify(t)),s?.(t),Cs.success("Configurações salvas com sucesso!")}catch(e){Cs.error("Erro ao salvar configurações")}},children:[a.jsx(z,{className:"h-4 w-4 mr-2"}),"Salvar Configurações"]})]})]})]})})},Gi=e=>{const a=["notas"];for(const s of a)if(!e[s])return Cs.error(`Campo obrigatório não preenchido: ${s}`),!1;return("Outro (personalizado)"===e.resumo?e.resumoCustom:e.resumo)?!(e.cpfUsuario&&!(e=>{const a=e.replace(/\D/g,"");if(11!==a.length)return!1;if(/^(\d)\1{10}$/.test(a))return!1;let s=0;for(let t=0;t<9;t++)s+=parseInt(a[t])*(10-t);let r=10*s%11;if(10!==r&&11!==r||(r=0),r!==parseInt(a[9]))return!1;s=0;for(let t=0;t<10;t++)s+=parseInt(a[t])*(11-t);return r=10*s%11,10!==r&&11!==r||(r=0),r===parseInt(a[10])})(e.cpfUsuario))||(Cs.error("CPF inválido"),!1):(Cs.error("Campo obrigatório não preenchido: resumo"),!1)},Hi=e=>{if(!e)return e;let a=e.replace(/^[^:]*:\s*\n\n/,"");if(a=a.replace(/\*\*Processo:\*\*[^\n]*\n/g,""),a=a.replace(/\*\*Órgão Julgador:\*\*[^\n]*\n/g,""),a=a.replace(/\*\*Grau:\*\*[^\n]*\n/g,""),a.includes("**Problema:**")){const e=a.match(/\*\*Problema:\*\*\s*(.*?)(?:\*\*Detalhes:\*\*|$)/s);e&&(a=e[1].trim())}else a=a.replace(/\*\*Detalhes:\*\*\s*/g,"");return a=a.replace(/\n{3,}/g,"\n\n").trim(),a},Xi=()=>{const s=F(),[r]=Ua(),{salvarUsuario:t}=ji(),{salvarChamado:o}=_t(),i=!!r.get("editId"),[n,l]=e.useState({resumo:"",resumoCustom:"",grau:"",orgaoJulgador:"",perfilUsuario:"",cpfUsuario:"",nomeUsuario:"",processos:"",notas:"",chamadoOrigem:""}),[d,c]=e.useState(""),[m,u]=e.useState(!1),[x,h]=e.useState(!1),[g,p]=e.useState(""),[f,j]=e.useState(""),[b,v]=e.useState({}),[N,w]=e.useState(!1),[y,C]=e.useState(null),[k,E]=e.useState(!1),[S,T]=e.useState(!1),[A,_]=e.useState(!1),[P,D]=e.useState(!1),z=e.useRef(null);e.useEffect(()=>{const e=r.get("resumo"),a=r.get("grau"),s=r.get("processos"),t=r.get("orgaoJulgador"),o=r.get("perfilUsuario"),i=r.get("cpfUsuario"),n=r.get("nomeUsuario"),d=r.get("notas"),c=r.get("chamadoOrigem"),m=r.get("editId");if(e||a||s||d||c){l(r=>({...r,resumo:e||"",grau:a||"",processos:s||"",orgaoJulgador:t||"",perfilUsuario:o||"",cpfUsuario:i||"",nomeUsuario:n||"",notas:d?Hi(d):"",chamadoOrigem:c||""}));const r=m?"Dados carregados para edição!":"Template carregado com sucesso!";Cs.success(r)}},[r]);const I=e.useCallback((e,a)=>{const s={};switch(e){case"resumo":a&&""!==a||(s.resumo="Resumo é obrigatório");break;case"resumoCustom":"Outro (personalizado)"!==n.resumo||a&&""!==a||(s.resumoCustom="Resumo personalizado é obrigatório");break;case"grau":a&&""!==a||(s.grau="Grau é obrigatório");break;case"orgaoJulgador":a&&""!==a||(s.orgaoJulgador="Órgão julgador é obrigatório");break;case"notas":a&&""!==a||(s.notas="Descrição do problema é obrigatória")}return v(a=>{const r={...a};return s[e]?r[e]=s[e]:delete r[e],r}),0===Object.keys(s).length},[n.resumo]),M=e.useCallback(async e=>{if(k){w(!0);try{e.cpfUsuario&&e.nomeUsuario&&await t(e.cpfUsuario,e.nomeUsuario,e.perfilUsuario),await o({...e,isDraft:!0}),C(new Date),E(!1),Cs.success("Rascunho salvo automaticamente",{duration:2e3})}catch(a){}finally{w(!1)}}},[k,t,o]),O=e.useCallback(e=>{const a={...n,...e.dados};l(a),T(!1),E(!0),Cs.success(`Template "${e.nome}" aplicado com sucesso!`)},[n]),R=e.useCallback(e=>{_(!1),Cs.info("Item do histórico selecionado")},[]),J=e.useCallback(e=>{const a={...n,resumo:e.formData.resumo,grau:e.formData.grau,orgaoJulgador:e.formData.orgaoJulgador,notas:e.formData.notas};l(a),e.description&&p(e.description),e.solution&&j(e.solution),_(!1),E(!0),Cs.success("Dados do histórico aplicados ao formulário!")},[n]);e.useEffect(()=>()=>{z.current&&clearTimeout(z.current)},[]);const U=()=>{l({resumo:"",resumoCustom:"",grau:"",orgaoJulgador:"",perfilUsuario:"",cpfUsuario:"",nomeUsuario:"",processos:"",notas:"",chamadoOrigem:""}),c(""),u(!1),h(!1),p(""),j(""),Cs.info("Formulário resetado")},q=(e=>{const a=[{title:"Resumo",content:("Outro (personalizado)"===e.resumo?e.resumoCustom:e.resumo)+(e.processos?` - ${e.processos}`:""),key:"resumo",fullWidth:!0},{title:"Descrição do Problema",content:g?e.notas:Hi(e.notas),key:"notas",fullWidth:!0}];if(e.processos&&a.push({title:"Número dos processos",content:e.processos,key:"processos",fullWidth:!0}),e.chamadoOrigem&&a.push({title:"Número do Chamado de Origem",content:e.chamadoOrigem,key:"chamadoOrigem",fullWidth:!0}),e.perfilUsuario||e.cpfUsuario||e.nomeUsuario||e.orgaoJulgador&&"1º Grau"===e.grau){const s=[];if(e.nomeUsuario&&s.push(e.nomeUsuario),e.cpfUsuario&&s.push(e.cpfUsuario),e.perfilUsuario&&s.push(e.perfilUsuario),e.orgaoJulgador&&"1º Grau"===e.grau){const a=e=>e.replace(/^\d+\s*-\s*/,"").trim();s.push(a(e.orgaoJulgador))}a.push({title:"Dados do Usuário",content:s.join(" / "),key:"usuario",fullWidth:!0})}return a})(n);return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-4",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx(Lo,{title:i?"Editar Chamado":"Criar Chamado",subtitle:"Gerador de Issues JIRA"}),a.jsxs("div",{className:"relative max-w-4xl mx-auto",children:[a.jsxs("div",{className:"transition-all duration-500 ease-in-out "+(m?"opacity-0 scale-95 pointer-events-none absolute inset-0":"opacity-100 scale-100"),children:[a.jsx(yi,{formData:n,onInputChange:(e,a)=>{const s={...n,[e]:a};l(s),u(!1),E(!0),I(e,a),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{M(s)},3e3)},onMultipleInputChange:e=>{const a={...n,...e};l(a),u(!1),E(!0),Object.entries(e).forEach(([e,a])=>{"string"!=typeof a&&"boolean"!=typeof a||I(e,a)}),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{M(a)},3e3)},onGenerateDescription:async()=>{Gi(n)&&(n.cpfUsuario&&n.nomeUsuario&&await t(n.cpfUsuario,n.nomeUsuario,n.perfilUsuario),await o(n),h(!0))},onResetForm:U,validationErrors:b}),a.jsx(Mi,{formData:n})]}),a.jsxs("div",{className:"transition-all duration-500 ease-in-out "+(m?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none absolute inset-0"),children:[a.jsx(Ci,{isGenerated:m,sections:q,generatedDescription:d}),m&&a.jsxs("div",{className:"mt-6 text-center space-x-4",children:[a.jsx(cr,{onClick:U,variant:"outline",className:"px-6 py-2",children:"Criar Novo Chamado"}),a.jsx(cr,{onClick:()=>s("/"),variant:"secondary",className:"px-6 py-2",children:"Voltar ao Início"})]})]})]}),a.jsx(Ti,{open:x,onOpenChange:h,formData:n,onProceedToGenerate:()=>{h(!1);const e=(e=>{let a="";if(a+=`Descrição do Problema:\n\n${Hi(e.notas)}\n\n`,e.perfilUsuario||e.cpfUsuario||e.nomeUsuario||e.orgaoJulgador&&"1º Grau"===e.grau){a+="Dados do Usuário:\n\n";const s=[];e.nomeUsuario&&s.push(e.nomeUsuario),e.cpfUsuario&&s.push(e.cpfUsuario),e.perfilUsuario&&s.push(e.perfilUsuario),e.orgaoJulgador&&"1º Grau"===e.grau&&s.push(e.orgaoJulgador.replace(/^\d+\s*-\s*/,"").trim()),a+=`${s.join(" / ")}\n\n`}return e.chamadoOrigem&&(a+=`Chamado Origem: ${e.chamadoOrigem}\n\n`),a.trim()})(n);c(e),u(!0),Cs.success("Descrição gerada com sucesso!")}}),S&&a.jsx(_i,{onSelectTemplate:O,onClose:()=>T(!1)}),A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Histórico de IA"}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>_(!1),children:"✕"})]}),a.jsx("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-80px)]",children:a.jsx(Ri,{onSelectItem:R,onApplyToForm:J})})]})}),P&&a.jsx(Bi,{onSettingsChange:e=>{Cs.success("Configurações de IA atualizadas!")},onClose:()=>D(!1)})]})})},Qi=({searchTerm:e,setSearchTerm:s,selectedCategory:r,setSelectedCategory:t,categories:o})=>a.jsx(nt,{className:"mb-6 shadow-soft border-0 bg-card/80 backdrop-blur-sm",children:a.jsx(mt,{className:"p-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Sr,{placeholder:"Pesquisar por título, problema, solução ou tags...",value:e,onChange:e=>s(e.target.value),className:"pl-10 border-0 bg-background/50 focus:bg-background transition-colors duration-200"})]})}),a.jsx("div",{className:"w-full md:w-64",children:a.jsxs(ao,{value:r,onValueChange:t,children:[a.jsx(ro,{className:"border-0 bg-background/50 focus:bg-background transition-colors duration-200",children:a.jsx(so,{placeholder:"Filtrar por categoria"})}),a.jsxs(io,{className:"border-0 shadow-large",children:[a.jsx(no,{value:"all",children:"Todas as categorias"}),o.map(e=>a.jsx(no,{value:e,children:e},e))]})]})})]})})}),Ki=({item:s,onEdit:r,onDelete:t,onIncrementView:o,onIncrementUtil:i})=>{const{user:n}=tt(),[l,d]=e.useState(!1);return e.useEffect(()=>{(async()=>{if(n){const{data:e}=await dr.from("profiles").select("is_admin").eq("id",n.id).single();d(e?.is_admin||!1)}})()},[n]),a.jsxs(nt,{className:"hover:shadow-large transition-all duration-300 hover:scale-[1.02] border-0 shadow-soft bg-card/90 backdrop-blur-sm group",children:[a.jsx(lt,{className:"pb-3",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(dt,{className:"text-xl mb-3 group-hover:text-primary transition-colors duration-200",children:s.titulo}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[a.jsx(Wr,{children:a.jsxs(Zr,{children:[a.jsx(et,{asChild:!0,children:a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>o?.(s.id),className:"flex items-center gap-1 h-auto p-1 hover:text-primary hover:bg-primary/10 transition-all duration-200",children:[a.jsx(oa,{className:"h-4 w-4"}),s.visualizacoes||0," visualizações"]})}),a.jsx(at,{children:a.jsx("p",{children:"Clique para incrementar visualizações"})})]})}),a.jsx(Wr,{children:a.jsxs(Zr,{children:[a.jsx(et,{asChild:!0,children:a.jsxs(cr,{variant:"ghost",size:"sm",onClick:()=>i?.(s.id),className:"flex items-center gap-1 h-auto p-1 hover:text-green-600 hover:bg-green-500/10 transition-all duration-200",children:[a.jsx(qa,{className:"h-4 w-4"}),s.util_count||0," úteis"]})}),a.jsx(at,{children:a.jsx("p",{children:"Marcar como útil"})})]})}),s.categoria&&a.jsx(mr,{variant:"outline",className:"border-primary/20 text-primary bg-primary/10",children:s.categoria})]})]}),l&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(s),className:"text-muted-foreground hover:text-primary hover:bg-primary/10 transition-all duration-200",children:a.jsx(Me,{className:"h-4 w-4"})}),t&&a.jsxs(ur,{children:[a.jsx(xr,{asChild:!0,children:a.jsx(cr,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-all duration-200",children:a.jsx(P,{className:"h-4 w-4"})})}),a.jsxs(hr,{children:[a.jsxs(gr,{children:[a.jsx(pr,{children:"Confirmar Exclusão"}),a.jsxs(fr,{children:["Tem certeza que deseja excluir este item da base de conhecimento? Esta ação não pode ser desfeita.",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Título:"})," ",s.titulo]})]}),a.jsxs(jr,{children:[a.jsx(br,{children:"Cancelar"}),a.jsx(vr,{onClick:()=>t(s.id),className:"bg-destructive hover:bg-destructive/90",children:"Excluir"})]})]})]})]})]})}),a.jsx(mt,{className:"pt-0",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-destructive/5 border-l-4 border-destructive pl-4 py-2 rounded-r",children:[a.jsxs("h4",{className:"font-semibold text-destructive mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-destructive rounded-full"}),"Problema:"]}),a.jsx("p",{className:"text-foreground/80 leading-relaxed",children:s.problema_descricao})]}),a.jsxs("div",{className:"bg-green-500/5 border-l-4 border-green-500 pl-4 py-2 rounded-r",children:[a.jsxs("h4",{className:"font-semibold text-green-600 mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Solução:"]}),a.jsx("p",{className:"text-foreground/80 whitespace-pre-wrap leading-relaxed",children:s.solucao})]}),s.arquivo_print&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Va,{className:"h-4 w-4 text-primary"}),a.jsx("span",{children:"Print/Screenshot anexado:"})]}),a.jsx("div",{className:"border rounded-lg overflow-hidden bg-muted/20",children:a.jsx("img",{src:`https://zpufcvesenbhtmizmjiz.supabase.co/storage/v1/object/public/knowledge-base-files/${s.arquivo_print}`,alt:"Print do problema/solução",className:"w-full max-h-64 object-contain cursor-pointer hover:scale-105 transition-transform duration-300",onClick:()=>window.open(`https://zpufcvesenbhtmizmjiz.supabase.co/storage/v1/object/public/knowledge-base-files/${s.arquivo_print}`,"_blank")})})]}),s.tags&&s.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:s.tags.map((e,s)=>a.jsx(mr,{variant:"secondary",className:"text-xs bg-primary/10 text-primary border-primary/20 hover:bg-primary/20 transition-colors duration-200",children:e},s))})]})})]})},Yi=({files:s,onFilesChange:r,maxFiles:t=3,maxFileSize:o=10})=>{const[n,l]=e.useState(!1),[d,c]=e.useState(null),m=e.useRef(null),u=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?l(!0):"dragleave"===e.type&&l(!1)},x=e=>{const a=[],i=["image/jpeg","image/jpg","image/png","image/gif","image/webp"];for(const r of e){if(s.length+a.length>=t){Cs.error(`Máximo de ${t} arquivos permitidos`);break}r.name.replace(/[^a-zA-Z0-9.-]/g,"_").length>255?Cs.error(`Nome do arquivo ${r.name} é muito longo`):i.includes(r.type)?r.size>1024*o*1024?Cs.error(`Arquivo ${r.name} excede o tamanho máximo de ${o}MB`):r.size<100?Cs.error(`Arquivo ${r.name} é muito pequeno`):s.some(e=>e.name===r.name&&e.size===r.size)?Cs.error(`Arquivo ${r.name} já foi adicionado`):a.push(r):Cs.error(`Arquivo ${r.name} não é um tipo de imagem permitido (JPEG, PNG, GIF, WebP)`)}a.length>0&&(r([...s,...a]),Cs.success(`${a.length} arquivo(s) adicionado(s)`))},h=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},g=e=>URL.createObjectURL(e);return a.jsxs("div",{className:"space-y-4",children:[a.jsxs(eo,{children:["Imagens (máximo ",t,")"]}),a.jsxs("div",{className:"relative border-2 border-dashed rounded-lg p-6 text-center transition-colors "+(n?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"),onDragEnter:u,onDragLeave:u,onDragOver:u,onDrop:e=>{e.preventDefault(),e.stopPropagation(),l(!1);const a=Array.from(e.dataTransfer.files);x(a)},children:[a.jsx("input",{ref:m,type:"file",multiple:!0,accept:"image/*",onChange:e=>{const a=Array.from(e.target.files||[]);x(a)},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Oa,{className:"mx-auto h-8 w-8 text-gray-400"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Clique para selecionar"})," ou arraste arquivos aqui"]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Formatos aceitos: PNG, JPG, JPEG, GIF, WebP",a.jsx("br",{}),"Máximo ",o,"MB por arquivo"]})]})]}),s.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs(eo,{children:["Arquivos selecionados (",s.length,"/",t,")"]}),a.jsx("div",{className:"grid gap-2",children:s.map((e,t)=>a.jsx(nt,{className:"p-3",children:a.jsx(mt,{className:"p-0",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Va,{className:"h-4 w-4"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.name}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[a.jsx(mr,{variant:"outline",className:"text-xs",children:"Imagem"}),a.jsx("span",{children:h(e.size)})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(wr,{children:[a.jsx(Tr,{asChild:!0,children:a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>c(e),children:a.jsx(oa,{className:"h-4 w-4"})})}),a.jsxs(yr,{className:"max-w-4xl",children:[a.jsx(Cr,{children:a.jsx(kr,{children:e.name})}),a.jsx("div",{className:"flex justify-center",children:a.jsx("img",{src:g(e),alt:e.name,className:"max-w-full max-h-[70vh] object-contain"})})]})]}),a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>(e=>{const a=s.filter((a,s)=>s!==e);r(a)})(t),className:"text-red-600 hover:text-red-700",children:a.jsx(i,{className:"h-4 w-4"})})]})]})})},t))})]}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["💡 ",a.jsx("strong",{children:"Dicas:"}),a.jsx("br",{}),"• Use imagens para mostrar prints de tela, capturas de erro, interfaces",a.jsx("br",{}),"• Organize as imagens na ordem que faz mais sentido para o entendimento",a.jsx("br",{}),"• Prefira imagens claras e com boa resolução"]})]})},Wi=({isOpen:e,onOpenChange:s,editingItem:r,formData:t,setFormData:o,categories:n,onSubmit:l,onCancel:d})=>a.jsx(wr,{open:e,onOpenChange:s,children:a.jsxs(yr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(Cr,{children:[a.jsx(kr,{children:r?"Editar Item":"Novo Item da Base de Conhecimento"}),a.jsx(Er,{children:"Adicione informações para ajudar na resolução de problemas futuros"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"titulo",children:"Título *"}),a.jsx(Sr,{id:"titulo",value:t.titulo,onChange:e=>o(a=>({...a,titulo:e.target.value})),placeholder:"Título descritivo do problema/solução"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"categoria",children:"Categoria"}),a.jsxs(ao,{value:t.categoria,onValueChange:e=>o(a=>({...a,categoria:e})),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione uma categoria"})}),a.jsx(io,{children:n.map(e=>a.jsx(no,{value:e,children:e},e))})]})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"problema",children:"Descrição do Problema *"}),a.jsx(Nt,{id:"problema",value:t.problema_descricao,onChange:e=>o(a=>({...a,problema_descricao:e.target.value})),placeholder:"Descreva detalhadamente o problema...",rows:4})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"solucao",children:"Solução *"}),a.jsx(Nt,{id:"solucao",value:t.solucao,onChange:e=>o(a=>({...a,solucao:e.target.value})),placeholder:"Descreva a solução passo a passo...",rows:6})]}),a.jsx("div",{children:a.jsx(Yi,{files:t.images||[],onFilesChange:e=>o(a=>({...a,images:e})),maxFiles:3,maxFileSize:10})}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"tags",children:"Tags"}),a.jsx("div",{className:"flex gap-2 mb-2",children:a.jsx(Sr,{placeholder:"Digite uma tag e pressione Enter",onKeyPress:e=>{var a;"Enter"===e.key&&(e.preventDefault(),(a=e.currentTarget.value)&&!t.tags.includes(a)&&o(e=>({...e,tags:[...e.tags,a]})),e.currentTarget.value="")}})}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((e,s)=>a.jsxs(mr,{variant:"secondary",className:"flex items-center gap-1",children:[e,a.jsx(i,{className:"h-3 w-3 cursor-pointer",onClick:()=>{return a=e,void o(e=>({...e,tags:e.tags.filter(e=>e!==a)}));var a}})]},s))})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx(cr,{variant:"outline",onClick:d,children:"Cancelar"}),a.jsx(cr,{onClick:l,children:r?"Atualizar":"Salvar"})]})]})}),Zi=({isOpen:s,onOpenChange:r,onSaveItems:t})=>{const[o,i]=e.useState(null),[n,l]=e.useState([]),[d,c]=e.useState(!1),[m,u]=e.useState(null),x=(e,a)=>{l(s=>s.map((s,r)=>r===e?{...s,...a}:s)),u(null)};return a.jsx(wr,{open:s,onOpenChange:r,children:a.jsxs(yr,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(Cr,{children:[a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(Oa,{className:"h-5 w-5"}),"Upload em Lote - PDF"]}),a.jsx(Er,{children:"Faça upload de um PDF com anotações de problemas e extraia automaticamente múltiplos itens para a base de conhecimento"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"pdfFile",children:"Arquivo PDF"}),a.jsx(Sr,{id:"pdfFile",type:"file",accept:".pdf",onChange:e=>{const a=e.target.files?.[0];if(!a)return;if("application/pdf"!==a.type)return Cs.error("Por favor, selecione apenas arquivos PDF válidos"),void(e.target.value="");if(a.size>10485760)return Cs.error("Arquivo muito grande. Máximo permitido: 10MB"),void(e.target.value="");if(a.size<1024)return Cs.error("Arquivo muito pequeno ou corrompido"),void(e.target.value="");if(a.name.replace(/[^a-zA-Z0-9.-]/g,"_").length>255)return Cs.error("Nome do arquivo muito longo"),void(e.target.value="");i(a),l([])}})]}),o&&a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-accent rounded-lg border",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{className:"h-5 w-5 text-primary"}),a.jsx("span",{className:"font-medium",children:o.name})]}),a.jsx(cr,{onClick:async()=>{if(o){c(!0);try{const e=new FormData;e.append("file",o);const a="https://zpufcvesenbhtmizmjiz.supabase.co",s="YOUR_ANON_KEY_HERE",r=await fetch(`${a}/functions/v1/extract-multiple-knowledge-items`,{method:"POST",headers:{Authorization:`Bearer ${s}`},body:e}),t=await r.json();if(!t.success)throw new Error(t.error||"Erro ao processar PDF");{const e=t.data.map(e=>({...e,selected:!0}));l(e),Cs.success(`${t.totalItems} problemas/soluções extraídos do PDF!`)}}catch(e){Cs.error("Erro ao processar PDF. Verifique se a chave da OpenAI está configurada.")}finally{c(!1)}}else Cs.error("Selecione um arquivo PDF primeiro")},disabled:d,variant:"default",children:d?"Processando...":"Extrair Conteúdo"})]})]}),n.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Itens Extraídos (",n.length,")"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>l(e=>e.map(e=>({...e,selected:!0}))),children:"Selecionar Todos"}),a.jsx(cr,{variant:"outline",size:"sm",onClick:()=>l(e=>e.map(e=>({...e,selected:!1}))),children:"Desmarcar Todos"})]})]}),a.jsx("div",{className:"grid gap-4 max-h-[400px] overflow-y-auto",children:n.map((e,s)=>a.jsxs(nt,{className:""+(e.selected?"ring-2 ring-primary":""),children:[a.jsx(lt,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",checked:e.selected||!1,onChange:()=>(e=>{l(a=>a.map((a,s)=>s===e?{...a,selected:!a.selected}:a))})(s),className:"w-4 h-4"}),m===s?a.jsx(Sr,{value:e.titulo,onChange:e=>x(s,{titulo:e.target.value}),className:"font-semibold"}):a.jsx(dt,{className:"text-lg",children:e.titulo})]}),a.jsx("div",{className:"flex gap-2",children:m===s?a.jsx(cr,{size:"sm",variant:"outline",onClick:()=>u(null),children:a.jsx(z,{className:"h-4 w-4"})}):a.jsx(cr,{size:"sm",variant:"outline",onClick:()=>u(s),children:a.jsx(Me,{className:"h-4 w-4"})})})]})}),a.jsxs(mt,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-destructive mb-1",children:"Problema:"}),m===s?a.jsx(Nt,{value:e.problema_descricao,onChange:e=>x(s,{problema_descricao:e.target.value}),rows:2}):a.jsx("p",{className:"text-sm text-muted-foreground",children:e.problema_descricao})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-green-600 mb-1",children:"Solução:"}),m===s?a.jsx(Nt,{value:e.solucao,onChange:e=>x(s,{solucao:e.target.value}),rows:3}):a.jsx("p",{className:"text-sm text-muted-foreground",children:e.solucao})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mr,{variant:"outline",children:e.categoria}),e.tags.map((e,s)=>a.jsx(mr,{variant:"secondary",className:"text-xs",children:e},s))]})]})]},s))}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx(cr,{variant:"outline",onClick:()=>r(!1),children:"Cancelar"}),a.jsxs(cr,{onClick:async()=>{const e=n.filter(e=>e.selected);if(0===e.length)return void Cs.error("Selecione pelo menos um item para salvar");const a=e.map(e=>({titulo:e.titulo,problema_descricao:e.problema_descricao,solucao:e.solucao,categoria:e.categoria,tags:e.tags,arquivo_print:null,images:[]}));try{await t(a),Cs.success(`${e.length} itens salvos na base de conhecimento!`),r(!1),i(null),l([])}catch(s){Cs.error("Erro ao salvar itens")}},disabled:0===n.filter(e=>e.selected).length,children:["Salvar Selecionados (",n.filter(e=>e.selected).length,")"]})]})]})]})]})})},en=({searchTerm:e,selectedCategory:s})=>{const r=e||s&&"all"!==s;return a.jsxs("div",{className:"text-center py-16",children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-primary rounded-full blur-2xl opacity-10"}),a.jsx(aa,{className:"relative h-20 w-20 text-muted-foreground mx-auto"})]}),a.jsx("h3",{className:"text-2xl font-semibold text-foreground mb-2",children:r?"Nenhum item encontrado":"Nenhum item cadastrado ainda"}),a.jsx("p",{className:"text-muted-foreground text-lg max-w-md mx-auto",children:r?"Tente ajustar os filtros de pesquisa para encontrar o que procura":"Comece adicionando o primeiro item à base de conhecimento"})]})},an=()=>{const s=F(),[r,t]=Ua(),{items:o,categories:i,isLoading:n,saveItem:l,deleteItem:d,incrementView:c,incrementUtil:m}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState([]),[o,i]=e.useState(!0);e.useEffect(()=>{l(),n()},[]);const n=async()=>{try{const{data:e,error:a}=await dr.from("base_conhecimento").select("categoria").not("categoria","is",null).order("categoria");if(a)throw a;const s=["PJe-1o.Grau","PJe-2o.Grau","Outros"],r=[...new Set(e.map(e=>e.categoria))].filter(Boolean),o=[...new Set([...s,...r])];t(o)}catch(e){t(["PJe-1o.Grau","PJe-2o.Grau","Outros"])}},l=async()=>{try{i(!0);const{data:e,error:a}=await dr.from("base_conhecimento").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(e||[]).map(e=>({...e}));s(r)}catch(e){Cs.error("Erro ao carregar base de conhecimento")}finally{i(!1)}};return{items:a,categories:r,isLoading:o,fetchItems:l,saveItem:async(e,a)=>{try{if(!e.titulo||!e.problema_descricao||!e.solucao)return Cs.error("Preencha todos os campos obrigatórios"),!1;let s="";if(e.images&&e.images.length>0){const a=e.images[0],r=a.name.split(".").pop(),t=`${Date.now()}.${r}`,{data:o,error:i}=await dr.storage.from("knowledge-base-files").upload(t,a);if(i)throw i;s=o.path}else if(e.arquivo_print){const a=e.arquivo_print.name.split(".").pop(),r=`${Date.now()}.${a}`,{data:t,error:o}=await dr.storage.from("knowledge-base-files").upload(r,e.arquivo_print);if(o)throw o;s=t.path}if(a){const{error:r}=await dr.from("base_conhecimento").update({titulo:e.titulo,problema_descricao:e.problema_descricao,solucao:e.solucao,categoria:e.categoria||null,tags:e.tags.length>0?e.tags:null,arquivo_print:s||null}).eq("id",a.id);if(r)throw r;Cs.success("Item atualizado com sucesso!")}else{const{error:a}=await dr.from("base_conhecimento").insert({titulo:e.titulo,problema_descricao:e.problema_descricao,solucao:e.solucao,categoria:e.categoria||null,tags:e.tags.length>0?e.tags:null,arquivo_print:s||null});if(a)throw a;Cs.success("Item adicionado com sucesso!")}return l(),n(),!0}catch(s){return Cs.error("Erro ao salvar item"),!1}},deleteItem:async e=>{try{const{error:a}=await dr.from("base_conhecimento").delete().eq("id",e);if(a)throw a;return s(a=>a.filter(a=>a.id!==e)),Cs.success("Item excluído com sucesso!"),!0}catch(a){return Cs.error("Erro ao excluir item"),!1}},incrementView:async e=>{try{const r=a.find(a=>a.id===e);if(r){const{error:a}=await dr.from("base_conhecimento").update({visualizacoes:(r.visualizacoes||0)+1}).eq("id",e);if(a)throw a;s(a=>a.map(a=>a.id===e?{...a,visualizacoes:(a.visualizacoes||0)+1}:a))}}catch(r){}},incrementUtil:async e=>{try{const r=a.find(a=>a.id===e);if(r){const{error:a}=await dr.from("base_conhecimento").update({util_count:(r.util_count||0)+1}).eq("id",e);if(a)throw a;Cs.success("Marcado como útil!"),s(a=>a.map(a=>a.id===e?{...a,util_count:(a.util_count||0)+1}:a))}}catch(r){Cs.error("Erro ao marcar como útil")}}}})(),[u,x]=e.useState(""),[h,g]=e.useState("all");e.useEffect(()=>{const e=r.get("search");e&&x(decodeURIComponent(e))},[r]);const[p,f]=e.useState(!1),[j,b]=e.useState(!1),[v,N]=e.useState(null),[w,y]=e.useState({titulo:"",problema_descricao:"",solucao:"",categoria:"",tags:[],arquivo_print:null,media_files:[]}),C=o.filter(e=>{const a=!u||e.titulo.toLowerCase().includes(u.toLowerCase())||e.problema_descricao.toLowerCase().includes(u.toLowerCase())||e.solucao.toLowerCase().includes(u.toLowerCase())||e.tags&&e.tags.some(e=>e.toLowerCase().includes(u.toLowerCase())),s="all"===h||e.categoria===h;return a&&s}),k=e=>{N(e),y({titulo:e.titulo,problema_descricao:e.problema_descricao,solucao:e.solucao,categoria:e.categoria||"",tags:e.tags||[],arquivo_print:null,media_files:[]}),f(!0)},E=async e=>{await d(e)};return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsxs("div",{className:"flex items-center justify-center mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-primary rounded-full blur-xl opacity-20"}),a.jsx(aa,{className:"relative h-16 w-16 text-primary mr-4"})]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-5xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Base de Conhecimento"}),a.jsx("p",{className:"text-xl text-muted-foreground mt-2",children:"Núcleo de Apoio ao PJe - TRT15"})]})]}),a.jsx(mr,{variant:"secondary",className:"mt-2 px-4 py-2 text-sm shadow-soft",children:"Pesquise soluções antes de abrir chamados"})]}),a.jsx(Qi,{searchTerm:u,setSearchTerm:x,selectedCategory:h,setSelectedCategory:g,categories:i}),a.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[a.jsxs(cr,{variant:"outline",onClick:()=>s("/"),className:"bg-background/80 hover:bg-background border-border/50 hover:border-border shadow-soft transition-all duration-300 hover:shadow-medium",children:[a.jsx(fa,{className:"h-4 w-4 mr-2"}),"Voltar ao Início"]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Qt,{}),a.jsx(Yt,{}),a.jsxs(cr,{variant:"outline",onClick:()=>b(!0),className:"flex items-center gap-2 bg-background/80 hover:bg-background border-border/50 hover:border-border shadow-soft transition-all duration-300 hover:shadow-medium",children:[a.jsx(Oa,{className:"h-4 w-4"}),"Upload PDF"]}),a.jsxs(wr,{open:p,onOpenChange:f,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{className:"bg-gradient-primary hover:opacity-90 shadow-medium transition-all duration-300 hover:shadow-large hover:scale-105",children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Novo Item"]})}),a.jsx(Wi,{isOpen:p,onOpenChange:f,editingItem:v,formData:w,setFormData:y,categories:i,onSubmit:async()=>{await l(w,v)&&(f(!1),N(null),y({titulo:"",problema_descricao:"",solucao:"",categoria:"",tags:[],arquivo_print:null,media_files:[]}))},onCancel:()=>{f(!1),N(null),y({titulo:"",problema_descricao:"",solucao:"",categoria:"",tags:[],arquivo_print:null,media_files:[]})}})]})]}),a.jsx(Zi,{isOpen:j,onOpenChange:b,onSaveItems:async e=>{for(const a of e)await l(a,null)}})]}),n?a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-gray-600",children:"Carregando..."})}):a.jsxs("div",{className:"grid gap-6",children:[C.map(e=>a.jsx(Ki,{item:e,onEdit:k,onDelete:E,onIncrementView:c,onIncrementUtil:m},e.id)),0===C.length&&a.jsx(en,{searchTerm:u,selectedCategory:h})]})]})})},sn=({chamado:e,onCopiar:s,onTemplate:r,onDuplicar:t,onEditar:o,onExcluir:i,isHighlighted:n=!1,searchTerm:l=""})=>{const d=(e,s)=>{if(!s||!e)return e;const r=new RegExp(`(${s})`,"gi");return e.split(r).map((e,s)=>r.test(e)?a.jsx("mark",{className:"bg-yellow-200 dark:bg-yellow-800 px-1 rounded",children:e},s):e)};return a.jsxs(nt,{className:"hover:shadow-lg transition-all duration-500 bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320] "+(n?"ring-2 ring-blue-500 ring-opacity-50 shadow-lg bg-blue-50 dark:bg-blue-900/20 animate-pulse":""),children:[a.jsx(lt,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(dt,{className:"text-lg text-[#7c6a3c] dark:text-[#f8f5e4]",children:d(e.titulo,l)}),a.jsxs(ct,{className:"flex items-center mt-2 text-[#bfae7c] dark:text-[#bfae7c]",children:[a.jsx(h,{className:"h-4 w-4 mr-1"}),Gs(new Date(e.created_at),{addSuffix:!0,locale:Es})]})]}),a.jsx(mr,{className:`${Dt(e.status)} text-white`,children:e.status||"Sem status"})]})}),a.jsx(mt,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4] mb-1",children:"Descrição do Problema"}),a.jsx("p",{className:"text-[#7c6a3c] dark:text-[#f8f5e4] text-sm bg-[#f3ecd2] dark:bg-[#23201a] p-3 rounded border border-[#e2d8b8] dark:border-[#3a3320]",children:d(e.descricao,l)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-3 border-t border-[#e2d8b8] dark:border-[#3a3320]",children:[e.grau&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Grau:"}),a.jsx("span",{className:"ml-2 text-[#bfae7c] dark:text-[#bfae7c]",children:e.grau})]}),e.numero_processo&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Processo:"}),a.jsx("span",{className:"ml-2 text-[#bfae7c] dark:text-[#bfae7c] font-mono",children:d(e.numero_processo,l)})]}),e.chamado_origem&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Chamado Origem:"}),a.jsx("span",{className:"ml-2 text-[#bfae7c] dark:text-[#bfae7c] font-mono",children:e.chamado_origem})]}),e.orgao_julgador&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Órgão Julgador:"}),a.jsx("span",{className:"ml-2 text-[#bfae7c] dark:text-[#bfae7c]",children:d(e.orgao_julgador,l)})]})]}),Pt(e)&&a.jsx("div",{className:"border-t border-[#e2d8b8] dark:border-[#3a3320] pt-3",children:a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(se,{className:"h-4 w-4 mr-2 text-[#bfae7c] dark:text-[#bfae7c]"}),a.jsx("span",{className:"font-medium text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Usuário:"}),a.jsx("span",{className:"ml-2 text-[#bfae7c] dark:text-[#bfae7c] text-sm",children:Pt(e)})]})}),a.jsx("div",{className:"border-t border-[#e2d8b8] dark:border-[#3a3320] pt-4",children:a.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>s(e),className:"text-[#7c6a3c] dark:text-[#f8f5e4] border-[#e2d8b8] dark:border-[#3a3320] bg-[#f8f5e4] dark:bg-[#2d2717] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a]",children:[a.jsx(Ta,{className:"h-4 w-4 mr-1"}),"Copiar"]}),a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>r(e),className:"text-blue-600 dark:text-blue-400 border-blue-600 dark:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:[a.jsx(na,{className:"h-4 w-4 mr-1"}),"Template"]}),a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>t(e),className:"text-purple-600 dark:text-purple-400 border-purple-600 dark:border-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/20",children:[a.jsx(Ve,{className:"h-4 w-4 mr-1"}),"Duplicar"]}),a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>o(e),className:"text-green-600 dark:text-green-400 border-green-600 dark:border-green-400 hover:bg-green-50 dark:hover:bg-green-900/20",children:[a.jsx(Me,{className:"h-4 w-4 mr-1"}),"Editar"]}),a.jsxs(ur,{children:[a.jsx(xr,{asChild:!0,children:a.jsxs(cr,{size:"sm",variant:"outline",className:"text-red-600 dark:text-red-400 border-red-600 dark:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[a.jsx(Le,{className:"h-4 w-4 mr-1"}),"Excluir"]})}),a.jsxs(hr,{className:"bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320]",children:[a.jsxs(gr,{children:[a.jsx(pr,{className:"text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Confirmar exclusão"}),a.jsx(fr,{className:"text-[#bfae7c] dark:text-[#bfae7c]",children:"Tem certeza que deseja excluir este chamado? Esta ação não pode ser desfeita."})]}),a.jsxs(jr,{children:[a.jsx(br,{className:"text-[#7c6a3c] dark:text-[#f8f5e4] border-[#e2d8b8] dark:border-[#3a3320] bg-[#f8f5e4] dark:bg-[#2d2717] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a]",children:"Cancelar"}),a.jsx(vr,{onClick:()=>i(e.id),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})]})]})})]})})]})},rn=()=>{const s=F(),[r]=Ua(),[t,o]=e.useState(""),[i,n]=e.useState(null);e.useEffect(()=>{const e=r.get("search"),a=r.get("highlight");e&&o(e),a&&(n(a),setTimeout(()=>{n(null)},5e3))},[r]);const{chamados:l,loading:d,handleCopiarDescricao:c,criarTemplateDoChamado:m,duplicarChamado:u,editarChamado:x,handleExcluirChamado:h}=zt(),g=e.useMemo(()=>{if(!t.trim())return l;const e=t.toLowerCase();return l.filter(a=>a.titulo.toLowerCase().includes(e)||a.descricao.toLowerCase().includes(e)||a.numero_processo&&a.numero_processo.toLowerCase().includes(e)||a.orgao_julgador&&a.orgao_julgador.toLowerCase().includes(e)||a.nome_usuario_afetado&&a.nome_usuario_afetado.toLowerCase().includes(e)||a.cpf_usuario_afetado&&a.cpf_usuario_afetado.toLowerCase().includes(e)||a.chamado_origem&&a.chamado_origem.toLowerCase().includes(e))},[l,t]);return a.jsx("div",{className:"min-h-screen bg-[#f8f5e4] dark:bg-[#23201a] p-4",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsxs(cr,{variant:"outline",onClick:()=>s("/"),className:"mr-4 text-[#7c6a3c] dark:text-[#f8f5e4] border-[#e2d8b8] dark:border-[#3a3320] bg-[#f8f5e4] dark:bg-[#2d2717] hover:bg-[#f3ecd2] dark:hover:bg-[#28231a]",children:[a.jsx(fa,{className:"h-4 w-4 mr-2"}),"Voltar"]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#7c6a3c] dark:text-[#f8f5e4]",children:"Chamados Recentes"}),a.jsx("p",{className:"text-[#bfae7c] dark:text-[#bfae7c]",children:"Histórico dos últimos chamados criados"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Qt,{}),a.jsx(Yt,{}),a.jsxs("div",{className:"relative w-80",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-[#bfae7c] dark:text-[#bfae7c]"}),a.jsx(Sr,{type:"text",placeholder:"Buscar por título, descrição, processo...",value:t,onChange:e=>o(e.target.value),className:"pl-10 bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320] text-[#7c6a3c] dark:text-[#f8f5e4] placeholder:text-[#bfae7c] dark:placeholder:text-[#bfae7c]"})]})]})]}),t&&a.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ua,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),a.jsxs("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:["Buscando por: ",a.jsxs("strong",{children:['"',t,'"']})]}),i&&a.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 ml-2",children:"• Resultado destacado"})]})}),d?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#bfae7c] dark:border-[#bfae7c] mx-auto"}),a.jsx("p",{className:"text-[#bfae7c] dark:text-[#bfae7c] mt-4",children:"Carregando chamados..."})]}):0===g.length?a.jsx(nt,{className:"bg-[#f8f5e4] dark:bg-[#2d2717] border-[#e2d8b8] dark:border-[#3a3320]",children:a.jsxs(mt,{className:"p-8 text-center",children:[a.jsx(qe,{className:"h-12 w-12 text-[#bfae7c] dark:text-[#bfae7c] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-[#7c6a3c] dark:text-[#f8f5e4] mb-2",children:0===l.length?"Nenhum chamado encontrado":"Nenhum resultado encontrado"}),a.jsx("p",{className:"text-[#bfae7c] dark:text-[#bfae7c]",children:0===l.length?"Ainda não há chamados criados no sistema.":"Tente ajustar os termos da sua busca."})]})}):a.jsxs("div",{className:"space-y-4",children:[t&&a.jsxs("div",{className:"mb-4 text-sm text-[#bfae7c] dark:text-[#bfae7c]",children:["Mostrando ",g.length," de ",l.length," chamados"]}),g.map(e=>a.jsx(sn,{chamado:e,onCopiar:c,onTemplate:m,onDuplicar:u,onEditar:x,onExcluir:h,isHighlighted:i===e.id,searchTerm:t},e.id))]})]})})},tn=[{value:"📅",label:"📅 Calendário"},{value:"✅",label:"✅ Check"},{value:"🔍",label:"🔍 Busca"},{value:"🏢",label:"🏢 Empresa"},{value:"🎧",label:"🎧 Headset"},{value:"🚶",label:"🚶 Pessoa"},{value:"💰",label:"💰 Dinheiro"},{value:"📄",label:"📄 Documento"},{value:"👥",label:"👥 Usuários"},{value:"🌐",label:"🌐 Globo"},{value:"💯",label:"💯 100%"},{value:"🐛",label:"🐛 Bug"},{value:"🌍",label:"🌍 Terra"},{value:"🔒",label:"🔒 Segurança"},{value:"📞",label:"📞 Telefone"},{value:"📧",label:"📧 Email"},{value:"🤖",label:"🤖 Bot"},{value:"📁",label:"📁 Pasta"},{value:"💼",label:"💼 Maleta"},{value:"❓",label:"❓ Pergunta"},{value:"💬",label:"💬 Chat"},{value:"⚠️",label:"⚠️ Aviso"},{value:"🏛️",label:"🏛️ Banco"},{value:"👤",label:"👤 Usuário"},{value:"👤👤",label:"👤👤 Usuários"},{value:"📊",label:"📊 Gráfico"},{value:"💳",label:"💳 Cartão"},{value:"🔗",label:"🔗 Link"},{value:"⚖️",label:"⚖️ Justiça"}],on=({isOpen:s,onOpenChange:r,groupId:t,groupTitle:o})=>{const[i,n]=e.useState(""),[l,d]=e.useState(""),[c,m]=e.useState("🔗"),u=Be(),x=Ge({mutationFn:async e=>{const{data:a}=await dr.from("shortcuts").select("order").eq("group_id",t).order("order",{ascending:!1}).limit(1).single(),s=a?a.order+1:0,{data:r,error:o}=await dr.from("shortcuts").insert({...e,order:s}).select().single();if(o)throw o;return r},onSuccess:()=>{u.invalidateQueries({queryKey:["shortcuts"]}),Cs.success("Atalho criado com sucesso!"),h()},onError:e=>{Cs.error("Erro ao criar atalho. Tente novamente.")}}),h=()=>{n(""),d(""),m("🔗"),r(!1)};return a.jsx(wr,{open:s,onOpenChange:r,children:a.jsxs(yr,{className:"sm:max-w-md",children:[a.jsxs(Cr,{children:[a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx(S,{className:"h-5 w-5"}),"Adicionar Atalho"]}),a.jsxs(Er,{children:['Adicionar um novo atalho ao grupo "',o,'"']})]}),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),i.trim()&&l.trim()){try{new URL(l)}catch{return void Cs.error("Por favor, insira uma URL válida.")}x.mutate({title:i.trim(),url:l.trim(),icon:c,group_id:t})}else Cs.error("Por favor, preencha todos os campos obrigatórios.")},className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"title",children:"Título *"}),a.jsx(Sr,{id:"title",value:i,onChange:e=>n(e.target.value),placeholder:"Ex: Google Drive",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"url",children:"URL *"}),a.jsx(Sr,{id:"url",type:"url",value:l,onChange:e=>d(e.target.value),placeholder:"Ex: https://drive.google.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"icon",children:"Ícone"}),a.jsxs(ao,{value:c,onValueChange:m,children:[a.jsx(ro,{children:a.jsx(so,{})}),a.jsx(io,{children:tn.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs(Pr,{className:"gap-2 sm:gap-0",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:h,disabled:x.isPending,children:"Cancelar"}),a.jsxs(cr,{type:"submit",disabled:x.isPending,children:[x.isPending&&a.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),"Criar Atalho"]})]})]})]})})},nn=e=>({"📅":le,"✅":ss,"🔍":ua,"🏢":as,"🎧":es,"🚶":Za,"💰":Wa,"📄":qe,"👥":ra,"🌐":ma,"💯":ze,"🐛":Ya,"🌍":ma,"🔒":g,"📞":Ka,"📧":p,"🤖":ne,"📁":ca,"💼":Qa,"❓":Xa,"💬":da,"⚠️":ha,"🏛️":Ha,"👤":se,"👤👤":Ga,"📊":Ba,"💳":$a,"🔗":La,"⚖️":wa}[e]||ma),ln=({icon:e,title:s,url:r,id:t,favorites:o,onToggleFavorite:i,onOpenUrl:n})=>a.jsxs("div",{className:"relative group animate-fade-in h-full",children:[a.jsx(cr,{variant:"outline",className:"w-full h-28 p-5 flex flex-col items-center justify-center gap-3 \n                 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 \n                 dark:from-[#23201a] dark:via-[#2d2717] dark:to-[#181511]\n                 hover:from-blue-100 hover:to-purple-100\n                 dark:hover:from-[#2d2717] dark:hover:to-[#28231a]\n                 border-2 border-blue-200/60 dark:border-[#3a3320] hover:border-blue-300/80\n                 dark:hover:border-[#bfae7c]/30\n                 shadow-lg hover:shadow-2xl\n                 transition-all duration-300 ease-out\n                 hover:scale-105 hover:-translate-y-1\n                 rounded-2xl group",onClick:()=>n(r),children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 h-full w-full",children:[a.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-400 to-indigo-500 \n                        dark:from-[#bfae7c] dark:to-[#7c6a3c]\n                        group-hover:from-indigo-500 group-hover:to-purple-500\n                        dark:group-hover:from-[#f8f5e4] dark:group-hover:to-[#bfae7c]\n                        shadow-lg transition-all duration-300 flex-shrink-0",children:a.jsx(e,{className:"h-6 w-6 text-white dark:text-[#23201a] group-hover:text-yellow-200 dark:group-hover:text-[#23201a]"})}),a.jsx("span",{className:"text-sm text-center leading-tight font-medium text-gray-800 dark:text-[#f8f5e4] group-hover:text-blue-900 dark:group-hover:text-[#bfae7c] transition-colors line-clamp-2 flex-1 flex items-center justify-center w-full",children:s})]})}),a.jsx(cr,{variant:"ghost",size:"sm",className:"absolute -top-2 -right-2 h-8 w-8 p-0 opacity-0 group-hover:opacity-100 \n                 transition-all duration-300 bg-white/95 dark:bg-[#23201a]/95 backdrop-blur-sm shadow-xl \n                 border border-pink-200 dark:border-[#bfae7c]/30 hover:border-pink-400 dark:hover:border-[#bfae7c]/50 rounded-full\n                 hover:scale-110",onClick:e=>{e.stopPropagation(),i(t)},children:a.jsx($e,{className:"h-5 w-5 transition-all duration-200 "+(o.includes(t)?"fill-pink-400 dark:fill-[#bfae7c] text-pink-400 dark:text-[#bfae7c] scale-110":"text-gray-300 dark:text-[#bfae7c]/60 hover:text-pink-400 dark:hover:text-[#bfae7c]")})})]}),dn=({group:e,openGroups:s,favorites:r,isAdmin:t,onToggleGroup:o,onToggleFavoriteButton:i,onOpenUrl:n,onAddShortcut:l})=>{const{attributes:d,listeners:c,setNodeRef:m,transform:u,transition:x,isDragging:h}=or({id:e.id}),g={transform:ir.Transform.toString(u),transition:x,opacity:h?.5:1};return a.jsx(nt,{ref:m,style:g,className:"overflow-hidden transition-all duration-300 animate-fade-in\n                  bg-[#f8f5e4] dark:bg-[#23201a] border border-[#e2d8b8] dark:border-[#3a3320] shadow-md\n                  rounded-xl min-h-[80px] flex flex-col justify-between px-3 py-2 my-2 dark:text-[#f8f5e4]",children:a.jsxs(Yo,{open:s[e.id]||!1,onOpenChange:()=>o(e.id),children:[a.jsx(Wo,{asChild:!0,children:a.jsxs(lt,{className:"cursor-pointer hover:bg-[#f3ecd2] dark:hover:bg-[#2d2717] transition-all duration-300 group p-2 flex flex-row items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{...d,...c,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-[#f3ecd2] dark:hover:bg-[#2d2717] rounded-lg transition-all duration-200 hover:scale-105",onClick:e=>e.stopPropagation(),children:a.jsx(rs,{className:"h-3 w-3 text-[#bfae7c] dark:text-[#bfae7c]"})}),a.jsx("div",{className:"p-2 bg-[#f3ecd2] dark:bg-[#2d2717] rounded-lg shadow-sm group-hover:shadow-md transition-all duration-300 group-hover:scale-105",children:a.jsx(e.icon,{className:"h-5 w-5 text-[#bfae7c] dark:text-[#bfae7c]"})}),a.jsx("span",{className:"font-semibold text-[#7c6a3c] dark:text-[#bfae7c] text-base truncate max-w-[120px]",children:e.title})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("span",{className:"bg-[#f3ecd2] dark:bg-[#2d2717] text-[#bfae7c] dark:text-[#bfae7c] rounded-full px-2 py-0.5 text-xs font-medium",children:[e.buttons.length," atalhos"]}),t&&a.jsx(cr,{size:"icon",variant:"outline",className:"ml-1 rounded-full w-7 h-7 flex items-center justify-center text-[#bfae7c] dark:text-[#f8f5e4] border-[#e2d8b8] dark:border-[#3a3320] hover:bg-[#f8f5e4] dark:bg-[#2d2717] dark:hover:bg-[#28231a]",title:"Adicionar atalho",type:"button",tabIndex:-1,onClick:a=>{a.stopPropagation(),l(e.id,e.title)},children:"+"}),a.jsx("div",{className:"p-1 bg-[#f8f5e4] dark:bg-[#23201a] rounded-lg",children:s[e.id]?a.jsx(Ne,{className:"h-4 w-4 text-[#bfae7c] dark:text-[#bfae7c]"}):a.jsx(be,{className:"h-4 w-4 text-[#bfae7c] dark:text-[#bfae7c]"})})]})]})}),a.jsx(Zo,{className:"animate-accordion-down",children:a.jsx(mt,{className:"pt-0 pb-3 dark:bg-[#23201a]",children:a.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.buttons.map((e,s)=>a.jsx("div",{className:"animate-fade-in",style:{animationDelay:50*s+"ms"},children:a.jsx(ln,{id:e.id,icon:e.icon,title:e.title,url:e.url,favorites:r,onToggleFavorite:i,onOpenUrl:n})},e.id))})})})]})})},cn=({button:e,onToggleFavorite:s,onOpenUrl:r,className:t,style:o})=>{const{attributes:i,listeners:n,setNodeRef:l,transform:d,transition:c,isDragging:m}=or({id:e.id}),u={...o,transform:ir.Transform.toString(d),transition:c,zIndex:m?99:void 0};return a.jsxs("div",{ref:l,style:u,className:(t||"")+" group relative",...i,...n,children:[a.jsxs(cr,{variant:"outline",className:"w-full h-28 p-5 flex flex-col items-center justify-center gap-3\n                   bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-50\n                   dark:from-[#23201a] dark:via-[#2d2717] dark:to-[#181511]\n                   hover:from-yellow-100 hover:to-orange-100\n                   dark:hover:from-[#2d2717] dark:hover:to-[#28231a]\n                   border-2 border-yellow-300/40 dark:border-[#3a3320] hover:border-yellow-400/60\n                   dark:hover:border-[#bfae7c]/30\n                   shadow-lg hover:shadow-2xl\n                   transition-all duration-500 ease-out\n                   hover:scale-[1.03] hover:-translate-y-1\n                   rounded-2xl relative overflow-hidden\n                   text-center cursor-pointer",onClick:a=>{a.stopPropagation(),r(e.url)},children:[a.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-yellow-400 via-amber-500 to-orange-500 \n                        dark:from-[#bfae7c] dark:via-[#7c6a3c] dark:to-[#5a4a2a]\n                        group-hover:from-yellow-500 group-hover:to-orange-600\n                        dark:group-hover:from-[#f8f5e4] dark:group-hover:to-[#bfae7c]\n                        shadow-lg group-hover:shadow-xl transition-all duration-300",children:a.jsx(e.icon,{className:"h-6 w-6 text-white dark:text-[#23201a] group-hover:text-yellow-200 dark:group-hover:text-[#23201a]"})}),a.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-[#f8f5e4] \n                       group-hover:text-amber-900 dark:group-hover:text-[#bfae7c] \n                       transition-colors duration-300 line-clamp-2 leading-tight w-full",children:e.title})]}),!m&&a.jsx(cr,{variant:"ghost",size:"sm",className:"absolute -top-3 -right-3 h-8 w-8 p-0 opacity-0 group-hover:opacity-100\n                     transition-all duration-300 bg-gradient-to-br from-red-500 to-pink-600 \n                     hover:from-red-600 hover:to-pink-700 shadow-lg hover:shadow-xl \n                     border-2 border-white rounded-full z-10\n                     hover:scale-110 transform-gpu cursor-pointer",onClick:a=>{a.stopPropagation(),s(e.id)},title:"Remover dos Favoritos",children:a.jsx($e,{className:"h-5 w-5 fill-white text-white transition-all duration-200"})})]})},mn=({children:e,isOver:s})=>a.jsx("div",{className:"transition-all duration-300 rounded-2xl "+(s?"ring-4 ring-pink-300 dark:ring-[#bfae7c] bg-pink-50/60 dark:bg-[#bfae7c]/10":""),children:e}),un=()=>{const[s,r]=e.useState(""),[t,o]=e.useState({}),[i,n]=e.useState([]),[l,d]=e.useState(!1),[c,m]=e.useState({open:!1,groupId:"",groupTitle:""}),{preferences:u,loading:x,updateGroupOrder:h,toggleFavoriteGroup:g,toggleFavoriteButton:p,updateFavoriteButtonsOrder:j}=(()=>{const[a,s]=e.useState({}),[r,t]=e.useState(!0),{toast:o}=Vr();e.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:{user:e}}=await dr.auth.getUser();if(!e)return void t(!1);const{data:a,error:r}=await dr.from("user_shortcuts_preferences").select("group_order, favorite_groups, favorite_buttons").eq("user_id",e.id).single();if(r&&"PGRST116"!==r.code)return;a&&s({groupOrder:a.group_order||[],favoriteGroups:a.favorite_groups||[],favoriteButtons:a.favorite_buttons||[]})}catch(e){}finally{t(!1)}},n=async e=>{try{const{data:{user:r}}=await dr.auth.getUser();if(!r)return;const t={...a,...e},{data:i}=await dr.from("user_shortcuts_preferences").select("id").eq("user_id",r.id).single();if(i){const{error:e}=await dr.from("user_shortcuts_preferences").update({group_order:t.groupOrder,favorite_groups:t.favoriteGroups,favorite_buttons:t.favoriteButtons}).eq("user_id",r.id);if(e)return void o({title:"Erro",description:"Não foi possível salvar as preferências",variant:"destructive"})}else{const{error:e}=await dr.from("user_shortcuts_preferences").insert({user_id:r.id,group_order:t.groupOrder,favorite_groups:t.favoriteGroups,favorite_buttons:t.favoriteButtons});if(e)return void o({title:"Erro",description:"Não foi possível salvar as preferências",variant:"destructive"})}s(t),o({title:"Sucesso",description:"Preferências salvas com sucesso"})}catch(r){o({title:"Erro",description:"Não foi possível salvar as preferências",variant:"destructive"})}};return{preferences:a,loading:r,updateGroupOrder:e=>{n({groupOrder:e})},toggleFavoriteGroup:e=>{const s=a.favoriteGroups||[],r=s.includes(e)?s.filter(a=>a!==e):[...s,e];n({favoriteGroups:r})},toggleFavoriteButton:e=>{const s=a.favoriteButtons||[],r=s.includes(e)?s.filter(a=>a!==e):[...s,e];n({favoriteButtons:r})},updateFavoriteButtonsOrder:e=>{n({favoriteButtons:e})},refresh:i}})();Be();const{data:b,isLoading:v}=f({queryKey:["user-profile"],queryFn:async()=>{const{data:{user:e}}=await dr.auth.getUser();if(!e?.id)return null;const{data:a,error:s}=await dr.from("profiles").select("is_admin, status").eq("id",e.id).single();return s?null:a}}),N=b?.is_admin&&"aprovado"===b?.status,{data:w,isLoading:y}=f({queryKey:["shortcut-groups"],queryFn:async()=>{const{data:e,error:a}=await dr.from("shortcut_groups").select("*").order("order",{ascending:!0});if(a)throw a;return e},enabled:!v&&!!b}),{data:C,isLoading:k}=f({queryKey:["shortcuts"],queryFn:async()=>{const{data:e,error:a}=await dr.from("shortcuts").select("\n          *,\n          shortcut_groups!inner(title)\n        ").order("order",{ascending:!0});if(a)throw a;return e.map(e=>({...e,group_title:e.shortcut_groups?.title}))},enabled:!v&&!!b});e.useEffect(()=>{!x&&u.favoriteButtons&&n(u.favoriteButtons)},[u.favoriteButtons,x]);const E=e.useMemo(()=>w&&C?w.map(e=>({id:e.id,title:e.title,icon:nn(e.icon),buttons:C.filter(a=>a.group_id===e.id).map(e=>({id:e.id,title:e.title,url:e.url,icon:nn(e.icon)}))})):[],[w,C]),S=Hs(Xs(tr,{activationConstraint:{distance:8}}),Xs(rr,{coordinateGetter:sr})),T=e=>{o(a=>({...a,[e]:!a[e]}))},A=e=>{window.open(e,"_blank","noopener,noreferrer")},_=(e,a)=>{m({open:!0,groupId:e,groupTitle:a})},P=e.useMemo(()=>{if(!u.groupOrder||0===u.groupOrder.length)return E;const e=u.groupOrder;return[...e.map(e=>E.find(a=>a.id===e)).filter(Boolean),...E.filter(a=>!e.includes(a.id))]},[E,u.groupOrder]),D=e.useMemo(()=>s?P.filter(e=>e.title.toLowerCase().includes(s.toLowerCase())||e.buttons.some(e=>e.title.toLowerCase().includes(s.toLowerCase()))):P,[P,s]),z=e.useMemo(()=>{if(!s)return[];const e=[];return E.forEach(a=>{a.buttons.forEach(a=>{a.title.toLowerCase().includes(s.toLowerCase())&&e.push(a)})}),e},[E,s]),I=e.useMemo(()=>{const e=[];return E.forEach(a=>{a.buttons.forEach(a=>{i.includes(a.id)&&e.push(a)})}),e},[E,i]),[M,F]=e.useState(!1),{setNodeRef:O}=Qs({id:"favorites-dropzone"});if(x||y||k)return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:a.jsx(nt,{className:"bg-white/80 backdrop-blur-sm shadow-xl border-0",children:a.jsxs(mt,{className:"p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-medium text-gray-600",children:"Carregando atalhos..."})]})})});const R=i.map(e=>I.find(a=>a.id===e)).filter(Boolean);return a.jsxs("div",{className:"min-h-screen bg-[#f8f5e4] dark:bg-[#23201a] p-2 dark:text-[#bfae7c]",children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-pastel-purple rounded-full blur-3xl opacity-30"}),a.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-pastel-pink rounded-full blur-3xl opacity-30"}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-pastel-blue rounded-full blur-3xl opacity-20"}),a.jsx("div",{className:"absolute top-20 left-20 w-60 h-60 bg-gradient-pastel-green rounded-full blur-3xl opacity-20"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-60 h-60 bg-gradient-pastel-orange rounded-full blur-3xl opacity-20"})]}),a.jsxs("div",{className:"container mx-auto px-4 py-8 relative z-10",children:[a.jsx(Lo,{title:"Atalhos NAPJe"}),a.jsx("div",{className:"mb-6 flex flex-wrap items-center justify-center gap-4",children:a.jsxs("div",{className:"flex items-center gap-2 bg-white/80 dark:bg-[#23201a]/80 backdrop-blur-sm rounded-xl p-2 shadow-lg border border-blue-100 dark:border-[#3a3320]",children:[a.jsxs(cr,{onClick:()=>{const e={};D.forEach(a=>{e[a.id]=!0}),o(e)},variant:"outline",size:"sm",className:"h-8 px-3 text-xs bg-success/10 dark:bg-[#2d2717] border-success/20 dark:border-[#bfae7c]/30 text-success dark:text-[#bfae7c] hover:bg-success/20 dark:hover:bg-[#28231a] hover:border-success/40 dark:hover:border-[#bfae7c]/50",children:[a.jsx(be,{className:"h-4 w-4 mr-1"}),"Expandir Todos"]}),a.jsxs(cr,{onClick:()=>{o({})},variant:"outline",size:"sm",className:"h-8 px-3 text-xs bg-destructive/10 dark:bg-[#2d2717] border-destructive/20 dark:border-[#bfae7c]/30 text-destructive dark:text-[#bfae7c] hover:bg-destructive/20 dark:hover:bg-[#28231a] hover:border-destructive/40 dark:hover:border-[#bfae7c]/50",children:[a.jsx(Ne,{className:"h-4 w-4 mr-1"}),"Colapsar Todos"]}),a.jsxs(cr,{onClick:()=>{d(!l),l||o({})},variant:"outline",size:"sm",className:"h-8 px-3 text-xs "+(l?"bg-warning dark:bg-[#bfae7c]/20 text-warning-foreground dark:text-[#f8f5e4] border-warning dark:border-[#bfae7c]/40":"bg-muted dark:bg-[#2d2717] text-muted-foreground dark:text-[#bfae7c] border-border dark:border-[#3a3320] hover:bg-accent dark:hover:bg-[#28231a] hover:text-accent-foreground dark:hover:text-[#f8f5e4]"),children:[a.jsx(Ke,{className:"h-4 w-4 mr-1 "+(l?"fill-warning-foreground dark:fill-[#f8f5e4] text-warning-foreground dark:text-[#f8f5e4]":"")}),l?"Mostrar Todos":"Só Favoritos"]})]})}),a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"relative max-w-md mx-auto",children:[a.jsx(ua,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-muted-foreground dark:text-[#bfae7c] h-5 w-5"}),a.jsx(Sr,{placeholder:"Buscar atalhos...",value:s,onChange:e=>r(e.target.value),className:"pl-12 h-12 text-lg border-2 border-primary/20 dark:border-[#bfae7c]/30 focus:border-primary/40 dark:focus:border-[#bfae7c]/50 bg-white/80 dark:bg-[#23201a]/80 backdrop-blur-sm shadow-lg rounded-xl dark:text-[#f8f5e4] dark:placeholder-[#bfae7c]"})]})}),a.jsxs("div",{className:"max-w-6xl mx-auto",children:[s&&z.length>0&&a.jsxs(nt,{className:"mb-8 bg-gradient-to-r from-green-50 via-emerald-50 to-teal-50 dark:from-[#23201a] dark:via-[#2d2717] dark:to-[#181511] border-2 border-green-200 dark:border-[#3a3320] shadow-xl animate-fade-in",children:[a.jsx(lt,{className:"pb-4 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-[#2d2717] dark:to-[#28231a]",children:a.jsxs(dt,{className:"flex items-center gap-3 text-green-900 dark:text-[#f8f5e4]",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 dark:from-[#bfae7c] dark:to-[#7c6a3c] rounded-lg shadow-lg",children:a.jsx(ua,{className:"h-6 w-6 text-white dark:text-[#23201a]"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xl font-bold",children:"Resultados da Busca"}),a.jsxs("p",{className:"text-sm text-green-700 dark:text-[#bfae7c] font-normal",children:[z.length," atalho",z.length>1?"s":""," encontrado",z.length>1?"s":"",' para "',s,'"']})]})]})}),a.jsx(mt,{className:"pt-6",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-4",children:z.map((e,s)=>a.jsx("div",{className:"animate-fade-in",style:{animationDelay:50*s+"ms"},children:a.jsx(ln,{id:e.id,icon:e.icon,title:e.title,url:e.url,favorites:i,onToggleFavorite:p,onOpenUrl:A})},e.id))})})]}),a.jsxs(Ks,{sensors:S,collisionDetection:Ys,onDragEnd:e=>{const{active:a,over:s}=e;if(s&&"favorites-dropzone"===s.id)return i.includes(a.id)||(n([...i,a.id]),j([...i,a.id])),void F(!1);if(s&&a.id!==s.id&&i.includes(a.id)){const e=i.findIndex(e=>e===a.id),r=i.findIndex(e=>e===s.id);if(-1!==e&&-1!==r){const a=ar(i,e,r);n(a),j(a)}return}if(s&&a.id!==s.id&&D.some(e=>e.id===a.id)){const e=P.findIndex(e=>e.id===a.id),r=P.findIndex(e=>e.id===s.id);if(-1!==e&&-1!==r){const a=ar(P,e,r).map(e=>e.id);h(a)}return}F(!1)},onDragOver:e=>{const{over:a}=e;a&&"favorites-dropzone"===a.id?F(!0):F(!1)},children:[(I.length>0||l)&&a.jsx("div",{ref:O,children:a.jsx(mn,{isOver:M,children:a.jsxs(nt,{className:"mb-8 bg-gradient-card dark:bg-[#23201a] border-2 border-border dark:border-[#3a3320] shadow-xl animate-fade-in",children:[a.jsx(lt,{className:"pb-4 bg-gradient-accent dark:bg-[#2d2717]",children:a.jsxs(dt,{className:"flex items-center gap-3 text-foreground dark:text-[#f8f5e4]",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-yellow-400 to-amber-500 dark:from-[#bfae7c] dark:to-[#7c6a3c] rounded-lg shadow-lg",children:a.jsx(Ke,{className:"h-6 w-6 fill-white dark:fill-[#23201a] text-white dark:text-[#23201a]"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xl font-bold",children:"Favoritos"}),a.jsx("p",{className:"text-sm text-muted-foreground dark:text-[#bfae7c] font-normal",children:I.length>0?"Seus atalhos preferidos":"Nenhum favorito selecionado"})]})]})}),I.length>0&&a.jsx(mt,{className:"pt-6",children:a.jsx(Ws,{items:i,strategy:Zs,children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-4",children:R.map((e,s)=>a.jsx(cn,{button:e,onToggleFavorite:p,onOpenUrl:A,className:"animate-fade-in",style:{animationDelay:100*s+"ms"}},e.id))})})})]})})}),!l&&a.jsx(a.Fragment,{children:0===D.length?a.jsx(nt,{className:"dark:bg-[#23201a] dark:border-[#3a3320]",children:a.jsxs(mt,{className:"p-12 text-center dark:bg-[#23201a]",children:[a.jsx(ua,{className:"h-16 w-16 text-muted-foreground dark:text-[#bfae7c] mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-muted-foreground dark:text-[#f8f5e4] mb-2",children:"Nenhum resultado encontrado"}),a.jsx("p",{className:"text-muted-foreground dark:text-[#bfae7c]",children:"Tente ajustar os termos da sua busca"})]})}):a.jsx(Ws,{items:D,strategy:er,children:a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:D.map(e=>a.jsx(dn,{group:e,isFavorite:u.favoriteGroups?.includes(e.id)||!1,openGroups:t,favorites:i,isAdmin:N||!1,onToggleGroup:T,onToggleFavoriteGroup:g,onToggleFavoriteButton:p,onOpenUrl:A,onAddShortcut:_},e.id))})})})]})]}),a.jsx(on,{isOpen:c.open,onOpenChange:e=>{e||m({open:!1,groupId:"",groupTitle:""})},groupId:c.groupId,groupTitle:c.groupTitle}),a.jsxs("footer",{className:"mt-8 text-center text-sm bg-[#f8f5e4] dark:bg-[#181511] border-t border-[#e2d8b8] dark:border-t-[#3a3320] py-4 dark:text-[#bfae7c]",children:[a.jsx("p",{className:"text-sm text-muted-foreground dark:text-[#bfae7c] mb-2",children:"© 2025 TRT15 - Núcleo de Apoio ao PJe | Central de Atalhos"}),a.jsxs("p",{className:"text-sm text-muted-foreground dark:text-[#bfae7c]",children:["Desenvolvido por"," ",a.jsx("a",{href:"https://msribeiro2010.github.io/marcelo-s-ribeiro-stellar-ai/",target:"_blank",rel:"noopener noreferrer",className:"text-primary dark:text-[#f8f5e4] hover:underline font-medium",children:"msribeiro"})]})]})]})]})},xn=()=>{const{user:s,signIn:r,signUp:t,resetPassword:o,loading:i}=tt(),[n,l]=e.useState(""),[d,c]=e.useState(""),[m,u]=e.useState(""),[x,h]=e.useState(!1),[g,p]=e.useState(!1),[f,b]=e.useState(!1),[v,N]=e.useState(!1);if(i)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})});if(s)return a.jsx(j,{to:"/",replace:!0});return a.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted p-4 relative",children:[a.jsx("div",{className:"absolute top-4 right-4",children:a.jsx(Xt,{})}),a.jsxs(nt,{className:"w-full max-w-md",children:[a.jsxs(lt,{className:"text-center",children:[a.jsx(dt,{children:"Sistema de Chamados"}),a.jsx(ct,{children:"Acesse com seu e-mail (Gmail ou qualquer outro)"})]}),a.jsx(mt,{children:a.jsxs(Eo,{defaultValue:"signin",className:"w-full",children:[a.jsxs(So,{className:"grid w-full grid-cols-2",children:[a.jsx(To,{value:"signin",children:"Entrar"}),a.jsx(To,{value:"signup",children:"Cadastrar"})]}),a.jsx(Ao,{value:"signin",children:v?a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(!0);const{error:a}=await o(n);a?Cs.error(a.message||"Erro ao enviar email de recuperação"):(Cs.success("Email de recuperação enviado! Verifique sua caixa de entrada."),N(!1)),h(!1)},className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"reset-email",children:"Email"}),a.jsx(Sr,{id:"reset-email",type:"email",placeholder:"seu.email@gmail.com",value:n,onChange:e=>l(e.target.value),required:!0})]}),a.jsx(cr,{type:"submit",className:"w-full",disabled:x,children:x?"Enviando...":"Enviar email de recuperação"}),a.jsx(cr,{type:"button",variant:"ghost",className:"w-full",onClick:()=>N(!1),children:"Voltar para o login"})]}):a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(!0);const{error:a}=await r(n,d);a?Cs.error(a.message||"Erro ao fazer login"):Cs.success("Login realizado com sucesso!"),h(!1)},className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"email",children:"Email"}),a.jsx(Sr,{id:"email",type:"email",placeholder:"seu.email@gmail.com",value:n,onChange:e=>l(e.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"password",children:"Senha"}),a.jsxs("div",{className:"relative",children:[a.jsx(Sr,{id:"password",type:g?"text":"password",value:d,onChange:e=>c(e.target.value),required:!0,className:"pr-10"}),a.jsx(cr,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>p(!g),children:g?a.jsx(ia,{className:"h-4 w-4"}):a.jsx(oa,{className:"h-4 w-4"})})]})]}),a.jsx(cr,{type:"submit",className:"w-full",disabled:x,children:x?"Entrando...":"Entrar"}),a.jsx(cr,{type:"button",variant:"ghost",className:"w-full text-sm",onClick:()=>N(!0),children:"Esqueci minha senha"})]})}),a.jsx(Ao,{value:"signup",children:a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h(!0),d!==m)return Cs.error("As senhas não coincidem"),void h(!1);if(d.length<6)return Cs.error("A senha deve ter pelo menos 6 caracteres"),void h(!1);const{error:a}=await t(n,d);a?a.message.includes("User already registered")?Cs.error("Este email já está cadastrado. Tente fazer login."):Cs.error(a.message||"Erro ao criar conta"):Cs.success("Conta criada com sucesso! Verifique seu email para confirmar a conta."),h(!1)},className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"signup-email",children:"Email"}),a.jsx(Sr,{id:"signup-email",type:"email",placeholder:"seu.email@gmail.com",value:n,onChange:e=>l(e.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"signup-password",children:"Senha"}),a.jsx(Sr,{id:"signup-password",type:f?"text":"password",value:d,onChange:e=>c(e.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"signup-confirm-password",children:"Confirmar Senha"}),a.jsx(Sr,{id:"signup-confirm-password",type:f?"text":"password",value:m,onChange:e=>u(e.target.value),required:!0})]}),a.jsx(cr,{type:"submit",className:"w-full",disabled:x,children:x?"Cadastrando...":"Cadastrar"})]})})]})})]})]})},hn=()=>{const{user:s}=tt(),[r,t]=e.useState(null),[o,n]=e.useState(!1),[l,d]=e.useState(!1),[c,m]=e.useState(!1),[u,x]=e.useState("");b.useEffect(()=>{s&&h()},[s]);const h=async()=>{try{if(n(!0),!s)throw new Error("Usuário não encontrado");const{data:e,error:a}=await dr.from("profiles").select("*").eq("id",s.id).single();if(a)throw a;t(e)}catch(e){Cs.error("Erro ao carregar perfil")}finally{n(!1)}};if(o)return a.jsx(nt,{children:a.jsx(mt,{className:"flex items-center justify-center p-6",children:a.jsx(v,{className:"h-6 w-6 animate-spin"})})});return a.jsxs(nt,{className:"w-full max-w-md mx-auto",children:[a.jsxs(lt,{className:"text-center",children:[a.jsxs(dt,{className:"flex items-center gap-2 justify-center",children:[a.jsx(ts,{className:"h-5 w-5"}),"Meu Avatar"]}),a.jsx(ct,{children:"Personalize sua foto de perfil"})]}),a.jsxs(mt,{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsxs(It,{className:"h-24 w-24 border-4 border-primary/20 shadow-large",children:[a.jsx(Mt,{src:r?.avatar_url||"",alt:r?.nome_completo||"Avatar"}),a.jsx(Ft,{className:"bg-gradient-primary text-primary-foreground text-lg font-bold",children:(g=r?.nome_completo,g?g.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U")})]}),a.jsxs("div",{className:"text-center w-full",children:[c?a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx(Sr,{value:u,onChange:e=>x(e.target.value),placeholder:"Digite seu nome completo",className:"text-center text-lg font-medium",disabled:l,maxLength:100}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(cr,{size:"sm",onClick:async()=>{try{d(!0);const{error:e}=await dr.from("profiles").update({nome_completo:u.trim()||null}).eq("id",s?.id);if(e)throw e;t(e=>e?{...e,nome_completo:u.trim()||null}:null),m(!1),x(""),Cs.success("Nome atualizado com sucesso!")}catch(e){Cs.error(e.message||"Erro ao atualizar nome")}finally{d(!1)}},disabled:l||!u.trim(),title:"Salvar nome",children:l?a.jsx(v,{className:"h-3 w-3 animate-spin"}):a.jsx(X,{className:"h-3 w-3"})}),a.jsx(cr,{size:"sm",variant:"outline",onClick:()=>{x(""),m(!1)},disabled:l,title:"Cancelar",children:a.jsx(i,{className:"h-3 w-3"})})]})]}):a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("p",{className:"font-medium text-lg",children:r?.nome_completo||"Nome não informado"}),a.jsx(cr,{size:"sm",variant:"ghost",onClick:()=>{x(r?.nome_completo||""),m(!0)},disabled:l,title:"Editar nome",className:"h-8 w-8 p-0",children:a.jsx(He,{className:"h-3 w-3"})})]}),a.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:r?.email})]})]}),a.jsxs(Eo,{defaultValue:"upload",className:"w-full",children:[a.jsxs(So,{className:"grid w-full grid-cols-2",children:[a.jsxs(To,{value:"upload",className:"flex items-center gap-2",children:[a.jsx(os,{className:"h-4 w-4"}),"Carregar Foto"]}),a.jsxs(To,{value:"suggested",className:"flex items-center gap-2",children:[a.jsx(_,{className:"h-4 w-4"}),"Avatares Sugeridos"]})]}),a.jsxs(Ao,{value:"upload",className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"avatar-upload",className:"text-sm font-medium",children:"Enviar sua própria foto"}),a.jsx("div",{className:"mt-2",children:a.jsx(Sr,{id:"avatar-upload",type:"file",accept:"image/*",onChange:async e=>{try{if(d(!0),!e.target.files||0===e.target.files.length)throw new Error("Você deve selecionar uma imagem para fazer upload.");const a=e.target.files[0],r=a.name.split(".").pop(),o=`${s?.id}/avatar.${r}`,{error:i}=await dr.storage.from("avatars").upload(o,a,{upsert:!0});if(i)throw i;const{data:n}=dr.storage.from("avatars").getPublicUrl(o),{error:l}=await dr.from("profiles").update({avatar_url:n.publicUrl}).eq("id",s?.id);if(l)throw l;t(e=>e?{...e,avatar_url:n.publicUrl}:null),Cs.success("Avatar atualizado com sucesso!")}catch(a){Cs.error(a.message||"Erro ao fazer upload do avatar")}finally{d(!1)}},disabled:l,className:"file:bg-gradient-primary file:text-primary-foreground file:border-0 file:rounded-md file:px-4 file:py-2 file:mr-4 hover:file:shadow-medium"})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{variant:"outline",onClick:()=>document.getElementById("avatar-upload")?.click(),disabled:l,className:"flex-1",children:[l?a.jsx(v,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(Oa,{className:"h-4 w-4 mr-2"}),l?"Enviando...":"Escolher Foto"]}),r?.avatar_url&&a.jsx(cr,{variant:"destructive",onClick:async()=>{try{if(d(!0),r?.avatar_url){const e=r.avatar_url.split("/").pop();e&&await dr.storage.from("avatars").remove([`${s?.id}/${e}`])}const{error:e}=await dr.from("profiles").update({avatar_url:null}).eq("id",s?.id);if(e)throw e;t(e=>e?{...e,avatar_url:null}:null),Cs.success("Avatar removido com sucesso!")}catch(e){Cs.error(e.message||"Erro ao remover avatar")}finally{d(!1)}},disabled:l,size:"icon",title:"Remover avatar",children:a.jsx(se,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"text-xs text-muted-foreground text-center",children:"Formatos aceitos: JPG, PNG, GIF (máx. 5MB)"})]}),a.jsxs(Ao,{value:"suggested",className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{className:"text-sm font-medium",children:"Escolha um avatar predefinido"}),a.jsx("div",{className:"grid grid-cols-2 gap-3 mt-3",children:["https://images.unsplash.com/photo-1649972904349-6e44c42644a7?w=400&h=400&fit=crop&crop=face","https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=400&h=400&fit=crop&crop=face","https://images.unsplash.com/photo-1581092795360-fd1ca04f0952?w=400&h=400&fit=crop&crop=face","https://images.unsplash.com/photo-1535268647677-300dbf3d78d1?w=400&h=400&fit=crop&crop=face"].map((e,r)=>a.jsx(cr,{variant:"outline",className:"p-2 h-auto hover:shadow-medium transition-all duration-200",onClick:()=>(async e=>{try{d(!0);const{error:a}=await dr.from("profiles").update({avatar_url:e}).eq("id",s?.id);if(a)throw a;t(a=>a?{...a,avatar_url:e}:null),Cs.success("Avatar atualizado com sucesso!")}catch(a){Cs.error(a.message||"Erro ao atualizar avatar")}finally{d(!1)}})(e),disabled:l,children:a.jsxs(It,{className:"h-16 w-16 border-2 border-primary/20",children:[a.jsx(Mt,{src:e,alt:`Avatar sugerido ${r+1}`}),a.jsx(Ft,{className:"bg-gradient-secondary",children:r+1})]})},r))})]}),a.jsx("div",{className:"text-xs text-muted-foreground text-center",children:"Clique em um avatar para selecioná-lo"})]})]})]})]});var g},gn=()=>{const s=F(),{signOut:r}=tt(),[t,o]=e.useState(""),[i,n]=e.useState(""),[l,d]=e.useState(!1);return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-6",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8 animate-fade-in",children:[a.jsxs(cr,{variant:"outline",onClick:()=>s("/"),className:"mb-6 flex items-center gap-2 hover:scale-105 transition-transform",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar para página inicial"]}),a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("div",{className:"p-3 bg-gradient-primary rounded-xl shadow-glow",children:a.jsx(se,{className:"h-8 w-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Meu Perfil"}),a.jsx("p",{className:"text-muted-foreground text-lg mt-1",children:"Gerencie suas informações pessoais"})]})]})]}),a.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[a.jsx("div",{className:"space-y-6",children:a.jsx(hn,{})}),a.jsx("div",{className:"space-y-6",children:a.jsxs(nt,{children:[a.jsxs(lt,{children:[a.jsxs(dt,{className:"flex items-center gap-2",children:[a.jsx(se,{className:"h-5 w-5"}),"Configurações da Conta"]}),a.jsx(ct,{children:"Gerencie sua conta e preferências"})]}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"p-4 bg-gradient-accent rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Tema do Sistema"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Escolha o tema da interface do sistema"}),a.jsx(Xt,{})]}),a.jsxs("div",{className:"p-4 bg-gradient-accent rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Informações da Conta"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Para alterar seu nome ou outras informações, entre em contato com o administrador do sistema."})]}),a.jsxs("div",{className:"p-4 bg-gradient-accent rounded-lg border",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Alterar Senha"}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!t||!i)return void Cs.error("Preencha todos os campos");if(t!==i)return void Cs.error("As senhas não coincidem");if(t.length<6)return void Cs.error("A senha deve ter pelo menos 6 caracteres");d(!0);const{error:a}=await dr.auth.updateUser({password:t});d(!1),a?Cs.error(a.message||"Erro ao alterar senha"):(Cs.success("Senha alterada com sucesso!"),o(""),n(""))},className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium mb-1",children:"Nova Senha"}),a.jsx("input",{type:"password",className:"w-full rounded border px-3 py-2 text-sm",value:t,onChange:e=>o(e.target.value),minLength:6,required:!0,autoComplete:"new-password",placeholder:"Digite a nova senha",title:"Nova Senha"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium mb-1",children:"Confirmar Nova Senha"}),a.jsx("input",{type:"password",className:"w-full rounded border px-3 py-2 text-sm",value:i,onChange:e=>n(e.target.value),minLength:6,required:!0,autoComplete:"new-password",placeholder:"Confirme a nova senha",title:"Confirmar Nova Senha"})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(cr,{type:"submit",disabled:l||!t||!i,className:"bg-primary text-white hover:bg-primary/90",children:l?"Salvando...":"Alterar Senha"})})]})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs(cr,{variant:"destructive",onClick:async()=>{await r(),s("/auth")},className:"w-full flex items-center gap-2",children:[a.jsx(de,{className:"h-4 w-4"}),"Sair da Conta"]})})]})]})})]})]})})},pn=e.forwardRef(({className:e,...s},r)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:r,className:lr("w-full caption-bottom text-sm",e),...s})}));pn.displayName="Table";const fn=e.forwardRef(({className:e,...s},r)=>a.jsx("thead",{ref:r,className:lr("[&_tr]:border-b",e),...s}));fn.displayName="TableHeader";const jn=e.forwardRef(({className:e,...s},r)=>a.jsx("tbody",{ref:r,className:lr("[&_tr:last-child]:border-0",e),...s}));jn.displayName="TableBody";e.forwardRef(({className:e,...s},r)=>a.jsx("tfoot",{ref:r,className:lr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";const bn=e.forwardRef(({className:e,...s},r)=>a.jsx("tr",{ref:r,className:lr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));bn.displayName="TableRow";const vn=e.forwardRef(({className:e,...s},r)=>a.jsx("th",{ref:r,className:lr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));vn.displayName="TableHead";const Nn=e.forwardRef(({className:e,...s},r)=>a.jsx("td",{ref:r,className:lr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));Nn.displayName="TableCell";e.forwardRef(({className:e,...s},r)=>a.jsx("caption",{ref:r,className:lr("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";const wn=()=>{const[s,r]=e.useState("pendente"),t=Be(),o=F(),{data:n,isLoading:l}=f({queryKey:["admin-users",s],queryFn:async()=>{let e=dr.from("profiles").select("*").order("created_at",{ascending:!1});"all"!==s&&(e=e.eq("status",s));const{data:a,error:r}=await e;if(r)throw r;return a}}),d=Ge({mutationFn:async({userId:e,status:a})=>{const{error:s}=await dr.from("profiles").update({status:a,approved_at:"aprovado"===a?(new Date).toISOString():null,approved_by:"aprovado"===a?(await dr.auth.getUser()).data.user?.id:null}).eq("id",e);if(s)throw s},onSuccess:(e,a)=>{t.invalidateQueries({queryKey:["admin-users"]}),Cs.success("aprovado"===a.status?"Usuário aprovado com sucesso!":"Usuário rejeitado!")},onError:e=>{Cs.error("Erro ao atualizar status do usuário")}}),c=e=>{switch(e){case"pendente":return a.jsxs(mr,{variant:"warning",className:"animate-pulse",children:[a.jsx(h,{className:"w-3 h-3 mr-1"}),"Pendente"]});case"aprovado":return a.jsxs(mr,{variant:"success",children:[a.jsx(X,{className:"w-3 h-3 mr-1"}),"Aprovado"]});case"rejeitado":return a.jsxs(mr,{variant:"destructive",children:[a.jsx(i,{className:"w-3 h-3 mr-1"}),"Rejeitado"]});default:return a.jsx(mr,{variant:"outline",children:e})}},m=n?.filter(e=>"pendente"===e.status).length||0;return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"mb-8 animate-fade-in",children:[a.jsxs(cr,{variant:"outline",onClick:()=>o("/"),className:"mb-6 flex items-center gap-2 hover:scale-105 transition-transform",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar para página inicial"]}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsx("div",{className:"p-3 bg-gradient-primary rounded-xl shadow-glow",children:a.jsx(g,{className:"h-8 w-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Gerenciamento de Usuários"}),a.jsx("p",{className:"text-muted-foreground text-lg mt-1",children:"Aprove ou rejeite novos usuários do sistema"})]})]}),m>0&&a.jsx("div",{className:"mt-6 p-5 bg-gradient-accent border border-warning/20 rounded-xl shadow-medium",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-warning rounded-full animate-pulse"}),a.jsxs("p",{className:"text-warning-foreground font-medium",children:[a.jsx("strong",{className:"text-lg",children:m})," usuário(s) aguardando aprovação"]})]})})]}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx(dt,{children:"Lista de Usuários"}),a.jsx(ct,{children:"Gerencie o acesso dos usuários ao sistema"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{variant:"pendente"===s?"default":"outline",size:"sm",onClick:()=>r("pendente"),children:["Pendentes (",n?.filter(e=>"pendente"===e.status).length||0,")"]}),a.jsx(cr,{variant:"aprovado"===s?"default":"outline",size:"sm",onClick:()=>r("aprovado"),children:"Aprovados"}),a.jsx(cr,{variant:"rejeitado"===s?"default":"outline",size:"sm",onClick:()=>r("rejeitado"),children:"Rejeitados"}),a.jsx(cr,{variant:"all"===s?"default":"outline",size:"sm",onClick:()=>r("all"),children:"Todos"})]})]})}),a.jsx(mt,{children:l?a.jsx("div",{className:"text-center py-8",children:"Carregando usuários..."}):n&&0!==n.length?a.jsxs(pn,{children:[a.jsx(fn,{children:a.jsxs(bn,{children:[a.jsx(vn,{children:"Nome"}),a.jsx(vn,{children:"Email"}),a.jsx(vn,{children:"Status"}),a.jsx(vn,{children:"Cadastrado em"}),a.jsx(vn,{children:"Admin"}),a.jsx(vn,{children:"Ações"})]})}),a.jsx(jn,{children:n.map(e=>a.jsxs(bn,{children:[a.jsx(Nn,{className:"font-medium",children:e.nome_completo||"Nome não informado"}),a.jsx(Nn,{children:e.email}),a.jsx(Nn,{children:c(e.status)}),a.jsx(Nn,{children:ks(new Date(e.created_at),"dd/MM/yyyy HH:mm",{locale:Es})}),a.jsx(Nn,{children:e.is_admin&&a.jsx(mr,{variant:"outline",children:"Admin"})}),a.jsxs(Nn,{children:["pendente"===e.status&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{size:"sm",variant:"default",onClick:()=>d.mutate({userId:e.id,status:"aprovado"}),disabled:d.isPending,children:[a.jsx(X,{className:"w-4 h-4 mr-1"}),"Aprovar"]}),a.jsxs(cr,{size:"sm",variant:"destructive",onClick:()=>d.mutate({userId:e.id,status:"rejeitado"}),disabled:d.isPending,children:[a.jsx(i,{className:"w-4 h-4 mr-1"}),"Rejeitar"]})]}),"rejeitado"===e.status&&a.jsxs(cr,{size:"sm",variant:"outline",onClick:()=>d.mutate({userId:e.id,status:"aprovado"}),disabled:d.isPending,children:[a.jsx(X,{className:"w-4 h-4 mr-1"}),"Aprovar"]})]})]},e.id))})]}):a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum usuário encontrado"})})]})]})})},yn=()=>{const[s,r]=e.useState("groups"),[t,o]=e.useState(""),[i,n]=e.useState(!1),[l,d]=e.useState(!1),[c,m]=e.useState(null),[u,x]=e.useState(null),[h,g]=e.useState({title:"",icon:""}),[p,j]=e.useState({title:"",url:"",icon:"",group_id:""}),b=Be(),v=F(),{data:N,isLoading:w}=f({queryKey:["admin-groups"],queryFn:async()=>{const{data:e,error:a}=await dr.from("shortcut_groups").select("*").order("order",{ascending:!0});if(a)throw a;return e}}),{data:y,isLoading:C}=f({queryKey:["admin-shortcuts"],queryFn:async()=>{const{data:e,error:a}=await dr.from("shortcuts").select("\n          *,\n          shortcut_groups!inner(title)\n        ").order("order",{ascending:!0});if(a)throw a;return e.map(e=>({...e,group_title:e.shortcut_groups?.title}))}}),k=N?.filter(e=>e.title.toLowerCase().includes(t.toLowerCase()))||[],E=y?.filter(e=>e.title.toLowerCase().includes(t.toLowerCase())||e.group_title?.toLowerCase().includes(t.toLowerCase()))||[],T=Ge({mutationFn:async e=>{const a=Math.max(...N?.map(e=>e.order)||[0]),{error:s}=await dr.from("shortcut_groups").insert({...e,order:a+1});if(s)throw s},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-groups"]}),b.invalidateQueries({queryKey:["shortcut-groups"]}),Cs.success("Grupo criado com sucesso!"),n(!1),g({title:"",icon:""})},onError:e=>{Cs.error("Erro ao criar grupo")}}),A=Ge({mutationFn:async e=>{const{error:a}=await dr.from("shortcut_groups").update({title:e.title,icon:e.icon,updated_at:(new Date).toISOString()}).eq("id",e.id);if(a)throw a},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-groups"]}),b.invalidateQueries({queryKey:["shortcut-groups"]}),Cs.success("Grupo atualizado com sucesso!"),n(!1),m(null),g({title:"",icon:""})},onError:e=>{Cs.error("Erro ao atualizar grupo")}}),_=Ge({mutationFn:async e=>{await dr.from("shortcuts").delete().eq("group_id",e);const{error:a}=await dr.from("shortcut_groups").delete().eq("id",e);if(a)throw a},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-groups"]}),b.invalidateQueries({queryKey:["admin-shortcuts"]}),b.invalidateQueries({queryKey:["shortcut-groups"]}),b.invalidateQueries({queryKey:["shortcuts"]}),Cs.success("Grupo excluído com sucesso!")},onError:e=>{Cs.error("Erro ao excluir grupo")}}),D=Ge({mutationFn:async e=>{const a=Math.max(...y?.map(e=>e.order)||[0]),{error:s}=await dr.from("shortcuts").insert({...e,order:a+1});if(s)throw s},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-shortcuts"]}),b.invalidateQueries({queryKey:["shortcuts"]}),Cs.success("Atalho criado com sucesso!"),d(!1),j({title:"",url:"",icon:"",group_id:""})},onError:e=>{Cs.error("Erro ao criar atalho")}}),I=Ge({mutationFn:async e=>{const{error:a}=await dr.from("shortcuts").update({title:e.title,url:e.url,icon:e.icon,group_id:e.group_id,updated_at:(new Date).toISOString()}).eq("id",e.id);if(a)throw a},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-shortcuts"]}),b.invalidateQueries({queryKey:["shortcuts"]}),Cs.success("Atalho atualizado com sucesso!"),d(!1),x(null),j({title:"",url:"",icon:"",group_id:""})},onError:e=>{Cs.error("Erro ao atualizar atalho")}}),M=Ge({mutationFn:async e=>{const{error:a}=await dr.from("shortcuts").delete().eq("id",e);if(a)throw a},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-shortcuts"]}),b.invalidateQueries({queryKey:["shortcuts"]}),Cs.success("Atalho excluído com sucesso!")},onError:e=>{Cs.error("Erro ao excluir atalho")}}),O=w||C;return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"mb-8 animate-fade-in",children:[a.jsxs(cr,{variant:"outline",onClick:()=>v("/"),className:"mb-6 flex items-center gap-2 hover:scale-105 transition-transform",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar para página inicial"]}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsx("div",{className:"p-3 bg-gradient-primary rounded-xl shadow-glow",children:a.jsx(Ie,{className:"h-8 w-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Gerenciamento de Atalhos"}),a.jsx("p",{className:"text-muted-foreground text-lg mt-1",children:"Crie, edite e gerencie grupos e atalhos do sistema"})]})]})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex gap-2 bg-muted p-1 rounded-lg",children:[a.jsxs(cr,{variant:"groups"===s?"default":"ghost",onClick:()=>r("groups"),className:"flex items-center gap-2",children:[a.jsx(is,{className:"h-4 w-4"}),"Grupos (",N?.length||0,")"]}),a.jsxs(cr,{variant:"shortcuts"===s?"default":"ghost",onClick:()=>r("shortcuts"),className:"flex items-center gap-2",children:[a.jsx(ns,{className:"h-4 w-4"}),"Atalhos (",y?.length||0,")"]})]})}),a.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),a.jsx(Sr,{placeholder:`Buscar ${"groups"===s?"grupos":"atalhos"}...`,value:t,onChange:e=>o(e.target.value),className:"pl-10"})]}),a.jsxs(cr,{onClick:"groups"===s?()=>{m(null),g({title:"",icon:""}),n(!0)}:()=>{x(null),j({title:"",url:"",icon:"",group_id:""}),d(!0)},className:"flex items-center gap-2",children:[a.jsx(S,{className:"h-4 w-4"}),"Criar ","groups"===s?"Grupo":"Atalho"]})]}),"groups"===s?a.jsxs(nt,{children:[a.jsxs(lt,{children:[a.jsx(dt,{children:"Grupos de Atalhos"}),a.jsx(ct,{children:"Gerencie os grupos que organizam os atalhos"})]}),a.jsx(mt,{children:O?a.jsx("div",{className:"text-center py-8",children:"Carregando grupos..."}):k.length?a.jsxs(pn,{children:[a.jsx(fn,{children:a.jsxs(bn,{children:[a.jsx(vn,{children:"Ícone"}),a.jsx(vn,{children:"Título"}),a.jsx(vn,{children:"Ordem"}),a.jsx(vn,{children:"Criado em"}),a.jsx(vn,{children:"Ações"})]})}),a.jsx(jn,{children:k.map(e=>a.jsxs(bn,{children:[a.jsx(Nn,{children:a.jsx("div",{className:"p-2 bg-muted rounded-lg w-10 h-10 flex items-center justify-center",children:a.jsx("span",{className:"text-lg",children:e.icon})})}),a.jsx(Nn,{className:"font-medium",children:e.title}),a.jsx(Nn,{children:a.jsx(mr,{variant:"outline",children:e.order})}),a.jsx(Nn,{children:new Date(e.created_at).toLocaleDateString("pt-BR")}),a.jsx(Nn,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cr,{size:"sm",variant:"outline",onClick:()=>(e=>{m(e),g({title:e.title,icon:e.icon}),n(!0)})(e),children:a.jsx(Me,{className:"w-4 h-4"})}),a.jsx(cr,{size:"sm",variant:"destructive",onClick:()=>{confirm("Tem certeza que deseja excluir este grupo? Todos os atalhos serão removidos.")&&_.mutate(e.id)},disabled:_.isPending,children:a.jsx(P,{className:"w-4 h-4"})})]})})]},e.id))})]}):a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum grupo encontrado"})})]}):a.jsxs(nt,{children:[a.jsxs(lt,{children:[a.jsx(dt,{children:"Atalhos"}),a.jsx(ct,{children:"Gerencie todos os atalhos do sistema"})]}),a.jsx(mt,{children:O?a.jsx("div",{className:"text-center py-8",children:"Carregando atalhos..."}):E.length?a.jsxs(pn,{children:[a.jsx(fn,{children:a.jsxs(bn,{children:[a.jsx(vn,{children:"Ícone"}),a.jsx(vn,{children:"Título"}),a.jsx(vn,{children:"URL"}),a.jsx(vn,{children:"Grupo"}),a.jsx(vn,{children:"Ordem"}),a.jsx(vn,{children:"Ações"})]})}),a.jsx(jn,{children:E.map(e=>a.jsxs(bn,{children:[a.jsx(Nn,{children:a.jsx("div",{className:"p-2 bg-muted rounded-lg w-10 h-10 flex items-center justify-center",children:a.jsx("span",{className:"text-lg",children:e.icon})})}),a.jsx(Nn,{className:"font-medium",children:e.title}),a.jsx(Nn,{children:a.jsx("div",{className:"max-w-xs truncate",title:e.url,children:e.url})}),a.jsx(Nn,{children:a.jsx(mr,{variant:"secondary",children:e.group_title})}),a.jsx(Nn,{children:a.jsx(mr,{variant:"outline",children:e.order})}),a.jsx(Nn,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cr,{size:"sm",variant:"outline",onClick:()=>(e=>{x(e),j({title:e.title,url:e.url,icon:e.icon,group_id:e.group_id}),d(!0)})(e),children:a.jsx(Me,{className:"w-4 h-4"})}),a.jsx(cr,{size:"sm",variant:"destructive",onClick:()=>{confirm("Tem certeza que deseja excluir este atalho?")&&M.mutate(e.id)},disabled:M.isPending,children:a.jsx(P,{className:"w-4 h-4"})})]})})]},e.id))})]}):a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum atalho encontrado"})})]}),a.jsx(wr,{open:i,onOpenChange:n,children:a.jsxs(yr,{className:"sm:max-w-md",children:[a.jsxs(Cr,{children:[a.jsx(kr,{children:c?"Editar Grupo":"Criar Novo Grupo"}),a.jsx(Er,{children:c?"Modifique as informações do grupo":"Preencha as informações para criar um novo grupo"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"group-title",children:"Título"}),a.jsx(Sr,{id:"group-title",value:h.title,onChange:e=>g({...h,title:e.target.value}),placeholder:"Ex: Google Apps"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"group-icon",children:"Ícone (emoji)"}),a.jsx(Sr,{id:"group-icon",value:h.icon,onChange:e=>g({...h,icon:e.target.value}),placeholder:"Ex: 🌐"})]})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(cr,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),a.jsxs(cr,{onClick:()=>{h.title.trim()?c?A.mutate({id:c.id,...h}):T.mutate(h):Cs.error("Título é obrigatório")},disabled:T.isPending||A.isPending,children:[a.jsx(z,{className:"w-4 h-4 mr-2"}),c?"Atualizar":"Criar"]})]})]})}),a.jsx(wr,{open:l,onOpenChange:d,children:a.jsxs(yr,{className:"sm:max-w-md",children:[a.jsxs(Cr,{children:[a.jsx(kr,{children:u?"Editar Atalho":"Criar Novo Atalho"}),a.jsx(Er,{children:u?"Modifique as informações do atalho":"Preencha as informações para criar um novo atalho"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"shortcut-title",children:"Título"}),a.jsx(Sr,{id:"shortcut-title",value:p.title,onChange:e=>j({...p,title:e.target.value}),placeholder:"Ex: Gmail"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"shortcut-url",children:"URL"}),a.jsx(Sr,{id:"shortcut-url",value:p.url,onChange:e=>j({...p,url:e.target.value}),placeholder:"Ex: https://mail.google.com"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"shortcut-icon",children:"Ícone (emoji)"}),a.jsx(Sr,{id:"shortcut-icon",value:p.icon,onChange:e=>j({...p,icon:e.target.value}),placeholder:"Ex: 📧"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"shortcut-group",children:"Grupo"}),a.jsxs(ao,{value:p.group_id,onValueChange:e=>j({...p,group_id:e}),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione um grupo"})}),a.jsx(io,{children:N?.map(e=>a.jsx(no,{value:e.id,children:e.title},e.id))})]})]})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(cr,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),a.jsxs(cr,{onClick:()=>{p.title.trim()&&p.url.trim()&&p.group_id?u?I.mutate({id:u.id,...p}):D.mutate(p):Cs.error("Todos os campos são obrigatórios")},disabled:D.isPending||I.isPending,children:[a.jsx(z,{className:"w-4 h-4 mr-2"}),u?"Atualizar":"Criar"]})]})]})})]})})},Cn=()=>{const{user:e}=tt();return a.jsx(gt,{children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl py-6 space-y-8",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Métricas do Sistema"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Monitoramento e performance do sistema em tempo real"})]}),a.jsxs(cr,{variant:"outline",onClick:()=>window.location.reload(),children:[a.jsx(h,{className:"h-4 w-4 mr-2"}),"Atualizar"]})]}),a.jsxs(bt,{cols:2,gap:"lg",children:[a.jsx(vt,{children:a.jsxs(pt,{variant:"glass",children:[a.jsx(ft,{title:"Métricas de Performance",description:"Indicadores de desempenho do sistema",icon:a.jsx(ie,{className:"h-5 w-5 text-white"})}),a.jsx(jt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Tempo de Resposta"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Média das últimas 24h"})]}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"200ms"})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Taxa de Erro"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Erros por requisição"})]}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"0.01%"})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Satisfação do Usuário"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Baseado em feedback"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"98.5%"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Uptime"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Disponibilidade do sistema"})]}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"99.9%"})]})]})})]})}),a.jsx(vt,{children:a.jsxs(pt,{variant:"glass",children:[a.jsx(ft,{title:"Status do Sistema",description:"Monitoramento em tempo real",icon:a.jsx(ls,{className:"h-5 w-5 text-white"})}),a.jsx(jt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ra,{className:"h-4 w-4 text-blue-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Usuários Ativos"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Conectados agora"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-lg font-semibold text-purple-600",children:"12"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ca,{className:"h-4 w-4 text-orange-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Chamados Abertos"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Aguardando resolução"})]})]}),a.jsx("span",{className:"text-lg font-semibold text-orange-600",children:"8"})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ds,{className:"h-4 w-4 text-green-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Status do Servidor"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Saúde geral"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-lg font-semibold text-green-600",children:"Online"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ca,{className:"h-4 w-4 text-blue-500"}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Banco de Dados"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Conexões ativas"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-lg font-semibold text-blue-600",children:"5/20"})]})]})]})})]})})]}),a.jsxs(pt,{variant:"glass",children:[a.jsx(ft,{title:"Estatísticas Detalhadas",description:"Análise completa do sistema nas últimas 24 horas",icon:a.jsx(ie,{className:"h-5 w-5 text-white"})}),a.jsx(jt,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsxs("div",{className:"text-center p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"1,247"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Requisições"})]}),a.jsxs("div",{className:"text-center p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:"98.2%"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de Sucesso"})]}),a.jsxs("div",{className:"text-center p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"156ms"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Tempo Médio"})]}),a.jsxs("div",{className:"text-center p-4 bg-card/60 backdrop-blur-sm rounded-xl border border-border/20",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:"23"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Chamados Resolvidos"})]})]})})]})]})})},kn=()=>{const{data:s=[],isLoading:r}=No(),t=wo(),o=yo(),[i,n]=e.useState((new Date).getFullYear()+1),[l,d]=e.useState(""),[c,m]=e.useState([]),[u,x]=e.useState({data:"",descricao:"",tipo:"nacional"}),h={csv:"data,descricao,tipo\n2026-01-01,Ano Novo,nacional\n2026-04-21,Tiradentes,nacional\n2026-05-01,Dia do Trabalho,nacional",json:'[\n  {"data": "2026-01-01", "descricao": "Ano Novo", "tipo": "nacional"},\n  {"data": "2026-04-21", "descricao": "Tiradentes", "tipo": "nacional"},\n  {"data": "2026-05-01", "descricao": "Dia do Trabalho", "tipo": "nacional"}\n]',text:"01/01/2026 - Ano Novo - nacional\n21/04/2026 - Tiradentes - nacional\n01/05/2026 - Dia do Trabalho - nacional"},g=e=>{const a=[/(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})/,/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/];for(const s of a){const r=e.match(s);if(r){if(s===a[0]){const[,e,a,s]=r;return`${e}-${a.padStart(2,"0")}-${s.padStart(2,"0")}`}{const[,e,a,s]=r;return`${s}-${a.padStart(2,"0")}-${e.padStart(2,"0")}`}}}return e},p=e=>{const a=new Blob([h[e]],{type:"text/plain"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`feriados_template_${i}.${"text"===e?"txt":e}`,r.click(),URL.revokeObjectURL(s),Cs.success(`Template ${e.toUpperCase()} baixado!`)},f=e=>{switch(e){case"nacional":return a.jsx(ma,{className:"h-4 w-4 text-blue-500"});case"estadual":return a.jsx(Na,{className:"h-4 w-4 text-green-500"});case"municipal":return a.jsx(as,{className:"h-4 w-4 text-orange-500"});default:return a.jsx(le,{className:"h-4 w-4"})}},j=e=>({nacional:"Nacional",estadual:"Estadual",municipal:"Municipal"}[e]||e);return a.jsxs("div",{className:"space-y-6",children:[a.jsx(nt,{children:a.jsxs(lt,{children:[a.jsxs(dt,{className:"flex items-center gap-2",children:[a.jsx(Oa,{className:"h-5 w-5"}),"Gerenciamento de Feriados"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Adicione feriados futuros através de upload em lote ou inserção manual"})]})}),a.jsxs(Eo,{defaultValue:"upload",className:"space-y-4",children:[a.jsxs(So,{className:"grid w-full grid-cols-3",children:[a.jsx(To,{value:"upload",children:"Upload em Lote"}),a.jsx(To,{value:"manual",children:"Adicionar Manual"}),a.jsx(To,{value:"manage",children:"Gerenciar Existentes"})]}),a.jsx(Ao,{value:"upload",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsxs(lt,{children:[a.jsx(dt,{className:"text-lg",children:"Upload de Feriados"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(eo,{htmlFor:"year",children:"Ano:"}),a.jsxs(ao,{value:i.toString(),onValueChange:e=>n(parseInt(e)),children:[a.jsx(ro,{className:"w-32",children:a.jsx(so,{})}),a.jsx(io,{children:Array.from({length:10},(e,s)=>{const r=(new Date).getFullYear()+s;return a.jsx(no,{value:r.toString(),children:r},r)})})]})]})]}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(eo,{className:"text-sm font-medium",children:"Templates Disponíveis"}),a.jsxs("div",{className:"flex gap-2 mt-2",children:[a.jsxs(cr,{variant:"outline",size:"sm",onClick:()=>p("csv"),children:[a.jsx(Fa,{className:"h-3 w-3 mr-1"}),"CSV"]}),a.jsxs(cr,{variant:"outline",size:"sm",onClick:()=>p("json"),children:[a.jsx(Fa,{className:"h-3 w-3 mr-1"}),"JSON"]}),a.jsxs(cr,{variant:"outline",size:"sm",onClick:()=>p("text"),children:[a.jsx(Fa,{className:"h-3 w-3 mr-1"}),"Texto"]})]})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"uploadData",children:"Cole ou digite os dados dos feriados"}),a.jsx(Nt,{id:"uploadData",value:l,onChange:e=>d(e.target.value),placeholder:"Cole aqui os dados dos feriados em formato CSV, JSON ou texto livre...",rows:8,className:"mt-2"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(cr,{onClick:()=>((e,a)=>{try{const s=[];if("json"===a||"auto"===a&&e.trim().startsWith("[")){const a=JSON.parse(e);s.push(...a.map(e=>({data:e.data,descricao:e.descricao||e.description||e.nome,tipo:e.tipo||e.type||"nacional"})))}else if("csv"===a||"auto"===a&&e.includes(",")){const a=e.split("\n").filter(e=>e.trim());(a[0].toLowerCase().includes("data")||a[0].toLowerCase().includes("date")?a.slice(1):a).forEach(e=>{const[a,r,t]=e.split(",").map(e=>e.trim());a&&r&&s.push({data:g(a),descricao:r.replace(/['"]/g,""),tipo:t?.replace(/['"]/g,"")||"nacional"})})}else e.split("\n").filter(e=>e.trim()).forEach(e=>{const a=e.match(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/),r=e.match(/(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})/);if(a||r){const[,t,o,i]=a||[],[,n,l,d]=r||[],c=a?`${i}-${o.padStart(2,"0")}-${t.padStart(2,"0")}`:`${n}-${l.padStart(2,"0")}-${d.padStart(2,"0")}`,m=e.replace(/(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4}|\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2})/,"").replace(/\s*-\s*(nacional|estadual|municipal)\s*$/i,"").replace(/^\s*-\s*/,"").trim(),u=e.match(/(nacional|estadual|municipal)/i),x=u?u[1].toLowerCase():"nacional";m&&s.push({data:c,descricao:m,tipo:x})}});m(s),Cs.success(`${s.length} feriados identificados!`)}catch(s){Cs.error("Erro ao processar dados. Verifique o formato.")}})(l,"auto"),children:[a.jsx(qe,{className:"h-4 w-4 mr-2"}),"Processar Dados"]}),c.length>0&&a.jsxs(cr,{onClick:async()=>{if(0!==c.length)try{for(const e of c)await t.mutateAsync(e);Cs.success(`${c.length} feriados adicionados com sucesso!`),d(""),m([])}catch(e){Cs.error("Erro ao enviar alguns feriados")}else Cs.error("Nenhum feriado para enviar")},disabled:t.isPending,children:[a.jsx(Oa,{className:"h-4 w-4 mr-2"}),"Enviar ",c.length," Feriados"]})]}),c.length>0&&a.jsxs(nt,{className:"mt-4",children:[a.jsx(lt,{children:a.jsxs(dt,{className:"text-sm flex items-center gap-2",children:[a.jsx(ze,{className:"h-4 w-4 text-green-500"}),"Feriados Identificados (",c.length,")"]})}),a.jsx(mt,{children:a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:c.map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[f(e.tipo),a.jsx("span",{className:"font-medium",children:e.data}),a.jsx("span",{children:e.descricao})]}),a.jsx(mr,{variant:"outline",children:j(e.tipo)})]},s))})})]})]})]})}),a.jsx(Ao,{value:"manual",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsx(dt,{className:"text-lg",children:"Adicionar Feriado Manual"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"manualData",children:"Data"}),a.jsx(Sr,{id:"manualData",type:"date",value:u.data,onChange:e=>x(a=>({...a,data:e.target.value}))})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"manualDescricao",children:"Descrição"}),a.jsx(Sr,{id:"manualDescricao",value:u.descricao,onChange:e=>x(a=>({...a,descricao:e.target.value})),placeholder:"Ex: Dia do Trabalho"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"manualTipo",children:"Tipo"}),a.jsxs(ao,{value:u.tipo,onValueChange:e=>x(a=>({...a,tipo:e})),children:[a.jsx(ro,{children:a.jsx(so,{})}),a.jsxs(io,{children:[a.jsx(no,{value:"nacional",children:"Nacional"}),a.jsx(no,{value:"estadual",children:"Estadual"}),a.jsx(no,{value:"municipal",children:"Municipal"})]})]})]})]}),a.jsxs(cr,{onClick:async()=>{if(u.data&&u.descricao)try{await t.mutateAsync(u),x({data:"",descricao:"",tipo:"nacional"}),Cs.success("Feriado adicionado com sucesso!")}catch(e){Cs.error("Erro ao adicionar feriado")}else Cs.error("Preencha todos os campos obrigatórios")},disabled:t.isPending,children:[a.jsx(S,{className:"h-4 w-4 mr-2"}),"Adicionar Feriado"]})]})]})}),a.jsx(Ao,{value:"manage",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsxs(lt,{children:[a.jsx(dt,{className:"text-lg",children:"Feriados Cadastrados"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," feriados cadastrados no sistema"]})]}),a.jsx(mt,{children:r?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(le,{className:"h-8 w-8 mx-auto mb-2 animate-pulse text-gray-400"}),a.jsx("p",{children:"Carregando feriados..."})]}):a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[f(e.tipo),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:e.descricao}),a.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.data).toLocaleDateString("pt-BR")})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mr,{variant:"outline",children:j(e.tipo)}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>o.mutate(e.id),disabled:o.isPending,children:a.jsx(P,{className:"h-4 w-4 text-red-500"})})]})]},e.id))})})]})})]})]})},En=()=>{const e=F();return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx(Lo,{title:"Administração de Feriados",subtitle:"Gerencie feriados e visualize sugestões de férias inteligentes"}),a.jsx("div",{className:"mb-6",children:a.jsxs(cr,{onClick:()=>e("/"),variant:"outline",className:"flex items-center gap-2",children:[a.jsx(fa,{className:"h-4 w-4"}),"Voltar ao Dashboard"]})}),a.jsxs(Eo,{defaultValue:"upload",className:"space-y-6",children:[a.jsxs(So,{className:"grid w-full grid-cols-3",children:[a.jsxs(To,{value:"upload",className:"flex items-center gap-2",children:[a.jsx(ca,{className:"h-4 w-4"}),"Gerenciar Feriados"]}),a.jsxs(To,{value:"suggestions",className:"flex items-center gap-2",children:[a.jsx(D,{className:"h-4 w-4"}),"Sugestões de IA"]}),a.jsxs(To,{value:"calendar",className:"flex items-center gap-2",children:[a.jsx(le,{className:"h-4 w-4"}),"Visualização"]})]}),a.jsx(Ao,{value:"upload",children:a.jsx(kn,{})}),a.jsx(Ao,{value:"suggestions",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx(ei,{year:(new Date).getFullYear()}),a.jsx(ei,{year:(new Date).getFullYear()+1})]})}),a.jsx(Ao,{value:"calendar",children:a.jsxs("div",{className:"text-center py-12",children:[a.jsx(le,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Visualização de Calendário"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Acesse o calendário principal para ver os feriados aplicados"}),a.jsxs(cr,{onClick:()=>e("/calendario"),children:[a.jsx(le,{className:"h-4 w-4 mr-2"}),"Ir para Calendário"]})]})})]})]})})},Sn=()=>{const{updateSettings:s}=Po(),[r,t]=e.useState(!1),[o,i]=e.useState(""),[n,l]=e.useState([7]);return a.jsxs(wr,{open:r,onOpenChange:t,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"ghost",size:"sm",className:"text-xs bg-white/60 hover:bg-white/80",children:[a.jsx(cs,{className:"h-3 w-3 mr-1"}),"Avançado"]})}),a.jsxs(yr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg",children:a.jsx(cs,{className:"h-5 w-5 text-white"})}),"Configurações Avançadas de Notificação"]})}),a.jsxs(Eo,{defaultValue:"behavior",className:"w-full",children:[a.jsxs(So,{className:"grid w-full grid-cols-4",children:[a.jsxs(To,{value:"behavior",children:[a.jsx(oe,{className:"h-3 w-3 mr-1"}),"Comportamento"]}),a.jsxs(To,{value:"appearance",children:[a.jsx(_,{className:"h-3 w-3 mr-1"}),"Aparência"]}),a.jsxs(To,{value:"timing",children:[a.jsx(h,{className:"h-3 w-3 mr-1"}),"Timing"]}),a.jsxs(To,{value:"filters",children:[a.jsx(_a,{className:"h-3 w-3 mr-1"}),"Filtros"]})]}),a.jsx(Ao,{value:"behavior",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsx(dt,{className:"text-sm",children:"Comportamento das Notificações"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Notificações Sonoras"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Som para eventos urgentes"})]}),a.jsx(Wt,{defaultChecked:!1})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Notificações do Navegador"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Notificações nativas do browser"})]}),a.jsx(Wt,{defaultChecked:!1})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Auto-reposição de Modal"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Reabrir modal após snooze"})]}),a.jsx(Wt,{defaultChecked:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Persistência de Modal (segundos)"}),a.jsx(Ji,{defaultValue:[30],max:120,min:5,step:5,className:"w-full"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Tempo para fechar automaticamente"})]})]})]})}),a.jsx(Ao,{value:"appearance",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsx(dt,{className:"text-sm",children:"Personalização Visual"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Tema de Cores"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx(cr,{variant:"outline",size:"sm",className:"h-12 bg-gradient-to-r from-blue-400 to-purple-500",children:"Padrão"}),a.jsx(cr,{variant:"outline",size:"sm",className:"h-12 bg-gradient-to-r from-green-400 to-blue-500",children:"Natureza"}),a.jsx(cr,{variant:"outline",size:"sm",className:"h-12 bg-gradient-to-r from-pink-400 to-red-500",children:"Vibrante"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Animações Reduzidas"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Para melhor performance"})]}),a.jsx(Wt,{defaultChecked:!1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Opacidade do Background"}),a.jsx(Ji,{defaultValue:[80],max:100,min:20,step:10,className:"w-full"})]})]})]})}),a.jsx(Ao,{value:"timing",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsx(dt,{className:"text-sm",children:"Configurações de Tempo"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Dias de Antecedência para Notificar"}),a.jsx(Ji,{value:n,onValueChange:l,max:30,min:1,step:1,className:"w-full"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Notificar eventos com até ",n[0]," dias de antecedência"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Horário Preferido para Notificações"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx(Sr,{type:"time",defaultValue:"09:00"}),a.jsx(Sr,{type:"time",defaultValue:"17:00"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Horários de início e fim para notificações automáticas"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Notificações em Fins de Semana"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Incluir sábados e domingos"})]}),a.jsx(Wt,{defaultChecked:!1})]})]})]})}),a.jsx(Ao,{value:"filters",className:"space-y-4",children:a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsx(dt,{className:"text-sm",children:"Filtros de Eventos"})}),a.jsxs(mt,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Apenas Feriados"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Notificar somente feriados"})]}),a.jsx(Wt,{defaultChecked:!1})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm",children:"Apenas Aniversários"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Notificar somente aniversários"})]}),a.jsx(Wt,{defaultChecked:!1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Palavras-chave para Filtrar"}),a.jsx(Nt,{placeholder:"Ex: nacional, municipal, estadual...",className:"h-20"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Eventos contendo essas palavras serão priorizados"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm",children:"Mensagem Personalizada"}),a.jsx(Nt,{value:o,onChange:e=>i(e.target.value),placeholder:"Digite uma mensagem personalizada para suas notificações...",className:"h-20"}),a.jsxs(cr,{onClick:()=>{},size:"sm",className:"w-full",children:[a.jsx(z,{className:"h-3 w-3 mr-2"}),"Salvar Mensagem"]})]})]})]})})]}),a.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[a.jsxs(cr,{variant:"outline",onClick:()=>{s({showModalForUrgent:!0,showToastsForAll:!0,snoozeTime:30,dismissedEvents:[]})},className:"flex items-center gap-2",children:[a.jsx(Ja,{className:"h-4 w-4"}),"Restaurar Padrões"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(cr,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),a.jsxs(cr,{onClick:()=>t(!1),children:[a.jsx(z,{className:"h-4 w-4 mr-2"}),"Salvar Configurações"]})]})]})]})]})},Tn=()=>{const{settings:s,updateSettings:r,clearDismissedEvents:t,stats:o}=Po(),[i,n]=e.useState(!1),l=e=>{switch(e){case"urgent":return o.urgent>0?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-600 border-gray-200";case"today":return o.today>0?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200";case"total":return o.total>0?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},d="/admin/notificacoes"===window.location.pathname,c=a.jsxs("div",{className:"space-y-6",children:[a.jsxs(nt,{children:[a.jsx(lt,{className:"pb-3",children:a.jsxs(dt,{className:"text-sm flex items-center gap-2",children:[a.jsx(ie,{className:"h-4 w-4"}),"Estatísticas de Eventos"]})}),a.jsxs(mt,{className:"pt-0",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:l("urgent"),children:[o.urgent," Urgente",1!==o.urgent?"s":""]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:l("today"),children:[o.today," Hoje"]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[o.tomorrow," Amanhã"]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:l("total"),children:[o.total," Total"]})})]}),o.past>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-green-100 text-green-800 border-green-200 text-xs",children:[o.finished," Finalizado",1!==o.finished?"s":""]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-gray-100 text-gray-800 border-gray-200 text-xs",children:[o.hidden," Oculto",1!==o.hidden?"s":""]})}),a.jsx("div",{className:"text-center",children:a.jsxs(mr,{className:"bg-blue-100 text-blue-800 border-blue-200 text-xs",children:[o.past," Passados"]})})]}),a.jsx("div",{className:"mt-2 text-center",children:a.jsx("p",{className:"text-xs text-muted-foreground",children:'💡 Acesse "Eventos Passados" no cabeçalho para ver detalhes'})})]}),o.dismissed>0&&a.jsx("div",{className:"mt-3 pt-3 border-t",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-xs text-muted-foreground",children:[o.dismissed," evento",1!==o.dismissed?"s":""," dispensado",1!==o.dismissed?"s":""]}),a.jsxs(cr,{variant:"ghost",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[a.jsx(na,{className:"h-3 w-3 mr-1"}),"Restaurar"]})]})})]})]}),a.jsx(Dr,{}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Preferências de Notificação"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm font-medium",children:"Modal para Eventos Urgentes"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Mostrar popup para eventos hoje/amanhã"})]}),a.jsx(Wt,{checked:s.showModalForUrgent,onCheckedChange:e=>r({showModalForUrgent:e})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm font-medium",children:"Notificações Toast"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Mostrar avisos para todos os eventos"})]}),a.jsx(Wt,{checked:s.showToastsForAll,onCheckedChange:e=>r({showToastsForAll:e})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(eo,{className:"text-sm font-medium",children:"Mostrar Eventos Passados"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Exibir eventos finalizados no calendário"})]}),a.jsx(Wt,{checked:s.showPastEvents,onCheckedChange:e=>r({showPastEvents:e})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm font-medium",children:"Tempo de Adiamento"}),a.jsxs(ao,{value:s.snoozeTime.toString(),onValueChange:e=>r({snoozeTime:parseInt(e)}),children:[a.jsx(ro,{className:"h-8",children:a.jsx(so,{})}),a.jsx(io,{children:[{value:15,label:"15 minutos"},{value:30,label:"30 minutos"},{value:60,label:"1 hora"},{value:120,label:"2 horas"},{value:240,label:"4 horas"},{value:480,label:"8 horas"}].map(e=>a.jsx(no,{value:e.value.toString(),children:e.label},e.value))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Tempo padrão para adiar notificações"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{className:"text-sm font-medium",children:"Auto-ocultar Eventos Finalizados"}),a.jsxs(ao,{value:s.autoHideAfterHours.toString(),onValueChange:e=>r({autoHideAfterHours:parseInt(e)}),children:[a.jsx(ro,{className:"h-8",children:a.jsx(so,{})}),a.jsx(io,{children:[{value:1,label:"1 hora"},{value:2,label:"2 horas"},{value:4,label:"4 horas"},{value:8,label:"8 horas"},{value:12,label:"12 horas"},{value:24,label:"24 horas"}].map(e=>a.jsx(no,{value:e.value.toString(),children:e.label},e.value))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Tempo para ocultar eventos após finalizar"})]})]})]}),a.jsx(Dr,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Status Atual"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.showModalForUrgent?a.jsx(oe,{className:"h-3 w-3 text-green-600"}):a.jsx(ms,{className:"h-3 w-3 text-gray-400"}),a.jsxs("span",{className:s.showModalForUrgent?"text-green-700":"text-gray-500",children:["Modais ",s.showModalForUrgent?"ativados":"desativados"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.showToastsForAll?a.jsx(oe,{className:"h-3 w-3 text-green-600"}):a.jsx(ms,{className:"h-3 w-3 text-gray-400"}),a.jsxs("span",{className:s.showToastsForAll?"text-green-700":"text-gray-500",children:["Toasts ",s.showToastsForAll?"ativados":"desativados"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.showPastEvents?a.jsx(oa,{className:"h-3 w-3 text-blue-600"}):a.jsx(ia,{className:"h-3 w-3 text-gray-400"}),a.jsxs("span",{className:s.showPastEvents?"text-blue-700":"text-gray-500",children:["Eventos passados ",s.showPastEvents?"visíveis":"ocultos"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx(h,{className:"h-3 w-3 text-blue-600"}),a.jsxs("span",{className:"text-blue-700",children:["Adiamento: ",s.snoozeTime,"min | Auto-ocultar: ",s.autoHideAfterHours,"h"]})]})]})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx(Sn,{})}),a.jsx(nt,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:a.jsx(mt,{className:"p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:"text-lg",children:"💡"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-blue-800 mb-1",children:"Dica Inteligente"}),a.jsx("p",{className:"text-xs text-blue-700",children:"Configure as notificações de acordo com sua rotina. Eventos de hoje ficam ativos durante o dia, podem ser finalizados manualmente e são ocultados automaticamente após algumas horas."})]})]})})})]});return d?c:a.jsxs(wr,{open:i,onOpenChange:n,children:[a.jsx(Tr,{asChild:!0,children:a.jsxs(cr,{variant:"outline",size:"sm",className:"relative bg-white/80 hover:bg-white transition-all duration-200",children:[a.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Configurar Notificações",o.urgent>0&&a.jsx(mr,{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 rounded-full p-0 flex items-center justify-center animate-pulse",children:o.urgent})]})}),a.jsxs(yr,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[a.jsx(Cr,{children:a.jsxs(kr,{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:a.jsx(Ie,{className:"h-5 w-5 text-white"})}),"Configurações de Notificação"]})}),c]})]})},An=()=>a.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"Configurações de Notificações"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Gerencie as configurações de notificações de eventos do sistema"})]}),a.jsx("div",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-soft",children:a.jsx(Tn,{})})]}),_n=({open:s,onOpenChange:r,orgao:t,onSave:o,isLoading:i=!1})=>{const[n,l]=e.useState(""),[d,c]=e.useState("");e.useEffect(()=>{t?(l(t.codigo),c(t.nome)):(l(""),c(""))},[t,s]);return a.jsx(wr,{open:s,onOpenChange:r,children:a.jsxs(yr,{children:[a.jsx(Cr,{children:a.jsx(kr,{children:t?"Editar Órgão Julgador":"Novo Órgão Julgador"})}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.trim()&&d.trim()&&(o({codigo:n.trim(),nome:d.trim()}),r(!1))},className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"codigo",children:"Código"}),a.jsx(Sr,{id:"codigo",value:n,onChange:e=>l(e.target.value),placeholder:"Digite o código",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"nome",children:"Nome"}),a.jsx(Sr,{id:"nome",value:d,onChange:e=>c(e.target.value),placeholder:"Digite o nome do órgão julgador",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(cr,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:i,children:"Cancelar"}),a.jsx(cr,{type:"submit",disabled:i,children:i?"Salvando...":"Salvar"})]})]})]})})},Pn=()=>{const[s,r]=e.useState(""),[t,o]=e.useState("1grau"),[i,n]=e.useState(!1),[l,d]=e.useState(null),[c,m]=e.useState(!1),[u,x]=e.useState(null),{toast:h}=Vr(),{data:g}=go(),{orgaos:p,isLoading:f,createOrgao:j,updateOrgao:b,deleteOrgao:v}=pi(t),N=g?.is_admin&&"aprovado"===g?.status,w=e.useMemo(()=>{if(!s.trim())return p;const e=s.toLowerCase();return p.filter(a=>a.codigo.includes(e)||a.nome.toLowerCase().includes(e))},[s,p]),y=e=>a.jsx("div",{className:"border rounded-md",children:a.jsxs(pn,{children:[a.jsx(fn,{children:a.jsxs(bn,{children:[a.jsx(vn,{className:"w-[120px]",children:"Código"}),a.jsx(vn,{children:"Nome do Órgão"}),a.jsx(vn,{className:"w-[140px]",children:"Ações"})]})}),a.jsx(jn,{children:f?a.jsx(bn,{children:a.jsx(Nn,{colSpan:3,className:"text-center py-8",children:"Carregando..."})}):0===e.length?a.jsx(bn,{children:a.jsx(Nn,{colSpan:3,className:"text-center py-8 text-muted-foreground",children:"Nenhum órgão julgador encontrado"})}):e.map(e=>a.jsxs(bn,{children:[a.jsx(Nn,{className:"font-mono font-medium",children:e.codigo}),a.jsx(Nn,{children:e.nome}),a.jsx(Nn,{children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(cr,{size:"sm",variant:"ghost",onClick:()=>{return a=e.codigo,navigator.clipboard.writeText(a),void h({title:"Código copiado!",description:`Código ${a} foi copiado para a área de transferência.`});var a},className:"p-2 h-8 w-8",title:"Copiar código",children:a.jsx(Ta,{className:"h-3 w-3"})}),N&&a.jsxs(a.Fragment,{children:[a.jsx(cr,{size:"sm",variant:"ghost",onClick:()=>(e=>{d(e),n(!0)})(e),className:"p-2 h-8 w-8",title:"Editar",children:a.jsx(Me,{className:"h-3 w-3"})}),a.jsx(cr,{size:"sm",variant:"ghost",onClick:()=>(e=>{x(e),m(!0)})(e),className:"p-2 h-8 w-8 text-destructive hover:text-destructive",title:"Excluir",children:a.jsx(P,{className:"h-3 w-3"})})]})]})})]},e.id))})]})});return a.jsx("div",{className:"min-h-screen bg-gradient-bg p-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx(Lo,{title:"Órgãos Julgadores",subtitle:"Consulta e gestão de órgãos julgadores do TRT15 - 1º e 2º graus"}),a.jsxs(nt,{children:[a.jsx(lt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(dt,{className:"text-2xl",children:"Órgãos Julgadores"}),a.jsx(ct,{children:"Busque órgãos julgadores por código ou nome"})]}),a.jsxs("div",{className:"flex gap-2",children:[N&&a.jsxs(cr,{onClick:()=>{d(null),n(!0)},className:"flex items-center gap-2",children:[a.jsx(S,{className:"h-4 w-4"}),"Novo Órgão"]}),a.jsxs(cr,{onClick:()=>{const e=["Código,Nome do Órgão",...p.map(e=>`${e.codigo},"${e.nome}"`)].join("\n"),a=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),r=URL.createObjectURL(a);s.setAttribute("href",r),s.setAttribute("download",`orgaos_julgadores_${t}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},variant:"outline",className:"flex items-center gap-2",children:[a.jsx(Fa,{className:"h-4 w-4"}),"Exportar CSV"]})]})]})}),a.jsx(mt,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(eo,{htmlFor:"busca",children:"Buscar por código ou nome"}),a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),a.jsx(Sr,{id:"busca",placeholder:"Digite o código ou nome do órgão...",value:s,onChange:e=>r(e.target.value),className:"pl-10"})]})]}),a.jsxs(Eo,{value:t,onValueChange:e=>o(e),children:[a.jsxs(So,{className:"grid w-full grid-cols-2",children:[a.jsx(To,{value:"1grau",children:"1º Grau"}),a.jsx(To,{value:"2grau",children:"2º Grau"})]}),a.jsxs(Ao,{value:"1grau",className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs(mr,{variant:"secondary",children:[w.length," órgão(s) encontrado(s)"]})}),y(w)]}),a.jsxs(Ao,{value:"2grau",className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs(mr,{variant:"secondary",children:[w.length," órgão(s) encontrado(s)"]})}),y(w)]})]})]})})]}),a.jsx(_n,{open:i,onOpenChange:n,orgao:l,onSave:e=>{l?b.mutate({id:l.id,...e}):j.mutate(e)},isLoading:j.isPending||b.isPending}),a.jsx(ur,{open:c,onOpenChange:m,children:a.jsxs(hr,{children:[a.jsxs(gr,{children:[a.jsx(pr,{children:"Confirmar exclusão"}),a.jsxs(fr,{children:['Tem certeza que deseja excluir o órgão julgador "',u?.nome,'"? Esta ação não pode ser desfeita.']})]}),a.jsxs(jr,{children:[a.jsx(br,{children:"Cancelar"}),a.jsx(vr,{onClick:()=>{u&&(v.mutate(u.id),m(!1),x(null))},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})})},Dn=async(e,a=3)=>{for(let r=1;r<=a;r++)try{return await e()}catch(s){if(r===a)throw s;const e=1e3*Math.pow(2,r-1);await new Promise(a=>setTimeout(a,e))}throw new Error("Máximo de tentativas excedido")},zn=e=>{const a={sistemas:"bg-blue-100 text-blue-800",pessoal:"bg-green-100 text-green-800",trabalho:"bg-purple-100 text-purple-800",financeiro:"bg-yellow-100 text-yellow-800",geral:"bg-gray-100 text-gray-800"};return a[e]||a.geral},In=e=>{const s={sistemas:a.jsx(ma,{className:"w-3 h-3"}),pessoal:a.jsx(se,{className:"w-3 h-3"}),trabalho:a.jsx(re,{className:"w-3 h-3"}),financeiro:a.jsx(k,{className:"w-3 h-3"}),geral:a.jsx(k,{className:"w-3 h-3"})};return s[e]||s.geral},Mn=({memory:s,onEdit:r,onDelete:t,onToggleFavorite:o})=>{const[i,n]=e.useState(!1),[l,d]=e.useState(!1),c=async(e,a)=>{try{await navigator.clipboard.writeText(e),Cs.success(`${a} copiado para a área de transferência`)}catch(s){Cs.error("Erro ao copiar para a área de transferência")}},m=e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return a.jsxs(nt,{className:"w-full hover:shadow-md transition-shadow",children:[a.jsxs(lt,{className:"pb-3",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(dt,{className:"text-lg",children:s.title}),s.is_favorite&&a.jsx(Ke,{className:"w-4 h-4 text-yellow-500 fill-current"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>o(s.id,!s.is_favorite),className:"h-8 w-8 p-0",children:a.jsx(Ke,{className:"w-4 h-4 "+(s.is_favorite?"text-yellow-500 fill-current":"text-gray-400")})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>r(s),className:"h-8 w-8 p-0",children:a.jsx(Me,{className:"w-4 h-4"})}),a.jsxs(ur,{children:[a.jsx(xr,{asChild:!0,children:a.jsx(cr,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:a.jsx(P,{className:"w-4 h-4"})})}),a.jsxs(hr,{children:[a.jsxs(gr,{children:[a.jsx(pr,{children:"Confirmar exclusão"}),a.jsxs(fr,{children:['Tem certeza que deseja excluir a memória "',s.title,'"? Esta ação não pode ser desfeita.']})]}),a.jsxs(jr,{children:[a.jsx(br,{children:"Cancelar"}),a.jsx(vr,{onClick:()=>t(s.id),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(mr,{className:zn(s.category),children:[In(s.category),a.jsx("span",{className:"ml-1 capitalize",children:s.category})]})})]}),a.jsxs(mt,{className:"space-y-3",children:[s.description&&a.jsx("p",{className:"text-sm text-gray-600",children:s.description}),s.url&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ma,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"URL:"}),a.jsxs(cr,{variant:"link",size:"sm",onClick:()=>{s.url&&window.open(s.url,"_blank")},className:"p-0 h-auto text-blue-600 hover:text-blue-800",children:[a.jsx(te,{className:"w-3 h-3 mr-1"}),"Abrir"]}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>c(s.url,"URL"),className:"h-6 w-6 p-0",children:a.jsx(Ta,{className:"w-3 h-3"})})]}),s.username&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(se,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Usuário:"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-sm "+(l?"":"blur-sm"),children:s.username}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>d(!l),className:"h-6 w-6 p-0",children:l?a.jsx(ia,{className:"w-3 h-3"}):a.jsx(oa,{className:"w-3 h-3"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>c(s.username,"Usuário"),className:"h-6 w-6 p-0",children:a.jsx(Ta,{className:"w-3 h-3"})})]})]}),s.password&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(re,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Senha:"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-sm font-mono "+(i?"":"blur-sm"),children:i?s.password:"••••••••"}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>n(!i),className:"h-6 w-6 p-0",children:i?a.jsx(ia,{className:"w-3 h-3"}):a.jsx(oa,{className:"w-3 h-3"})}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>c(s.password,"Senha"),className:"h-6 w-6 p-0",children:a.jsx(Ta,{className:"w-3 h-3"})})]})]}),s.notes&&a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Notas:"})]}),a.jsx("p",{className:"text-sm text-gray-600 pl-6",children:s.notes})]}),a.jsxs("div",{className:"text-xs text-gray-400 pt-2 border-t",children:["Criado em: ",m(s.created_at),s.updated_at!==s.created_at&&a.jsxs("span",{className:"ml-2",children:["• Atualizado em: ",m(s.updated_at)]})]})]})]})},Fn=e.forwardRef(({className:e,...s},r)=>a.jsx(us,{ref:r,className:lr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:a.jsx(xs,{className:lr("flex items-center justify-center text-current"),children:a.jsx(X,{className:"h-4 w-4"})})}));Fn.displayName=us.displayName;const On=[{value:"sistemas",label:"Sistemas"},{value:"pessoal",label:"Pessoal"},{value:"trabalho",label:"Trabalho"},{value:"financeiro",label:"Financeiro"},{value:"geral",label:"Geral"}],Rn={title:"",description:"",category:"geral",username:"",password:"",url:"",notes:"",is_favorite:!1},Jn=({isOpen:s,onClose:r,onSubmit:t,editingMemory:o,isLoading:n=!1})=>{const[l,d]=e.useState(Rn),[c,m]=e.useState(!1),[u,x]=e.useState({});e.useEffect(()=>{d(o?{title:o.title,description:o.description||"",category:o.category,username:o.username||"",password:o.password||"",url:o.url||"",notes:o.notes||"",is_favorite:o.is_favorite||!1}:Rn),x({}),m(!1)},[o,s]);const h=e=>{try{return new URL(e),!0}catch{return!1}},g=()=>{d(Rn),x({}),m(!1),r()},p=(e,a)=>{d(s=>({...s,[e]:a})),u[e]&&x(a=>({...a,[e]:""}))};return a.jsx(wr,{open:s,onOpenChange:g,children:a.jsxs(yr,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Cr,{children:[a.jsx(kr,{children:o?"Editar Memória Importante":"Nova Memória Importante"}),a.jsx(Er,{children:"Armazene informações importantes como senhas, logins e dados pessoais de forma segura."})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!(()=>{const e={};return l.title.trim()||(e.title="Título é obrigatório"),l.url&&!h(l.url)&&(e.url="URL inválida"),x(e),0===Object.keys(e).length})())return;await t(l)&&g()},className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(eo,{htmlFor:"title",children:"Título *"}),a.jsx(Sr,{id:"title",value:l.title,onChange:e=>p("title",e.target.value),placeholder:"Ex: PJe Homologação",className:u.title?"border-red-500":""}),u.title&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:u.title})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(eo,{htmlFor:"description",children:"Descrição"}),a.jsx(Nt,{id:"description",value:l.description,onChange:e=>p("description",e.target.value),placeholder:"Descrição detalhada da memória",rows:3})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"category",children:"Categoria"}),a.jsxs(ao,{value:l.category,onValueChange:e=>p("category",e),children:[a.jsx(ro,{children:a.jsx(so,{placeholder:"Selecione uma categoria"})}),a.jsx(io,{children:On.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"url",children:"URL"}),a.jsx(Sr,{id:"url",type:"url",value:l.url,onChange:e=>p("url",e.target.value),placeholder:"https://exemplo.com",className:u.url?"border-red-500":""}),u.url&&a.jsx("p",{className:"text-sm text-red-500 mt-1",children:u.url})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"username",children:"Usuário/Login"}),a.jsx(Sr,{id:"username",value:l.username,onChange:e=>p("username",e.target.value),placeholder:"Nome de usuário"})]}),a.jsxs("div",{children:[a.jsx(eo,{htmlFor:"password",children:"Senha"}),a.jsxs("div",{className:"relative",children:[a.jsx(Sr,{id:"password",type:c?"text":"password",value:l.password,onChange:e=>p("password",e.target.value),placeholder:"Senha",className:"pr-10"}),a.jsx(cr,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>m(!c),children:c?a.jsx(ia,{className:"h-4 w-4"}):a.jsx(oa,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(eo,{htmlFor:"notes",children:"Notas Adicionais"}),a.jsx(Nt,{id:"notes",value:l.notes,onChange:e=>p("notes",e.target.value),placeholder:"Informações adicionais, observações, etc.",rows:3})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Fn,{id:"is_favorite",checked:l.is_favorite,onCheckedChange:e=>p("is_favorite",e)}),a.jsx(eo,{htmlFor:"is_favorite",children:"Marcar como favorito"})]})})]}),a.jsxs(Pr,{className:"gap-2",children:[a.jsxs(cr,{type:"button",variant:"outline",onClick:g,disabled:n,children:[a.jsx(i,{className:"w-4 h-4 mr-2"}),"Cancelar"]}),a.jsxs(cr,{type:"submit",disabled:n,children:[a.jsx(z,{className:"w-4 h-4 mr-2"}),n?"Salvando...":o?"Atualizar":"Salvar"]})]})]})]})})};function Un({className:e,...s}){return a.jsx("div",{className:lr("animate-pulse rounded-md bg-muted",e),...s})}const qn=[{value:"all",label:"Todas as Categorias"},{value:"sistemas",label:"Sistemas"},{value:"pessoal",label:"Pessoal"},{value:"trabalho",label:"Trabalho"},{value:"financeiro",label:"Financeiro"},{value:"geral",label:"Geral"}],Vn=[{value:"created_desc",label:"Mais Recentes"},{value:"created_asc",label:"Mais Antigas"},{value:"title_asc",label:"Título (A-Z)"},{value:"title_desc",label:"Título (Z-A)"},{value:"category_asc",label:"Categoria (A-Z)"},{value:"favorites",label:"Favoritos Primeiro"}],Ln=()=>{const{memories:s,loading:r,createMemory:t,updateMemory:o,deleteMemory:i,toggleFavorite:n}=(()=>{const[a,s]=e.useState([]),[r,t]=e.useState(!0),{user:o}=tt(),i=e.useCallback(async()=>{if(o)try{t(!0);const e=await Dn(async()=>{const{data:e,error:a}=await dr.from("important_memories").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});if(a)throw a;return e||[]});s(e)}catch(e){e instanceof Error&&e.message,Cs.error("Erro ao carregar memórias importantes. Verifique sua conexão.")}finally{t(!1)}},[o]),n=e.useCallback(async e=>{if(!o)return Cs.error("Usuário não autenticado"),!1;try{const a=await Dn(async()=>{const{data:a,error:s}=await dr.from("important_memories").insert({...e,user_id:o.id}).select().single();if(s)throw s;return a});return s(e=>[a,...e]),Cs.success("Memória importante salva com sucesso!"),!0}catch(a){return a instanceof Error&&a.message,Cs.error("Erro ao salvar memória importante. Tente novamente."),!1}},[o]),l=e.useCallback(async(e,a)=>{if(!o)return Cs.error("Usuário não autenticado"),!1;try{const r=await Dn(async()=>{const{data:s,error:r}=await dr.from("important_memories").update(a).eq("id",e).eq("user_id",o.id).select().single();if(r)throw r;return s});return s(a=>a.map(a=>a.id===e?r:a)),Cs.success("Memória importante atualizada com sucesso!"),!0}catch(r){return r instanceof Error&&r.message,Cs.error("Erro ao atualizar memória importante. Tente novamente."),!1}},[o]),d=e.useCallback(async e=>{if(!o)return Cs.error("Usuário não autenticado"),!1;try{return await Dn(async()=>{const{error:a}=await dr.from("important_memories").delete().eq("id",e).eq("user_id",o.id);if(a)throw a}),s(a=>a.filter(a=>a.id!==e)),Cs.success("Memória importante deletada com sucesso!"),!0}catch(a){return a instanceof Error&&a.message,Cs.error("Erro ao deletar memória importante. Tente novamente."),!1}},[o]),c=e.useCallback(async(e,a)=>l(e,{is_favorite:a}),[l]),m=e.useCallback(e=>a.filter(a=>a.category===e),[a]),u=e.useCallback(()=>a.filter(e=>e.is_favorite),[a]),x=e.useCallback(e=>{const s=e.toLowerCase();return a.filter(e=>e.title.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s)||e.category.toLowerCase().includes(s)||e.notes?.toLowerCase().includes(s))},[a]);return e.useEffect(()=>{o&&i()},[o,i]),{memories:a,loading:r,fetchMemories:i,createMemory:n,updateMemory:l,deleteMemory:d,toggleFavorite:c,getMemoriesByCategory:m,getFavoriteMemories:u,searchMemories:x}})(),[l,d]=e.useState(!1),[c,m]=e.useState(null),[u,x]=e.useState(""),[h,p]=e.useState("all"),[f,j]=e.useState("created_desc"),[b,v]=e.useState(!1),[N,w]=e.useState("grid"),[y,C]=e.useState(!1),[k,T]=e.useState(!0),A=e.useMemo(()=>{let e=s;if(u){const a=u.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a)||e.description?.toLowerCase().includes(a)||e.category.toLowerCase().includes(a)||e.notes?.toLowerCase().includes(a))}return"all"!==h&&(e=e.filter(e=>e.category===h)),b&&(e=e.filter(e=>e.is_favorite)),e.sort((e,a)=>{switch(f){case"created_asc":return new Date(e.created_at).getTime()-new Date(a.created_at).getTime();case"created_desc":return new Date(a.created_at).getTime()-new Date(e.created_at).getTime();case"title_asc":return e.title.localeCompare(a.title);case"title_desc":return a.title.localeCompare(e.title);case"category_asc":return e.category.localeCompare(a.category);case"favorites":return e.is_favorite&&!a.is_favorite?-1:!e.is_favorite&&a.is_favorite?1:new Date(a.created_at).getTime()-new Date(e.created_at).getTime();default:return 0}}),e},[s,u,h,b,f]),_=e=>{m(e),d(!0)},P=s.reduce((e,a)=>(e[a.category]=(e[a.category]||0)+1,e),{}),D=s.filter(e=>e.is_favorite).length;return r?a.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Un,{className:"h-8 w-64"}),a.jsx(Un,{className:"h-10 w-32"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((e,s)=>a.jsx(Un,{className:"h-64 w-full"},s))})]}):a.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[a.jsx(Lo,{title:"Memórias Importantes",subtitle:"Armazene senhas, logins e informações importantes de forma segura",showBackButton:!0,backTo:"/",children:a.jsxs(cr,{onClick:()=>d(!0),className:"flex items-center gap-2 ml-4",children:[a.jsx(S,{className:"w-4 h-4"}),"Nova Memória"]})}),k&&a.jsxs(Di,{className:"border-blue-200 bg-blue-50",children:[a.jsx(g,{className:"h-4 w-4 text-blue-600"}),a.jsxs(zi,{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-blue-800",children:[a.jsx("strong",{children:"Segurança:"})," Suas memórias são privadas e apenas você pode visualizá-las. Use senhas fortes e mantenha suas informações atualizadas."]}),a.jsx(cr,{variant:"ghost",size:"sm",onClick:()=>T(!1),className:"text-blue-600 hover:text-blue-800",children:a.jsx(ia,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:D}),a.jsx("div",{className:"text-sm text-gray-600",children:"Favoritos"})]}),Object.entries(P).map(([e,s])=>a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-700",children:s}),a.jsx("div",{className:"text-sm text-gray-600 capitalize",children:e})]},e))]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm space-y-4",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx(Sr,{placeholder:"Buscar memórias...",value:u,onChange:e=>x(e.target.value),className:"pl-10"})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(ao,{value:h,onValueChange:p,children:[a.jsx(ro,{className:"w-full sm:w-48",children:a.jsx(so,{placeholder:"Categoria"})}),a.jsx(io,{children:qn.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]}),a.jsxs(ao,{value:f,onValueChange:j,children:[a.jsx(ro,{className:"w-full sm:w-48",children:a.jsx(so,{placeholder:"Ordenar por"})}),a.jsx(io,{children:Vn.map(e=>a.jsx(no,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(cr,{variant:b?"default":"outline",size:"sm",onClick:()=>v(!b),className:"flex items-center gap-2",children:[a.jsx(Ke,{className:"w-4 h-4 "+(b?"fill-current":"")}),"Apenas Favoritos"]}),(u||"all"!==h||b)&&a.jsxs(mr,{variant:"secondary",className:"flex items-center gap-1",children:[a.jsx(_a,{className:"w-3 h-3"}),A.length," resultado(s)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(cr,{variant:"grid"===N?"default":"outline",size:"sm",onClick:()=>w("grid"),children:a.jsx(E,{className:"w-4 h-4"})}),a.jsx(cr,{variant:"list"===N?"default":"outline",size:"sm",onClick:()=>w("list"),children:a.jsx(hs,{className:"w-4 h-4"})})]})]})]}),0===A.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(re,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:0===s.length?"Nenhuma memória encontrada":"Nenhum resultado encontrado"}),a.jsx("p",{className:"text-gray-600 mb-4",children:0===s.length?"Comece criando sua primeira memória importante":"Tente ajustar os filtros ou termo de busca"}),0===s.length&&a.jsxs(cr,{onClick:()=>d(!0),children:[a.jsx(S,{className:"w-4 h-4 mr-2"}),"Criar Primeira Memória"]})]}):a.jsx("div",{className:"grid gap-4 "+("grid"===N?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:A.map(e=>a.jsx(Mn,{memory:e,onEdit:_,onDelete:i,onToggleFavorite:n},e.id))}),a.jsx(Jn,{isOpen:l,onClose:()=>{d(!1),m(null)},onSubmit:c?async e=>{if(!c)return!1;C(!0);const a=await o(c.id,e);return C(!1),a}:async e=>{C(!0);const a=await t(e);return C(!1),a},editingMemory:c,isLoading:y})]})},$n=()=>{const s=gs();return e.useEffect(()=>{},[s.pathname]),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),a.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),a.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Bn=new nr,Gn=()=>a.jsx(ps,{client:Bn,children:a.jsx(it,{defaultTheme:"light",storageKey:"jira-ui-theme",children:a.jsx(rt,{children:a.jsxs(Wr,{children:[a.jsx(Kr,{}),a.jsx(Yr,{}),a.jsx(fs,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:a.jsxs(js,{children:[a.jsx(bs,{path:"/auth",element:a.jsx(xn,{})}),a.jsx(bs,{path:"/",element:a.jsx(xt,{children:a.jsx(Vo,{})})}),a.jsx(bs,{path:"/calendario",element:a.jsx(xt,{children:a.jsx(oi,{})})}),a.jsx(bs,{path:"/criar-chamado",element:a.jsx(xt,{children:a.jsx(Xi,{})})}),a.jsx(bs,{path:"/base-conhecimento",element:a.jsx(xt,{children:a.jsx(an,{})})}),a.jsx(bs,{path:"/chamados-recentes",element:a.jsx(xt,{children:a.jsx(rn,{})})}),a.jsx(bs,{path:"/atalhos",element:a.jsx(xt,{children:a.jsx(un,{})})}),a.jsx(bs,{path:"/profile",element:a.jsx(xt,{children:a.jsx(gn,{})})}),a.jsx(bs,{path:"/admin/usuarios",element:a.jsx(xt,{requireAdmin:!0,children:a.jsx(wn,{})})}),a.jsx(bs,{path:"/admin/atalhos",element:a.jsx(xt,{requireAdmin:!0,children:a.jsx(yn,{})})}),a.jsx(bs,{path:"/admin/notificacoes",element:a.jsx(xt,{requireAdmin:!0,children:a.jsx(An,{})})}),a.jsx(bs,{path:"/admin/metricas",element:a.jsx(xt,{requireAdmin:!0,children:a.jsx(Cn,{})})}),a.jsx(bs,{path:"/admin/feriados",element:a.jsx(xt,{requireAdmin:!0,children:a.jsx(En,{})})}),a.jsx(bs,{path:"/orgaos-julgadores",element:a.jsx(xt,{children:a.jsx(Pn,{})})}),a.jsx(bs,{path:"/memorias-importantes",element:a.jsx(xt,{children:a.jsx(Ln,{})})}),a.jsx(bs,{path:"*",element:a.jsx($n,{})})]})})]})})})});vs(document.getElementById("root")).render(a.jsx(Gn,{}));
